<!DOCTYPE html>





<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <meta name="keywords" content="图雀社区,Tuture,Vue.js实战教程,微信小程序,Kotlin,React Native,Webpack,MVVM,React.js,Node.js,Redux,Django,MongoDB,Docker,JavaScript,Java,Go,Kubernetes,Nuxt,vue-router,react-router,小程序,跨端开发,Taro,react hooks,redux-saga,learn by doing,Web 前端实战教程,后端实战教程,小程序实战教程,移动端实战教程">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png?v=7.4.0">
  <link rel="mask-icon" href="/images/logo.svg?v=7.4.0" color="#222">
  <link rel="manifest" href="/images/manifest.json">
  <meta name="msapplication-config" content="/images/browserconfig.xml">
  <link rel="alternate" href="/atom.xml" title="图雀社区" type="application/atom+xml">
  <meta name="google-site-verification" content="uDCHIeBD5phhUIjsHM8GYeoNBYWJuQIJBjgchamUcAI">
  <meta name="yandex-verification" content="90341ba6c811f41d">

<link rel="stylesheet" href="/css/main.css?v=7.4.0">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '7.4.0',
    exturl: true,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":true,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":true},
    bookmark: {"enable":true,"color":"#222","save":"auto"},
    fancybox: true,
    mediumzoom: false,
    lazyload: true,
    pangu: true,
    algolia: {
      appID: '73BSUE4RKU',
      apiKey: '0b7cce26a4734cb760080065b3c4a4a1',
      indexName: 'Tuture',
      hits: {"per_page":10},
      labels: {"input_placeholder":"搜索教程","hits_empty":"我们找不到你搜索的教程: ${query}","hits_stats":"在 ${time} ms 内找到 ${hits} 条结果"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: '复制',
      copy_success: '复制成功',
      copy_failure: '复制失败'
    },
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="Node.js 太火了，火到几乎所有前端工程师都想学，几乎所有后端工程师也想学。一说到 Node.js，我们马上就会想到“异步”、“事件驱动”、“非阻塞”、“性能优良”这几个特点，但是你真的理解这些词的含义吗？这篇教程将带你快速入门 Node.js，为后续的前端学习或是 Node.js 进阶打下坚实的基础。">
<meta property="og:type" content="article">
<meta property="og:title" content="一杯茶的时间，上手 Node.js">
<meta property="og:url" content="https://tuture.co/2019/12/03/892fa12/index.html">
<meta property="og:site_name" content="图雀社区">
<meta property="og:description" content="Node.js 太火了，火到几乎所有前端工程师都想学，几乎所有后端工程师也想学。一说到 Node.js，我们马上就会想到“异步”、“事件驱动”、“非阻塞”、“性能优良”这几个特点，但是你真的理解这些词的含义吗？这篇教程将带你快速入门 Node.js，为后续的前端学习或是 Node.js 进阶打下坚实的基础。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://static.powerformer.com/c/892fa12/cover.png">
<meta property="article:published_time" content="2019-12-02T17:42:02.548Z">
<meta property="article:modified_time" content="2021-08-08T15:06:24.841Z">
<meta property="article:author" content="图雀社区">
<meta property="article:tag" content="图雀社区">
<meta property="article:tag" content="Tuture">
<meta property="article:tag" content="Vue.js实战教程">
<meta property="article:tag" content="微信小程序">
<meta property="article:tag" content="Kotlin">
<meta property="article:tag" content="React Native">
<meta property="article:tag" content="Webpack">
<meta property="article:tag" content="MVVM">
<meta property="article:tag" content="React.js">
<meta property="article:tag" content="Node.js">
<meta property="article:tag" content="Redux">
<meta property="article:tag" content="Django">
<meta property="article:tag" content="MongoDB">
<meta property="article:tag" content="Docker">
<meta property="article:tag" content="JavaScript">
<meta property="article:tag" content="Java">
<meta property="article:tag" content="Go">
<meta property="article:tag" content="Kubernetes">
<meta property="article:tag" content="Nuxt">
<meta property="article:tag" content="vue-router">
<meta property="article:tag" content="react-router">
<meta property="article:tag" content="小程序">
<meta property="article:tag" content="跨端开发">
<meta property="article:tag" content="Taro">
<meta property="article:tag" content="react hooks">
<meta property="article:tag" content="redux-saga">
<meta property="article:tag" content="learn by doing">
<meta property="article:tag" content="Web 前端实战教程">
<meta property="article:tag" content="后端实战教程">
<meta property="article:tag" content="小程序实战教程">
<meta property="article:tag" content="移动端实战教程">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://static.powerformer.com/c/892fa12/cover.png">
  <link rel="canonical" href="https://tuture.co/2019/12/03/892fa12/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>一杯茶的时间，上手 Node.js | 图雀社区</title>
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-124499211-1"></script>
  <script>
    var host = window.location.hostname;
    if (host !== "localhost" || !true) {
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-124499211-1');
    }
  </script>








  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

  <style>
    span.line.tuture-add {
      font-weight: bold;
    }

    span.line.tuture-del {
      opacity: 0.3;
    }

    .profileBox {
      display: flex;
      flex-direction: row;
      justify-content: center;
      align-items: center;
      flex-wrap: wrap;
    }

    .profileBox i {
      display: none;
    }

    .profileBox p {
      margin: 0;
      padding: 0;
    }

    .avatarBox {
      min-width: 60px;
    }

    .avatarBox .avatar {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      margin: 0;
    }

    .avatarBox .avatar:hover {
      cursor: pointer;
    }

    .avatarBox {
      margin-right: 20px;
    }

    .rightBox {
      display:flex;
      flex-direction: row;
      justify-content: flex-start;
      align-items: center;
    }

    .infoBox {
      min-width: 100px;
    }

    .infoBox p {
      padding: 0;
      margin: 0;
    }

    .infoBox .nickName {
      font-weight: bold;
      font-size: 20px;
      color: #979797;
      text-decoration: none;
    }

    .infoBox .nickName:hover {
      cursor: pointer;
    }

    .infoBox .motto {
      font-size: 16px;
      color: #979797;
    }

    .codeBox {
      margin-left: 49px;
      min-width: 100px;
    }

    .codeBox a {
      text-decoration: none;
    }

    .codeBox .exturl {
      border: none;
    }

    .codeBox span.codeText {
      display: inline-block;
      width: 100px;
      height: 40px;
      border-radius: 4px;
      border: 1px solid #979797;
      color: #979797;
      text-align: center;
      line-height: 40px;
      text-decoration: none;;
      transition: all 0.2s ease-in-out;
    }

    .codeBox .codeText:hover {
      cursor: pointer;
      background-color: #979797;
      color: #ffffff;
    }

    @media screen and (max-width:652px) {
      .profileBox {
        align-items: center;
        flex-direction: column;
      }

      .infoBox {
        margin-bottom: 20px;
      }

      .infoBox .nickName {
        text-align: center;
      }

      .rightBox {
        flex-direction: column;
        align-items: flex-start;
      }

      .codeBox {
        margin-left: 0;
      }

      .avatarBox {
        margin-right: 0;
      }
    }

    @media screen and (max-width:500px) {
      .rightBox {
        align-items: center;
      }

      .infoBox {
        margin-bottom: 20px;
      }

      .infoBox .nickName {
        text-align: center;
      }

      .infoBox .motto {
        text-align: center;
      }
    }

    .vsys {
      display:none !important;
      }

      figcaption .exturl {
        float: right;
      }
  </style>
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.15.10/build/styles/default.min.css">
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">
  <div class="container">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">图雀社区</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <h1 class="site-subtitle" itemprop="description">汇集精彩的实战技术教程</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
      
      
      
        
        <li class="menu-item menu-item-home">
      
    
      
      
        
      
        
      
        
      
        
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-tags">
      
    
      
      
        
      
        
      
        
          
        
      
        
      
    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签<span class="badge">45</span></a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-categories">
      
    
      
      
        
      
        
          
        
      
        
      
        
      
    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类<span class="badge">22</span></a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-archives">
      
    
      
      
        
          
        
      
        
      
        
      
        
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档<span class="badge">58</span></a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-早报">
      
    
      
      
        
      
        
      
        
      
        
      
    

    <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvZGFpbHk="><i class="menu-item-icon fa fa-fw fa-calendar"></i> <br>早报</span>

  </li>
      
      
      
        
        <li class="menu-item menu-item-about">
      
    
      
      
        
      
        
      
        
      
        
      
    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>关于</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-文档">
      
    
      
      
        
      
        
      
        
      
        
      
    

    <span class="exturl" data-url="aHR0cHM6Ly93d3cueXVxdWUuY29tL3R1dHVyZS9wcm9kdWN0LW1hbnVhbHM="><i class="menu-item-icon fa fa-fw fa-book"></i> <br>文档</span>

  </li>
      
      
      
        
        <li class="menu-item menu-item-faq">
      
    
      
      
        
      
        
      
        
      
        
      
    

    <a href="/FAQ" rel="section"><i class="menu-item-icon fa fa-fw fa-question"></i> <br>FAQ</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger">
        
          <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
      </li>
    
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input" id="search-input"></div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="algolia-results">
  <div id="algolia-stats"></div>
  <div id="algolia-hits"></div>
  <div id="algolia-pagination" class="algolia-pagination"></div>
</div>

  
</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <span class="exturl github-corner" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZXByb2plY3QvaHVi" title="Follow me on GitHub" aria-label="Follow me on GitHub"><svg width="80" height="80" viewbox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></span>


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
            

          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
      <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block post">
    <link itemprop="mainEntityOfPage" href="https://tuture.co/2019/12/03/892fa12/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="图雀社区">
      <meta itemprop="description" content="图雀社区是一个供大家分享用 Tuture 写作工具完成的教程的一个平台。在这里，读者们可以尽情享受高质量且免费的实战教程，并能与作者和其他读者互动和讨论；而作者们也可以借此传播他们的技术知识，宣传他们的开源项目，找到自己输出内容的受众，加速技术的传播。">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="图雀社区">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">一杯茶的时间，上手 Node.js

          
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2019-12-03 01:42:02" itemprop="dateCreated datePublished" datetime="2019-12-03T01:42:02+08:00">2019-12-03</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-08-08 23:06:24" itemprop="dateModified" datetime="2021-08-08T23:06:24+08:00">2021-08-08</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E5%90%8E%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">后端</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E5%90%8E%E7%AB%AF/Node-js/" itemprop="url" rel="index"><span itemprop="name">Node.js</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E5%90%8E%E7%AB%AF/Node-js/%E5%85%A5%E9%97%A8/" itemprop="url" rel="index"><span itemprop="name">入门</span></a></span>

                
                
              
            </span>
          

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
          
          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
              
                <span class="post-meta-item-text">本文字数：</span>
              
              <span>18k</span>
            </span>
          
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
              
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              
              <span>16 分钟</span>
            </span>
          
            <div class="post-description">Node.js 太火了，火到几乎所有前端工程师都想学，几乎所有后端工程师也想学。一说到 Node.js，我们马上就会想到“异步”、“事件驱动”、“非阻塞”、“性能优良”这几个特点，但是你真的理解这些词的含义吗？这篇教程将带你快速入门 Node.js，为后续的前端学习或是 Node.js 进阶打下坚实的基础。</div>
          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <div class="post-gallery" itemscope itemtype="http://schema.org/ImageGallery">
            <div class="post-gallery-row">
              <img src="https://static.powerformer.com/c/892fa12/cover.png" itemprop="contentUrl">
            
          

          </div>
        </div>
        <div class="profileBox">
  <div class="avatarBox">
    <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL21SY2Zwcw==" title="https://github.com/mRcfps"><img alt class="avatar" data-src="/images/avatars/mRcfps.jpg"><i class="fa fa-external-link"></i></span>
  </div>
  <div class="rightBox">
    <div class="infoBox">
    <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL21SY2Zwcw==" title="https://github.com/mRcfps"><p class="nickName">@mRcfps</p><i class="fa fa-external-link"></i></span>
  </div>
  <div class="codeBox">
    <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL21SY2Zwcy9ub2RlanMtcXVpY2tzdGFydA==" title="https://github.com/mRcfps/nodejs-quickstart"><span class="codeText">查看代码</span><i class="fa fa-external-link"></i></span>
  </div>
  </div>
</div><a id="more"></a>

<h2 id="起步"><a href="#起步" class="headerlink" title="起步"></a>起步</h2><div class="note primary">
            <p><strong>主要</strong></p><p>此教程属于<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvbm9kZWpzLXJvYWRtYXA=" title="https://github.com/tuture-dev/nodejs-roadmap">Node.js 后端工程师学习路线<i class="fa fa-external-link"></i></span>的一部分，点击可查看全部内容。</p>
          </div>

<h3 id="什么是-Node？"><a href="#什么是-Node？" class="headerlink" title="什么是 Node？"></a>什么是 Node？</h3><p>简单地说，Node（或者说 Node.js，两者是等价的） 是 JavaScript 的一种<strong>运行环境</strong>。在此之前，我们知道 JavaScript 都是在浏览器中执行的，用于给网页添加各种动态效果，那么可以说<strong>浏览器也是 JavaScript 的运行环境</strong>。那么这两个运行环境有哪些差异呢？请看下图：</p>
<p><img alt data-src="https://static.powerformer.com/c/892fa12/javascript-component.png"></p>
<p>两个运行环境共同包含了 ECMAScript，也就是剥离了所有运行环境的 JavaScript <strong>语言标准</strong>本身。现在 ECMAScript 的发展速度非常惊人，几乎能够做到每年发展一个版本。</p>
<div class="note info">
            <p><strong>提示</strong></p><p>ECMAScript 和 JavaScript 的关系是，前者是后者的规格，后者是前者的一种实现。在日常场合，这两个词是可以互换的。更多背景知识可参考阮一峰的<span class="exturl" data-url="aHR0cDovL2phdmFzY3JpcHQucnVhbnlpZmVuZy5jb20vaW50cm9kdWN0aW9uL2hpc3RvcnkuaHRtbA==" title="http://javascript.ruanyifeng.com/introduction/history.html">《JavaScript语言的历史》<i class="fa fa-external-link"></i></span>。</p>
          </div>

<p>另一方面，浏览器端 JavaScript 还包括了：</p>
<ul>
<li>浏览器对象模型（Browser Object Model，简称 BOM），也就是 <code>window</code>  对象</li>
<li>文档对象模型（Document Object Model，简称 DOM），也就是 <code>document</code> 对象</li>
</ul>
<p>而 Node.js 则是包括 V8 引擎。V8 是 Chrome 浏览器中的 JavaScript 引擎，经过多年的发展和优化，性能和安全性都已经达到了相当的高度。而 Node.js 则进一步将 V8 引擎加工成可以在任何操作系统中运行 JavaScript 的平台。</p>
<h3 id="预备知识"><a href="#预备知识" class="headerlink" title="预备知识"></a>预备知识</h3><p>在正式开始这篇教程之前，我们希望你已经做好了以下准备：</p>
<ul>
<li>了解 JavaScript 语言的基础知识，如果有过浏览器 JS 开发经验就更好了</li>
<li>已经安装了 Node.js，配置好了适合自己的编辑器或 IDE</li>
<li>了解相对路径和绝对路径</li>
</ul>
<h3 id="学习目标"><a href="#学习目标" class="headerlink" title="学习目标"></a>学习目标</h3><p>这篇文档将会让你学到：</p>
<ul>
<li>浏览器 JavaScript 与 Node.js 的关系与区别</li>
<li>了解 Node.js 有哪些全局对象</li>
<li>掌握 Node.js 如何导入和导出模块，以及模块机制的原理</li>
<li>了解如何用 Node.js 开发简单的命令行应用</li>
<li>学会利用 npm 社区的力量解决开发中遇到的难题，避免“重复造轮子”</li>
<li>了解 npm scripts 的基本概念和使用</li>
<li>初步了解 Node.js 的事件机制</li>
</ul>
<h3 id="运行-Node-代码"><a href="#运行-Node-代码" class="headerlink" title="运行 Node 代码"></a>运行 Node 代码</h3><p>运行 Node 代码通常有两种方式：1）在 REPL 中交互式输入和运行；2）将代码写入 JS 文件，并用 Node 执行。</p>
<div class="note info">
            <p><strong>提示</strong></p><p>REPL 的全称是 Read Eval Print Loop（读取-执行-输出-循环），通常可以理解为<strong>交互式解释器</strong>，你可以输入任何表达式或语句，然后就会立刻执行并返回结果。如果你用过 Python 的 REPL 一定会觉得很熟悉。</p>
          </div>

<h4 id="使用-REPL-快速体验"><a href="#使用-REPL-快速体验" class="headerlink" title="使用 REPL 快速体验"></a>使用 REPL 快速体验</h4><p>如果你已经安装好了 Node，那么运行以下命令就可以输出 Node.js 的版本：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ node -v</span><br><span class="line">v12.10.0</span><br></pre></td></tr></table></figure>

<p>然后，我们还可以进入 Node REPL（直接输入 <code>node</code>），然后输入任何合法的 JavaScript 表达式或语句：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ node</span><br><span class="line">Welcome to Node.js v12.10.0.</span><br><span class="line">Type &quot;.help&quot; for more information.</span><br><span class="line">&gt; 1 + 2</span><br><span class="line">3</span><br><span class="line">&gt; var x &#x3D; 10;</span><br><span class="line">undefined</span><br><span class="line">&gt; x + 20</span><br><span class="line">30</span><br><span class="line">&gt; console.log(&#39;Hello World&#39;);</span><br><span class="line">Hello World</span><br><span class="line">undefined</span><br></pre></td></tr></table></figure>

<p>有些行的开头是 <code>&gt;</code>，代表输入提示符，因此 <code>&gt;</code> 后面的都是我们要输入的命令，其他行则是表达式的返回值或标准输出（Standard Output，stdout）。运行的效果如下：</p>
<p><img alt data-src="https://static.powerformer.com/c/892fa12/repl.gif"></p>
<h4 id="编写-Node-脚本"><a href="#编写-Node-脚本" class="headerlink" title="编写 Node 脚本"></a>编写 Node 脚本</h4><p>REPL 通常用来进行一些代码的试验。在搭建具体应用时，更多的还是创建 Node 文件。我们先创建一个最简单的 Node.js 脚本文件，叫做 timer.js，代码如下：</p>
<figure class="highlight js"><figcaption><span>timer.js</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL21SY2Zwcy9ub2RlanMtcXVpY2tzdGFydC9ibG9iLzAzNzUyYzkvdGltZXIuanM=" title="https://github.com/mRcfps/nodejs-quickstart/blob/03752c9/timer.js">查看完整代码<i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">'Hello World!'</span>);</span><br></pre></td></tr></table></figure>

<p>然后用 Node 解释器执行这个文件：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ node timer.js</span><br><span class="line">Hello World!</span><br></pre></td></tr></table></figure>

<p>看上去非常平淡无奇，但是这一行代码却凝聚了 Node.js 团队背后的心血。我们来对比一下，在浏览器和 Node 环境中执行这行代码有什么区别：</p>
<ul>
<li>在浏览器运行 <code>console.log</code> 调用了 BOM，实际上执行的是 <code>window.console.log(&#39;Hello World!&#39;)</code></li>
<li>Node 首先在所处的操作系统中创建一个新的进程，然后向标准输出打印了指定的字符串， 实际上执行的是 <code>process.stdout.write(&#39;Hello World!\n&#39;)</code></li>
</ul>
<p>简而言之，Node 为我们提供了一个无需依赖浏览器、能够直接与操作系统进行交互的 JavaScript 代码运行环境！</p>
<h2 id="Node-全局对象初探"><a href="#Node-全局对象初探" class="headerlink" title="Node 全局对象初探"></a>Node 全局对象初探</h2><p>如果你有过编写 JavaScript 的经验，那么你一定对全局对象不陌生。在浏览器中，我们有 <code>document</code> 和 <code>window</code>  等全局对象；而 Node 只包含 ECMAScript 和 V8，不包含 BOM 和 DOM，因此 Node 中不存在 <code>document</code> 和 <code>window</code>；取而代之，Node 专属的全局对象是 <code>process</code>。在这一节中，我们将初步探索一番 Node 全局对象。</p>
<h3 id="JavaScript-全局对象的分类"><a href="#JavaScript-全局对象的分类" class="headerlink" title="JavaScript 全局对象的分类"></a>JavaScript 全局对象的分类</h3><p>在此之前，我们先看一下 JavaScript 各个运行环境的全局对象的比较，如下图所示：</p>
<p><img alt data-src="https://static.powerformer.com/c/892fa12/global-objects.png"></p>
<p>可以看到 JavaScript 全局对象可以分为四类：</p>
<ol>
<li>浏览器专属，例如 <code>window</code>、<code>alert</code> 等等；</li>
<li>Node 专属，例如 <code>process</code>、<code>__dirname</code>、<code>__filename</code> 等等；</li>
<li>浏览器和 Node 共有，但是<strong>实现方式不同</strong>，例如 <code>console</code>（第一节中已提到）、<code>setTimeout</code>、<code>setInterval</code> 等；</li>
<li>浏览器和 Node 共有，并且属于 <strong>ECMAScript 语言定义</strong>的一部分，例如 <code>Date</code>、<code>String</code>、<code>Promise</code> 等；</li>
</ol>
<h3 id="Node-专属全局对象解析"><a href="#Node-专属全局对象解析" class="headerlink" title="Node 专属全局对象解析"></a>Node 专属全局对象解析</h3><h4 id="process"><a href="#process" class="headerlink" title="process"></a><code>process</code></h4><p><code>process</code> 全局对象可以说是 Node.js 的灵魂，它是管理当前 Node.js 进程状态的对象，提供了与操作系统的简单接口。</p>
<p>首先我们探索一下 <code>process</code> 对象的重要属性。打开 Node REPL，然后我们查看一下 <code>process</code> 对象的一些属性：</p>
<ul>
<li><code>pid</code>：进程编号</li>
<li><code>env</code>：系统环境变量</li>
<li><code>argv</code>：命令行执行此脚本时的输入参数</li>
<li><code>platform</code>：当前操作系统的平台</li>
</ul>
<div class="note info">
            <p><strong>提示</strong></p><p>可以在 Node REPL 中尝试一下这些对象。像上面说的那样进入 REPL（你的输出很有可能跟我的不一样）：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ node</span><br><span class="line">Welcome to Node.js v12.10.0.</span><br><span class="line">Type <span class="string">".help"</span> <span class="keyword">for</span> more information.</span><br><span class="line">&gt; process.pid</span><br><span class="line">3</span><br><span class="line">&gt; process.platform</span><br><span class="line"><span class="string">'darwin'</span></span><br></pre></td></tr></table></figure>
          </div>

<h4 id="Buffer"><a href="#Buffer" class="headerlink" title="Buffer"></a><code>Buffer</code></h4><p><code>Buffer</code> 全局对象让 JavaScript 也能够轻松地处理二进制数据流，结合 Node 的流接口（Stream），能够实现高效的二进制文件处理。这篇教程不会涉及 <code>Buffer</code>。</p>
<h4 id="filename-和-dirname"><a href="#filename-和-dirname" class="headerlink" title="__filename 和 __dirname"></a><code>__filename</code> 和 <code>__dirname</code></h4><p>分别代表当前所运行 Node 脚本的文件路径和所在目录路径。</p>
<div class="note warning">
            <p><strong>注意</strong></p><p><code>__filename</code> 和 <code>__dirname</code> 只能在 Node 脚本文件中使用，在 REPL 中是没有定义的。</p>
          </div>

<h3 id="使用-Node-全局对象"><a href="#使用-Node-全局对象" class="headerlink" title="使用 Node 全局对象"></a>使用 Node 全局对象</h3><p>接下来我们将在刚才写的脚本文件中使用 Node 全局对象，分别涵盖上面的三类：</p>
<ul>
<li>Node 专属：<code>process</code></li>
<li>实现方式不同的共有全局对象：<code>console</code> 和 <code>setTimeout</code></li>
<li>ECMAScript 语言定义的全局对象：<code>Date</code></li>
</ul>
<div class="note info">
            <p><strong>提示</strong></p><p><code>setTimeout</code> 用于在一定时间后执行特定的逻辑，第一个参数为时间到了之后要执行的函数（回调函数），第二个参数是等待时间。例如：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">setTimeout(someFunction, <span class="number">1000</span>);</span><br></pre></td></tr></table></figure><p>就会在 <code>1000</code> 毫秒后执行 <code>someFunction</code> 函数。</p>
          </div>

<p>代码如下：</p>
<figure class="highlight js"><figcaption><span>timer.js</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL21SY2Zwcy9ub2RlanMtcXVpY2tzdGFydC9ibG9iL2Y5ZDMxOTAvdGltZXIuanM=" title="https://github.com/mRcfps/nodejs-quickstart/blob/f9d3190/timer.js">查看完整代码<i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line">[tuture-del]<span class="built_in">console</span>.log(<span class="string">'Hello World!'</span>);</span><br><span class="line">[tuture-add]setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">[tuture-add]  <span class="built_in">console</span>.log(<span class="string">'Hello World!'</span>);</span><br><span class="line">[tuture-add]&#125;, <span class="number">3000</span>);</span><br><span class="line">[tuture-add] </span><br><span class="line">[tuture-add]<span class="built_in">console</span>.log(<span class="string">'当前进程 ID'</span>, process.pid);</span><br><span class="line">[tuture-add]<span class="built_in">console</span>.log(<span class="string">'当前脚本路径'</span>, __filename);</span><br><span class="line">[tuture-add] </span><br><span class="line">[tuture-add]<span class="keyword">const</span> time = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">[tuture-add]<span class="built_in">console</span>.log(<span class="string">'当前时间'</span>, time.toLocaleString());</span><br></pre></td></tr></table></figure>

<p>运行以上脚本，在我机器上的输出如下（Hello World! 会延迟三秒输出）：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ node timer.js</span><br><span class="line">当前进程 ID 7310</span><br><span class="line">当前脚本路径 &#x2F;Users&#x2F;mRc&#x2F;Tutorials&#x2F;nodejs-quickstart&#x2F;timer.js</span><br><span class="line">当前时间 12&#x2F;4&#x2F;2019, 9:49:28 AM</span><br><span class="line">Hello World!</span><br></pre></td></tr></table></figure>

<p>从上面的代码中也可以一瞥 Node.js 异步的魅力：在 <code>setTimeout</code> 等待的 3 秒内，程序并<strong>没有阻塞</strong>，而是<strong>继续向下执行</strong>，这就是 Node.js 的异步非阻塞！</p>
<div class="note info">
            <p><strong>提示</strong></p><p>在实际的应用环境中，往往有很多 I/O 操作（例如网络请求、数据库查询等等）需要耗费相当多的时间，而 Node.js 能够在等待的同时继续处理新的请求，大大提高了系统的吞吐率。</p>
          </div>

<p>在后续教程中，我们会出一篇深入讲解 Node.js 异步编程的教程，敬请期待！</p>
<h2 id="理解-Node-模块机制"><a href="#理解-Node-模块机制" class="headerlink" title="理解 Node 模块机制"></a>理解 Node 模块机制</h2><p>Node.js 相比之前的浏览器 JavaScript 的另一个重点改变就是：模块机制的引入。这一节内容很长，但却是入门 Node.js 最为关键的一步，加油吧💪！</p>
<h3 id="JavaScript-的模块化之路"><a href="#JavaScript-的模块化之路" class="headerlink" title="JavaScript 的模块化之路"></a>JavaScript 的模块化之路</h3><p>Eric Raymond 在《UNIX编程艺术》中定义了<strong>模块性</strong>（Modularity）的规则：</p>
<blockquote>
<p>开发人员应使用通过定义明确的接口连接的简单零件来构建程序，因此问题是局部的，可以在将来的版本中替换程序的某些部分以支持新功能。 该规则旨在节省调试复杂、冗长且不可读的复杂代码的时间。</p>
</blockquote>
<p>“分而治之”的思想在计算机的世界非常普遍，但是在 ES2015 标准出现以前（<em>不了解没关系，后面会讲到</em>）， JavaScript 语言定义本身并没有模块化的机制，构建复杂应用也没有统一的接口标准。人们通常使用一系列的 <code>&lt;script&gt;</code> 标签来导入相应的模块（依赖）：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"fileA.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"fileB.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这种组织 JS 代码的方式有很多问题，其中最显著的包括：</p>
<ul>
<li>导入的多个 JS 文件直接作用于全局命名空间，很容易产生<strong>命名冲突</strong></li>
<li>导入的 JS 文件之间不能相互访问，例如 fileB.js 中无法访问 fileA.js 中的内容，很不方便</li>
<li>导入的 <code>&lt;script&gt;</code> 无法被轻易去除或修改</li>
</ul>
<p>人们渐渐认识到了 JavaScript 模块化机制的缺失带来的问题，于是两大模块化规范被提出：</p>
<ol>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZGpzL2FtZGpzLWFwaS9ibG9iL21hc3Rlci9BTUQubWQ=" title="https://github.com/amdjs/amdjs-api/blob/master/AMD.md">AMD（Asynchronous Module Definition）规范<i class="fa fa-external-link"></i></span>，在浏览器中使用较为普遍，最经典的实现包括 <span class="exturl" data-url="aHR0cHM6Ly9yZXF1aXJlanMub3JnLw==" title="https://requirejs.org/">RequireJS<i class="fa fa-external-link"></i></span>；</li>
<li><span class="exturl" data-url="aHR0cDovL3dpa2kuY29tbW9uanMub3JnL3dpa2kvQ29tbW9uSlM=" title="http://wiki.commonjs.org/wiki/CommonJS">CommonJS 规范<i class="fa fa-external-link"></i></span>，致力于为 JavaScript 生态圈提供统一的接口 API，Node.js 所实现的正是这一模块标准。</li>
</ol>
<div class="note info">
            <p><strong>提示</strong></p><p>ECMAScript 2015（也就是大家常说的 ES6）标准为 JavaScript 语言引入了全新的模块机制（称为 ES 模块，全称 ECMAScript Modules），并提供了 <code>import</code> 和 <code>export</code> 关键词，如果感兴趣可参考<span class="exturl" data-url="aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8zNjM1ODY5NQ==" title="https://zhuanlan.zhihu.com/p/36358695">这篇文章<i class="fa fa-external-link"></i></span>。但是截止目前，Node.js 对 ES 模块的支持还处于<strong>试验阶段</strong>，因此这篇文章不会讲解、也不提倡使用。</p>
          </div>

<h3 id="什么是-Node-模块"><a href="#什么是-Node-模块" class="headerlink" title="什么是 Node 模块"></a>什么是 Node 模块</h3><p>在正式分析 Node 模块机制之前，我们需要明确定义什么是 Node 模块。通常来说，Node 模块可分为两大类：</p>
<ul>
<li><strong>核心模块</strong>：Node 提供的内置模块，在安装 Node 时已经被编译成<strong>二进制可执行文件</strong></li>
<li><strong>文件模块</strong>：用户编写的模块，可以是自己写的，也可以是通过 npm 安装的（后面会讲到）。</li>
</ul>
<p>其中，文件模块可以是一个<strong>单独的文件</strong>（以 <code>.js</code>、<code>.node</code> 或 <code>.json</code> 结尾），或者是一个<strong>目录</strong>。当这个模块是一个目录时，<strong>模块名就是目录名</strong>，有两种情况：</p>
<ol>
<li>目录中有一个 package.json 文件，则这个 Node 模块的入口就是其中 <code>main</code> 字段指向的文件；</li>
<li>目录中有一个名为 index 的文件，扩展名为 <code>.js</code>、<code>.node</code> 或 <code>.json</code>，此文件则为模块入口文件。</li>
</ol>
<p>一下子消化不了没关系，可以先阅读后面的内容，忘记了模块的定义可以再回过来看看哦。</p>
<h3 id="Node-模块机制浅析"><a href="#Node-模块机制浅析" class="headerlink" title="Node 模块机制浅析"></a>Node 模块机制浅析</h3><p>知道了 Node 模块的具体定义后，我们来了解一下 Node 具体是怎样实现模块机制的。具体而言，Node 引入了三个新的全局对象（还是 Node 专属哦）：1）<code>require</code>；2） <code>exports</code> 和 3）<code>module</code>。下面我们逐一讲解。</p>
<p><strong><code>require</code></strong></p>
<p><code>require</code> 用于导入其他 Node 模块，其参数接受一个字符串代表模块的名称或路径，通常被称为<strong>模块标识符</strong>。具体有以下三种形式：</p>
<ul>
<li>直接写模块名称，通常是核心模块或第三方文件模块，例如 <code>os</code>、<code>express</code> 等</li>
<li>模块的相对路径，指向项目中其他 Node 模块，例如 <code>./utils</code></li>
<li>模块的绝对路径（<strong>不推荐！</strong>），例如 <code>/home/xxx/MyProject/utils</code></li>
</ul>
<div class="note info">
            <p><strong>提示</strong></p><p>在通过路径导入模块时，通常省略文件名中的 <code>.js</code> 后缀。</p>
          </div>

<p>代码示例如下：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导入内置库或第三方模块</span></span><br><span class="line"><span class="keyword">const</span> os = <span class="built_in">require</span>(<span class="string">'os'</span>);</span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 通过相对路径导入其他模块</span></span><br><span class="line"><span class="keyword">const</span> utils = <span class="built_in">require</span>(<span class="string">'./utils'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 通过绝对路径导入其他模块</span></span><br><span class="line"><span class="keyword">const</span> utils = <span class="built_in">require</span>(<span class="string">'/home/xxx/MyProject/utils'</span>);</span><br></pre></td></tr></table></figure>

<p>你也许会好奇，通过名称导入 Node 模块的时候（例如 <code>express</code>），是从哪里找到这个模块的？实际上每个模块都有个路径搜索列表 <code>module.paths</code>，在后面讲解 <code>module</code> 对象的时候就会一清二楚了。</p>
<p><strong><code>exports</code></strong></p>
<p>我们已经学会了用 <code>require</code> 导入其他模块中的内容，那么怎么写一个 Node 模块，并导出其中内容呢？答案就是用 <code>exports</code> 对象。</p>
<p>例如我们写一个 Node 模块 myModule.js：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// myModule.js</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导出函数 add</span></span><br><span class="line">exports.add = add;</span><br></pre></td></tr></table></figure>

<p>通过将 <code>add</code> 函数添加到 <code>exports</code> 对象中，外面的模块就可以通过以下代码使用这个函数。在 myModule.js 旁边创建一个 main.js，代码如下：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="keyword">const</span> myModule = <span class="built_in">require</span>(<span class="string">'./myModule'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用 myModule.js 中的 add 函数</span></span><br><span class="line">myModule.add(<span class="number">1</span>, <span class="number">2</span>);</span><br></pre></td></tr></table></figure>

<div class="note info">
            <p><strong>提示</strong></p><p>如果你熟悉 ECMAScript 6 中的<span class="exturl" data-url="aHR0cDovL2VzNi5ydWFueWlmZW5nLmNvbS8jZG9jcy9kZXN0cnVjdHVyaW5n" title="http://es6.ruanyifeng.com/#docs/destructuring">解构赋值<i class="fa fa-external-link"></i></span>，那么可以用更优雅的方式获取 <code>add</code> 函数：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; add &#125; = <span class="built_in">require</span>(<span class="string">'./myModule'</span>);</span><br></pre></td></tr></table></figure>
          </div>

<p><strong><code>module</code></strong></p>
<p>通过 <code>require</code> 和 <code>exports</code>，我们已经知道了如何导入、导出 Node 模块中的内容，但是你可能还是觉得 Node 模块机制有一丝丝神秘的感觉。接下来，我们将掀开这神秘的面纱，了解一下背后的主角——<code>module</code> 模块对象。</p>
<p>我们可以在刚才的 myModule.js 文件的最后加上这一行代码：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">'module myModule:'</span>, <span class="built_in">module</span>);</span><br></pre></td></tr></table></figure>

<p>在 main.js 最后加上：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">'module main:'</span>, <span class="built_in">module</span>);</span><br></pre></td></tr></table></figure>

<p>运行后会打印出来这样的内容（左边是 myModule，右边是 module）：</p>
<p><img alt data-src="https://static.powerformer.com/c/892fa12/module.png"></p>
<p>可以看到 <code>module</code> 对象有以下字段：</p>
<ul>
<li><code>id</code>：模块的唯一标识符，如果是被运行的主程序（例如 main.js）则为 <code>.</code>，如果是被导入的模块（例如 myModule.js）则等同于此文件名（即下面的 <code>filename</code> 字段）</li>
<li><code>path</code> 和 <code>filename</code>：模块所在路径和文件名，没啥好说的</li>
<li><code>exports</code>：模块所导出的内容，实际上<strong>之前的 **</strong><code>exports</code><strong>** 对象是指向 **</strong><code>module.exports</code><strong>** 的引用</strong>。例如对于 myModule.js，刚才我们导出了 <code>add</code> 函数，因此出现在了这个 <code>exports</code> 字段里面；而 main.js 没有导出任何内容，因此 <code>exports</code> 字段为空</li>
<li><code>parent</code> 和 <code>children</code>：用于记录模块之间的导入关系，例如 main.js 中 <code>require</code> 了 myModule.js，那么 main 就是 myModule 的 <code>parent</code>，myModule 就是 main 的 <code>children</code></li>
<li><code>loaded</code>：模块是否被加载，从上图中可以看出只有 <code>children</code> 中列出的模块才会被加载</li>
<li><code>paths</code>：这个就是 Node <strong>搜索文件模块的路径列表</strong>，Node 会从第一个路径到最后一个路径依次搜索指定的 Node 模块，找到了则导入，找不到就会报错</li>
</ul>
<div class="note info">
            <p><strong>提示</strong></p><p>如果你仔细观察，会发现 Node 文件模块查找路径（<code>module.paths</code>）的方式其实是这样的：先找当前目录下的 node_modules，没有的话再找上一级目录的 node_modules，还没找到的话就一直向上找，直到根目录下的 node_modules。</p>
          </div>

<p><strong>深入理解 **</strong><code>module.exports</code>**</p>
<p>之前我们提到，<code>exports</code> 对象本质上是 <code>module.exports</code> 的引用。也就是说，下面两行代码是等价的：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导出 add 函数</span></span><br><span class="line">exports.add = add;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 和上面一行代码是一样的</span></span><br><span class="line"><span class="built_in">module</span>.exports.add = add;</span><br></pre></td></tr></table></figure>

<p>实际上还有第二种导出方式，直接把 <code>add</code> 函数赋给 <code>module.exports</code> 对象：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = add;</span><br></pre></td></tr></table></figure>

<p>这样写和第一种导出方式有什么区别呢？第一种方式，在 <code>exports</code> 对象上添加一个属性名为 <code>add</code>，该属性的值为 <code>add</code> 函数；第二种方式，直接令 <code>exports</code> 对象为 <code>add</code> 函数。可能有点绕，但是请一定要理解这两者的重大区别！你也许猜到了，当我们使用 <code>module.exports</code> 导出时，就意味着整个模块只能导出一个变量或函数了。</p>
<p>在 <code>require</code> 时，两者的区别就很明显了：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 第一种导出方式，需要访问 add 属性获取到 add 函数</span></span><br><span class="line"><span class="keyword">const</span> myModule = <span class="built_in">require</span>(<span class="string">'./myModule'</span>);</span><br><span class="line">myModule.add(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 第二种导出方式，可以直接使用 add 函数</span></span><br><span class="line"><span class="keyword">const</span> add = <span class="built_in">require</span>(<span class="string">'./myModule'</span>);</span><br><span class="line">add(<span class="number">1</span>, <span class="number">2</span>);</span><br></pre></td></tr></table></figure>

<div class="note warning">
            <p><strong>注意</strong></p><p>直接写 <code>exports = add;</code> 无法导出 <code>add</code> 函数，因为 <code>exports</code> 本质上是指向 <code>module</code> 的 <code>exports</code> 属性的引用，直接对 <code>exports</code> 赋值只会改变 <code>exports</code>，对 <code>module.exports</code> 没有影响。如果你觉得难以理解，那我们用 <code>apple</code> 和 <code>price</code> 类比 <code>module</code> 和 <code>exports</code>：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">apple = &#123; <span class="attr">price</span>: <span class="number">1</span> &#125;;   <span class="comment">// 想象 apple 就是 module</span></span><br><span class="line">price = apple.price;    <span class="comment">// 想象 price 就是 exports</span></span><br><span class="line">apple.price = <span class="number">3</span>;        <span class="comment">// 改变了 apple.price</span></span><br><span class="line">price = <span class="number">3</span>;              <span class="comment">// 只改变了 price，没有改变 apple.price</span></span><br></pre></td></tr></table></figure><p>我们只能通过 <code>apple.price = 1</code> 设置 <code>price</code> 属性，而直接对 <code>price</code> 赋值并不能修改 <code>apple.price</code>。</p>
          </div>

<h3 id="重构-timer-脚本"><a href="#重构-timer-脚本" class="headerlink" title="重构 timer 脚本"></a>重构 timer 脚本</h3><p>在聊了这么多关于 Node 模块机制的内容后，是时候回到我们之前的定时器脚本 timer.js 了。我们首先创建一个新的 Node 模块 info.js，用于打印系统信息，代码如下：</p>
<figure class="highlight js"><figcaption><span>info.js</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL21SY2Zwcy9ub2RlanMtcXVpY2tzdGFydC9ibG9iLzk4YTczNmQvaW5mby5qcw==" title="https://github.com/mRcfps/nodejs-quickstart/blob/98a736d/info.js">查看完整代码<i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> os = <span class="built_in">require</span>(<span class="string">'os'</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">printProgramInfo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'当前用户'</span>, os.userInfo().username);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'当前进程 ID'</span>, process.pid);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'当前脚本路径'</span>, __filename);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = printProgramInfo;</span><br></pre></td></tr></table></figure>

<p>这里我们导入了 Node 内置模块 <code>os</code>，并通过 <code>os.userInfo()</code> 查询到了系统用户名，接着通过 <code>module.exports</code> 导出了 <code>printProgramInfo</code> 函数。</p>
<p>然后创建第二个 Node 模块 datetime.js，用于返回当前的时间，代码如下：</p>
<figure class="highlight js"><figcaption><span>datetime.js</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL21SY2Zwcy9ub2RlanMtcXVpY2tzdGFydC9ibG9iLzk4YTczNmQvZGF0ZXRpbWUuanM=" title="https://github.com/mRcfps/nodejs-quickstart/blob/98a736d/datetime.js">查看完整代码<i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getCurrentTime</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> time = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">  <span class="keyword">return</span> time.toLocaleString();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">exports.getCurrentTime = getCurrentTime;</span><br></pre></td></tr></table></figure>

<p>上面的模块中，我们选择了通过 <code>exports</code> 导出 <code>getCurrentTime</code> 函数。</p>
<p>最后，我们在 timer.js 中通过 <code>require</code> 导入刚才两个模块，并分别调用模块中的函数 <code>printProgramInfo</code> 和 <code>getCurrentTime</code>，代码如下：</p>
<figure class="highlight js"><figcaption><span>timer.js</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL21SY2Zwcy9ub2RlanMtcXVpY2tzdGFydC9ibG9iLzk4YTczNmQvdGltZXIuanM=" title="https://github.com/mRcfps/nodejs-quickstart/blob/98a736d/timer.js">查看完整代码<i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line">[tuture-add]<span class="keyword">const</span> printProgramInfo = <span class="built_in">require</span>(<span class="string">'./info'</span>);</span><br><span class="line">[tuture-add]<span class="keyword">const</span> datetime = <span class="built_in">require</span>(<span class="string">'./datetime'</span>);</span><br><span class="line">[tuture-add] </span><br><span class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'Hello World!'</span>);</span><br><span class="line">&#125;, <span class="number">3000</span>);</span><br><span class="line"></span><br><span class="line">[tuture-del]<span class="built_in">console</span>.log(<span class="string">'当前进程 ID'</span>, process.pid);</span><br><span class="line">[tuture-del]<span class="built_in">console</span>.log(<span class="string">'当前脚本路径'</span>, __filename);</span><br><span class="line">[tuture-del] </span><br><span class="line">[tuture-del]<span class="keyword">const</span> time = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">[tuture-del]<span class="built_in">console</span>.log(<span class="string">'当前时间'</span>, time.toLocaleString());</span><br><span class="line">[tuture-add]printProgramInfo();</span><br><span class="line">[tuture-add]<span class="built_in">console</span>.log(<span class="string">'当前时间'</span>, datetime.getCurrentTime());</span><br></pre></td></tr></table></figure>

<p>再运行一下 timer.js，输出内容应该与之前完全一致。</p>
<p>读到这里，我想先恭喜你渡过了 Node.js 入门最难的一关！如果你已经真正地理解了 Node 模块机制，那么我相信接下来的学习会无比轻松哦。</p>
<h2 id="命令行开发：接受输入参数"><a href="#命令行开发：接受输入参数" class="headerlink" title="命令行开发：接受输入参数"></a>命令行开发：接受输入参数</h2><p>Node.js 作为可以在操作系统中直接运行 JavaScript 代码的平台，为前端开发者开启了无限可能，其中就包括一系列用于实现前端自动化工作流的命令行工具，例如 <span class="exturl" data-url="aHR0cDovL2dydW50anMuY29tLw==" title="http://gruntjs.com/">Grunt<i class="fa fa-external-link"></i></span>、<span class="exturl" data-url="aHR0cHM6Ly9ndWxwanMuY29tLw==" title="https://gulpjs.com/">Gulp<i class="fa fa-external-link"></i></span> 还有大名鼎鼎的 <span class="exturl" data-url="aHR0cHM6Ly93ZWJwYWNrLmpzLm9yZy8=" title="https://webpack.js.org/">Webpack<i class="fa fa-external-link"></i></span>。</p>
<p>从这一步开始，我们将把 timer.js 改造成一个命令行应用。具体地，我们希望 timer.js 可以通过命令行参数指定等待的时间（<code>time</code> 选项）和最终输出的信息（<code>message</code> 选项）：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ node timer.js --time 5 --message <span class="string">"Hello Tuture"</span></span><br></pre></td></tr></table></figure>

<h3 id="通过-process-argv-读取命令行参数"><a href="#通过-process-argv-读取命令行参数" class="headerlink" title="通过 process.argv 读取命令行参数"></a>通过 <code>process.argv</code> 读取命令行参数</h3><p>之前在讲全局对象 <code>process</code> 时提到一个 <code>argv</code> 属性，能够获取命令行参数的数组。创建一个 args.js 文件，代码如下：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(process.argv);</span><br></pre></td></tr></table></figure>

<p>然后运行以下命令：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ node args.js --time 5 --message <span class="string">"Hello Tuture"</span></span><br></pre></td></tr></table></figure>

<p>输出一个数组：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[</span><br><span class="line">  &#39;&#x2F;Users&#x2F;mRc&#x2F;.nvm&#x2F;versions&#x2F;node&#x2F;v12.10.0&#x2F;bin&#x2F;node&#39;,</span><br><span class="line">  &#39;&#x2F;Users&#x2F;mRc&#x2F;Tutorials&#x2F;nodejs-quickstart&#x2F;args.js&#39;,</span><br><span class="line">  &#39;--time&#39;,</span><br><span class="line">  &#39;5&#39;,</span><br><span class="line">  &#39;--message&#39;,</span><br><span class="line">  &#39;Hello Tuture&#39;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>可以看到，<code>process.argv</code> 数组的第 0 个元素是 <code>node</code> 的实际路径，第 1 个元素是 args.js 的路径，后面则是输入的所有参数。</p>
<h3 id="实现命令行应用"><a href="#实现命令行应用" class="headerlink" title="实现命令行应用"></a>实现命令行应用</h3><p>根据刚才的分析，我们可以非常简单粗暴地获取 <code>process.argv</code> 的第 3 个和第 5 个元素，分别可以得到 <code>time</code> 和 <code>message</code> 参数。于是修改 timer.js 的代码如下：</p>
<figure class="highlight js"><figcaption><span>timer.js</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL21SY2Zwcy9ub2RlanMtcXVpY2tzdGFydC9ibG9iLzA2NThjNjUvdGltZXIuanM=" title="https://github.com/mRcfps/nodejs-quickstart/blob/0658c65/timer.js">查看完整代码<i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> printProgramInfo = <span class="built_in">require</span>(<span class="string">'./info'</span>);</span><br><span class="line"><span class="keyword">const</span> datetime = <span class="built_in">require</span>(<span class="string">'./datetime'</span>);</span><br><span class="line"></span><br><span class="line">[tuture-add]<span class="keyword">const</span> waitTime = <span class="built_in">Number</span>(process.argv[<span class="number">3</span>]);</span><br><span class="line">[tuture-add]<span class="keyword">const</span> message = process.argv[<span class="number">5</span>];</span><br><span class="line">[tuture-add] </span><br><span class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">[tuture-del]  <span class="built_in">console</span>.log(<span class="string">'Hello World!'</span>);</span><br><span class="line">[tuture-del]&#125;, <span class="number">3000</span>);</span><br><span class="line">[tuture-add]  <span class="built_in">console</span>.log(message);</span><br><span class="line">[tuture-add]&#125;, waitTime * <span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">printProgramInfo();</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'当前时间'</span>, datetime.getCurrentTime());</span><br></pre></td></tr></table></figure>

<p>提醒一下，<code>setTimeout</code> 中时间的单位是毫秒，而我们指定的时间参数单位是秒，因此要乘 1000。</p>
<p>运行 timer.js，加上刚才说的所有参数：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ node timer.js --time 5 --message <span class="string">"Hello Tuture"</span></span><br></pre></td></tr></table></figure>

<p>等待 5 秒钟后，你就看到了 Hello Tuture 的提示文本！</p>
<p>不过很显然，目前这个版本有很大的问题：输入参数的格式是固定的，很不灵活，比如说调换 <code>time</code> 和 <code>message</code> 的输入顺序就会出错，也不能检查用户是否输入了指定的参数，格式是否正确等等。如果要亲自实现上面所说的功能，那可得花很大的力气，说不定还会有不少 Bug。有没有更好的方案呢？</p>
<h2 id="npm：洪荒之力，都赐予你"><a href="#npm：洪荒之力，都赐予你" class="headerlink" title="npm：洪荒之力，都赐予你"></a>npm：洪荒之力，都赐予你</h2><p>从这一节开始，你将不再是一个人写代码。你的背后将拥有百万名 JavaScript 开发者的支持，而这一切仅需要 npm 就可以实现。npm 包括：</p>
<ul>
<li>npm 命令行工具（安装 node 时也会附带安装）</li>
<li>npm 集中式依赖仓库（registry），存放了其他 JavaScript 开发者分享的 npm 包</li>
<li>npm <span class="exturl" data-url="aHR0cHM6Ly9ucG1qcy5jb20=" title="https://npmjs.com">网站<i class="fa fa-external-link"></i></span>，可以搜索需要的 npm 包、管理 npm 帐户等</li>
</ul>
<h3 id="npm-初探"><a href="#npm-初探" class="headerlink" title="npm 初探"></a>npm 初探</h3><p>我们首先打开终端（命令行），检查一下 <code>npm</code> 命令是否可用：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ npm -v</span><br><span class="line">6.10.3</span><br></pre></td></tr></table></figure>

<p>然后在当前目录（也就是刚才编辑的 timer.js 所在的文件夹）运行以下命令，把当前项目初始化为 npm 项目:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ npm init</span><br></pre></td></tr></table></figure>

<p>这时候 npm 会提一系列问题，你可以一路回车下去，也可以仔细回答，最终会创建一个 package.json 文件。package.json 文件是一个 npm 项目的核心，记录了这个项目所有的关键信息，内容如下：</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"name"</span>: <span class="string">"timer"</span>,</span><br><span class="line">  <span class="attr">"version"</span>: <span class="string">"1.0.0"</span>,</span><br><span class="line">  <span class="attr">"description"</span>: <span class="string">"A cool timer"</span>,</span><br><span class="line">  <span class="attr">"main"</span>: <span class="string">"timer.js"</span>,</span><br><span class="line">  <span class="attr">"scripts"</span>: &#123;</span><br><span class="line">    <span class="attr">"test"</span>: <span class="string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"repository"</span>: &#123;</span><br><span class="line">    <span class="attr">"type"</span>: <span class="string">"git"</span>,</span><br><span class="line">    <span class="attr">"url"</span>: <span class="string">"git+https://github.com/mRcfps/nodejs-quickstart.git"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"author"</span>: <span class="string">"mRcfps"</span>,</span><br><span class="line">  <span class="attr">"license"</span>: <span class="string">"ISC"</span>,</span><br><span class="line">  <span class="attr">"bugs"</span>: &#123;</span><br><span class="line">    <span class="attr">"url"</span>: <span class="string">"https://github.com/mRcfps/nodejs-quickstart/issues"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"homepage"</span>: <span class="string">"https://github.com/mRcfps/nodejs-quickstart#readme"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>其中大部分字段的含义都很明确，例如 <code>name</code> 项目名称、 <code>version</code> 版本号、<code>description</code> 描述、<code>author</code> 作者等等。不过这个 <code>scripts</code> 字段你可能会比较困惑，我们会在下一节中详细介绍。</p>
<h3 id="安装-npm-包"><a href="#安装-npm-包" class="headerlink" title="安装 npm 包"></a>安装 npm 包</h3><p>接下来我们将讲解 npm 最最最常用的命令—— <code>install</code>。没错，毫不夸张地说，一个 JavaScript 程序员用的最多的 npm 命令就是 <code>npm install</code>。</p>
<p>在安装我们需要的 npm 包之前，我们需要去探索一下有哪些包可以为我们所用。通常，我们可以在 <span class="exturl" data-url="aHR0cHM6Ly9ucG1qcy5jb20=" title="https://npmjs.com">npm 官方网站<i class="fa fa-external-link"></i></span> 上进行关键词搜索（记得用英文哦），比如说我们搜 command line：</p>
<p><img alt data-src="https://static.powerformer.com/c/892fa12/search-npm.png"></p>
<p>出来的第一个结果 commander 就很符合我们的需要，点进去就是安装的说明和<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RqL2NvbW1hbmRlci5qcy9ibG9iL0hFQUQvUmVhZG1lX3poLUNOLm1k" title="https://github.com/tj/commander.js/blob/HEAD/Readme_zh-CN.md">使用文档<i class="fa fa-external-link"></i></span>。我们还想要一个“加载中”的动画效果，提高用户的使用体验，试着搜一下 loading 关键词：</p>
<p><img alt data-src="https://static.powerformer.com/c/892fa12/search-npm2.png"></p>
<p>第二个结果 ora 也符合我们的需要。那我们现在就安装这两个 npm 包：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ npm install commander ora</span><br></pre></td></tr></table></figure>

<p>少许等待后，可以看到 package.json 多了一个非常重要的 <code>dependencies</code> 字段：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">"dependencies": &#123;</span><br><span class="line">  "commander": "^4.0.1",</span><br><span class="line">  "ora": "^4.0.3"</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个字段中就记录了我们这个项目的<strong>直接依赖</strong>。与<strong>直接依赖</strong>相对的就是<strong>间接依赖</strong>，例如 commander 和 ora 的依赖，我们通常不用关心。所有的 npm 包（直接依赖和间接依赖）全部都存放在项目的 node_modules 目录中。</p>
<div class="note info">
            <p><strong>提示</strong></p><p>node_modules 通常有很多的文件，因此不会加入到 Git 版本控制系统中，你从网上下载的 npm 项目一般也只会有 package.json，这时候只需运行 <code>npm install</code>（后面不跟任何内容），就可以下载并安装所有依赖了。</p>
          </div>

<p>整个 package.json 代码如下所示：</p>
<figure class="highlight json"><figcaption><span>package.json</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL21SY2Zwcy9ub2RlanMtcXVpY2tzdGFydC9ibG9iL2YyYTFiMGMvcGFja2FnZS5qc29u" title="https://github.com/mRcfps/nodejs-quickstart/blob/f2a1b0c/package.json">查看完整代码<i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"name"</span>: <span class="string">"timer"</span>,</span><br><span class="line">  <span class="attr">"version"</span>: <span class="string">"1.0.0"</span>,</span><br><span class="line">  <span class="attr">"description"</span>: <span class="string">"A cool timer"</span>,</span><br><span class="line">  <span class="attr">"main"</span>: <span class="string">"timer.js"</span>,</span><br><span class="line">  <span class="attr">"scripts"</span>: &#123;</span><br><span class="line">    <span class="attr">"test"</span>: <span class="string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"repository"</span>: &#123;</span><br><span class="line">    <span class="attr">"type"</span>: <span class="string">"git"</span>,</span><br><span class="line">    <span class="attr">"url"</span>: <span class="string">"git+https://github.com/mRcfps/nodejs-quickstart.git"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"author"</span>: <span class="string">"mRcfps"</span>,</span><br><span class="line">  <span class="attr">"license"</span>: <span class="string">"ISC"</span>,</span><br><span class="line">  <span class="attr">"bugs"</span>: &#123;</span><br><span class="line">    <span class="attr">"url"</span>: <span class="string">"https://github.com/mRcfps/nodejs-quickstart/issues"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"homepage"</span>: <span class="string">"https://github.com/mRcfps/nodejs-quickstart#readme"</span>,</span><br><span class="line">  <span class="attr">"dependencies"</span>: &#123;</span><br><span class="line">    <span class="attr">"commander"</span>: <span class="string">"^4.0.1"</span>,</span><br><span class="line">    <span class="attr">"ora"</span>: <span class="string">"^4.0.3"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="关于版本号"><a href="#关于版本号" class="headerlink" title="关于版本号"></a>关于版本号</h3><p>在软件开发中，版本号是一个非常重要的概念，不同版本的软件存在或大或小的差异。npm 采用了语义版本号（Semantic Versioning，简称 <span class="exturl" data-url="aHR0cHM6Ly9zZW12ZXIub3JnL2xhbmcvemgtQ04v" title="https://semver.org/lang/zh-CN/">semver<i class="fa fa-external-link"></i></span>），具体规定如下：</p>
<ul>
<li>版本格式为：主版本号.次版本号.修订号</li>
<li>主版本号的改变意味着<strong>不兼容的 API 修改</strong></li>
<li>次版本号的改变意味着做了<strong>向下兼容的功能性新增</strong></li>
<li>修订号的改变意味着做了<strong>向下兼容的问题修正</strong></li>
</ul>
<div class="note info">
            <p><strong>提示</strong></p><p><strong>向下兼容</strong>的简单理解就是<strong>功能只增不减</strong>。</p>
          </div>

<p>因此在 package.json 的 <code>dependencies</code> 字段中，可以通过以下方式指定版本：</p>
<ul>
<li><strong>精确版本</strong>：例如 <code>1.0.0</code>，一定只会安装版本为 <code>1.0.0</code> 的依赖</li>
<li><strong>锁定主版本和次版本</strong>：可以写成 <code>1.0</code>、<code>1.0.x</code> 或 <code>~1.0.0</code>，那么可能会安装例如 <code>1.0.8</code> 的依赖</li>
<li><strong>仅锁定主版本</strong>：可以写成 <code>1</code>、<code>1.x</code> 或 <code>^1.0.0</code>（ <code>npm install</code> 默认采用的形式），那么可能会安装例如 <code>1.1.0</code> 的依赖</li>
<li><strong>最新版本</strong>：可以写成 <code>*</code> 或 <code>x</code>，那么直接安装最新版本（不推荐）</li>
</ul>
<p>你也许注意到了 npm 还创建了一个 package-lock.json，这个文件就是用来<strong>锁定全部直接依赖和间接依赖的精确版本号</strong>，或者说提供了关于 node_modules 目录的精确描述，从而确保在这个项目中开发的所有人都能有完全一致的 npm 依赖。</p>
<h3 id="站在巨人的肩膀上"><a href="#站在巨人的肩膀上" class="headerlink" title="站在巨人的肩膀上"></a>站在巨人的肩膀上</h3><p>我们在大致读了一下 commander 和 ora 的文档之后，就可以开始用起来了，修改 timer.js 代码如下：</p>
<figure class="highlight js"><figcaption><span>timer.js</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL21SY2Zwcy9ub2RlanMtcXVpY2tzdGFydC9ibG9iL2YyYTFiMGMvdGltZXIuanM=" title="https://github.com/mRcfps/nodejs-quickstart/blob/f2a1b0c/timer.js">查看完整代码<i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line">[tuture-add]<span class="keyword">const</span> program = <span class="built_in">require</span>(<span class="string">'commander'</span>);</span><br><span class="line">[tuture-add]<span class="keyword">const</span> ora = <span class="built_in">require</span>(<span class="string">'ora'</span>);</span><br><span class="line"><span class="keyword">const</span> printProgramInfo = <span class="built_in">require</span>(<span class="string">'./info'</span>);</span><br><span class="line"><span class="keyword">const</span> datetime = <span class="built_in">require</span>(<span class="string">'./datetime'</span>);</span><br><span class="line"></span><br><span class="line">[tuture-del]<span class="keyword">const</span> waitTime = <span class="built_in">Number</span>(process.argv[<span class="number">3</span>]);</span><br><span class="line">[tuture-del]<span class="keyword">const</span> message = process.argv[<span class="number">5</span>];</span><br><span class="line">[tuture-add]program</span><br><span class="line">[tuture-add]  .option(<span class="string">'-t, --time &lt;number&gt;'</span>, <span class="string">'等待时间 (秒)'</span>, <span class="number">3</span>)</span><br><span class="line">[tuture-add]  .option(<span class="string">'-m, --message &lt;string&gt;'</span>, <span class="string">'要输出的信息'</span>, <span class="string">'Hello World'</span>)</span><br><span class="line">[tuture-add]  .parse(process.argv);</span><br><span class="line"></span><br><span class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">[tuture-del]  <span class="built_in">console</span>.log(message);</span><br><span class="line">[tuture-del]&#125;, waitTime * <span class="number">1000</span>);</span><br><span class="line">[tuture-add]  spinner.stop();</span><br><span class="line">[tuture-add]  <span class="built_in">console</span>.log(program.message);</span><br><span class="line">[tuture-add]&#125;, program.time * <span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">printProgramInfo();</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'当前时间'</span>, datetime.getCurrentTime());</span><br><span class="line">[tuture-add]<span class="keyword">const</span> spinner = ora(<span class="string">'正在加载中，请稍后 ...'</span>).start();</span><br></pre></td></tr></table></figure>

<p>这次，我们再次运行 timer.js：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ node timer.js --message <span class="string">"洪荒之力！"</span> --time 5</span><br></pre></td></tr></table></figure>

<p><img alt data-src="https://static.powerformer.com/c/892fa12/power.gif"></p>
<p>转起来了！</p>
<h2 id="尝鲜-npm-scripts"><a href="#尝鲜-npm-scripts" class="headerlink" title="尝鲜 npm scripts"></a>尝鲜 npm scripts</h2><p>在这一节中，我们将简单地介绍一下 npm scripts，也就是 npm 脚本。之前在 package.json 中提到，有个字段叫 <code>scripts</code>，这个字段就定义了全部的 npm scripts。我们发现在用 <code>npm init</code> 时创建的 package.json 文件默认就添加了一个 <code>test</code> 脚本：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">"test": "echo \"Error: no test specified\" &amp;&amp; exit 1"</span><br></pre></td></tr></table></figure>

<p>那一串命令就是 test 脚本将要执行的内容，我们可以通过 <code>npm test</code> 命令执行该脚本：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ npm <span class="built_in">test</span></span><br><span class="line"></span><br><span class="line">&gt; timer@1.0.0 <span class="built_in">test</span> /Users/mRc/Tutorials/nodejs-quickstart</span><br><span class="line">&gt; <span class="built_in">echo</span> <span class="string">"Error: no test specified"</span> &amp;&amp; <span class="built_in">exit</span> 1</span><br><span class="line"></span><br><span class="line">Error: no <span class="built_in">test</span> specified</span><br><span class="line">npm ERR! Test failed.  See above <span class="keyword">for</span> more details.</span><br></pre></td></tr></table></figure>

<p>在初步体验了 npm scripts 之后，我们有必要了解一下 npm scripts 分为两大类：</p>
<ul>
<li><strong>预定义脚本</strong>：例如 <code>test</code>、<code>start</code>、<code>install</code>、<code>publish</code> 等等，直接通过 <code>npm &lt;scriptName&gt;</code> 运行，例如 <code>npm test</code>，所有预定义的脚本可查看<span class="exturl" data-url="aHR0cHM6Ly9kb2NzLm5wbWpzLmNvbS9taXNjL3NjcmlwdHMjZGVzY3JpcHRpb24=" title="https://docs.npmjs.com/misc/scripts#description">文档<i class="fa fa-external-link"></i></span></li>
<li><strong>自定义脚本</strong>：除了以上自带脚本的其他脚本，需要通过 <code>npm run &lt;scriptName&gt;</code> 运行，例如 <code>npm run custom</code></li>
</ul>
<p>现在就让我们开始为 timer 项目添加两个 npm scripts，分别是 <code>start</code> 和 <code>lint</code>。第一个是预定义的，用于启动我们的 timer.js；第二个是静态代码检查，用于在开发时检查我们的代码。首先安装 <span class="exturl" data-url="aHR0cDovL2VzbGludC5jbi8=" title="http://eslint.cn/">ESLint<i class="fa fa-external-link"></i></span> npm 包：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ npm install eslint --save-dev</span><br><span class="line">$ <span class="comment"># 或者</span></span><br><span class="line">$ npm install eslint -D</span><br></pre></td></tr></table></figure>

<p>注意到我们加了一个 <code>-D</code> 或 <code>--save-dev</code> 选项，代表 <code>eslint</code> 是一个<strong>开发依赖</strong>，在实际项目发布或部署时不需要用到。npm 会把所有开发依赖添加到 <code>devDependencies</code> 字段中。然后分别添加 <code>start</code> 和 <code>lint</code> 脚本，代码如下：</p>
<figure class="highlight"><figcaption><span>package.json</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL21SY2Zwcy9ub2RlanMtcXVpY2tzdGFydC9ibG9iLzU2ZTZjMTgvcGFja2FnZS5qc29u" title="https://github.com/mRcfps/nodejs-quickstart/blob/56e6c18/package.json">查看完整代码<i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"name"</span>: <span class="string">"timer"</span>,</span><br><span class="line">  <span class="attr">"version"</span>: <span class="string">"1.0.0"</span>,</span><br><span class="line">  <span class="attr">"description"</span>: <span class="string">"A cool timer"</span>,</span><br><span class="line">  <span class="attr">"main"</span>: <span class="string">"timer.js"</span>,</span><br><span class="line">  <span class="attr">"scripts"</span>: &#123;</span><br><span class="line">[tuture-add]    "lint": "eslint **/*.js",</span><br><span class="line">[tuture-add]    "start": "node timer.js -m '上手了' -t 3",</span><br><span class="line">    "test": "echo \"Error: no test specified\" &amp;&amp; exit 1"</span><br><span class="line">  &#125;,</span><br><span class="line">  "repository": &#123;</span><br><span class="line">    "type": "git",</span><br><span class="line">    "url": "git+https://github.com/mRcfps/nodejs-quickstart.git"</span><br><span class="line">  &#125;,</span><br><span class="line">  "author": "mRcfps",</span><br><span class="line">  "license": "ISC",</span><br><span class="line">  "bugs": &#123;</span><br><span class="line">    "url": "https://github.com/mRcfps/nodejs-quickstart/issues"</span><br><span class="line">  &#125;,</span><br><span class="line">  "homepage": "https://github.com/mRcfps/nodejs-quickstart#readme",</span><br><span class="line">  "dependencies": &#123;</span><br><span class="line">    "commander": "^4.0.1",</span><br><span class="line">    "ora": "^4.0.3"</span><br><span class="line">[tuture-add]  &#125;,</span><br><span class="line">[tuture-add]  "devDependencies": &#123;</span><br><span class="line">[tuture-add]    "eslint": "^6.7.2"</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ESLint 的使用需要一个配置文件，创建 .eslintrc.js 文件（注意最前面有一个点），代码如下：</p>
<figure class="highlight js"><figcaption><span>.eslintrc.js</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL21SY2Zwcy9ub2RlanMtcXVpY2tzdGFydC9ibG9iLzU2ZTZjMTgvLmVzbGludHJjLmpz" title="https://github.com/mRcfps/nodejs-quickstart/blob/56e6c18/.eslintrc.js">查看完整代码<i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="string">"env"</span>: &#123;</span><br><span class="line">        <span class="string">"es6"</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="string">"node"</span>: <span class="literal">true</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"extends"</span>: <span class="string">"eslint:recommended"</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>运行 <code>npm start</code>，可以看到成功地运行了我们的 timer.js 脚本；而运行 <code>npm run lint</code>，没有输出任何结果（代表静态检查通过）。</p>
<p>npm scripts 看上去平淡无奇，但是却能为项目开发提供非常便利的工作流。例如，之前构建一个项目需要非常复杂的命令，但是如果你实现了一个 <code>build</code> npm 脚本，那么当你的同事拿到这份代码时，只需简单地执行 <code>npm run build</code> 就可以开始构建，而无需关心背后的技术细节。在后续的 Node.js 或是前端学习中，我们会在实际项目中使用各种 npm scripts 来定义我们的工作流，大家慢慢就会领会到它的强大了。</p>
<h2 id="下次再见：监听-exit-事件"><a href="#下次再见：监听-exit-事件" class="headerlink" title="下次再见：监听 exit 事件"></a>下次再见：监听 exit 事件</h2><p>在这篇教程的最后一节中，我们将让你简单地感受 Node 的事件机制。Node 的事件机制是比较复杂的，足够讲半本书，但这篇教程希望能通过一个非常简单的实例，让你对 Node 事件有个初步的了解。</p>
<div class="note info">
            <p><strong>提示</strong></p><p>如果你有过在网页（或其他用户界面）开发中编写事件处理（例如鼠标点击）的经验，那么你一定会觉得 Node 中处理事件的方式似曾相识而又符合直觉。</p>
          </div>

<p>我们在前面简单地提了一下回调函数。实际上，回调函数和事件机制共同组成了 Node 的异步世界。具体而言，Node 中的事件都是通过 <code>events</code> 核心模块中的 <code>EventEmitter</code> 这个类实现的。<code>EventEmitter</code> 包括两个最关键的方法：</p>
<ul>
<li><code>on</code>：用来监听事件的发生</li>
<li><code>emit</code>：用来触发新的事件</li>
</ul>
<p>请看下面这个代码片段：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> EventEmitter = <span class="built_in">require</span>(<span class="string">'events'</span>).EventEmitter;</span><br><span class="line"><span class="keyword">const</span> emitter = <span class="keyword">new</span> EventEmitter();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听 connect 事件，注册回调函数</span></span><br><span class="line">emitter.on(<span class="string">'connect'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">username</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(username + <span class="string">'已连接'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 触发 connect 事件，并且加上一个参数（即上面的 username）</span></span><br><span class="line">emitter.emit(<span class="string">'connect'</span>, <span class="string">'一只图雀'</span>);</span><br></pre></td></tr></table></figure>

<p>运行上面的代码，就会输出以下内容：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">一只图雀已连接</span><br></pre></td></tr></table></figure>

<p>可以说，Node 中很多对象都继承自 <code>EventEmitter</code>，包括我们熟悉的 <code>process</code> 全局对象。在之前的 timer.js 脚本中，我们监听 <code>exit</code> 事件（即 Node 进程结束），并添加一个自定义的回调函数打印“下次再见”的信息：</p>
<figure class="highlight js"><figcaption><span>timer.js</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL21SY2Zwcy9ub2RlanMtcXVpY2tzdGFydC9ibG9iLzUwYWI1YTQvdGltZXIuanM=" title="https://github.com/mRcfps/nodejs-quickstart/blob/50ab5a4/timer.js">查看完整代码<i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> program = <span class="built_in">require</span>(<span class="string">'commander'</span>);</span><br><span class="line"><span class="keyword">const</span> ora = <span class="built_in">require</span>(<span class="string">'ora'</span>);</span><br><span class="line"><span class="keyword">const</span> printProgramInfo = <span class="built_in">require</span>(<span class="string">'./info'</span>);</span><br><span class="line"><span class="keyword">const</span> datetime = <span class="built_in">require</span>(<span class="string">'./datetime'</span>);</span><br><span class="line"></span><br><span class="line">program</span><br><span class="line">  .option(<span class="string">'-t, --time &lt;number&gt;'</span>, <span class="string">'等待时间 (秒)'</span>, <span class="number">3</span>)</span><br><span class="line">  .option(<span class="string">'-m, --message &lt;string&gt;'</span>, <span class="string">'要输出的信息'</span>, <span class="string">'Hello World'</span>)</span><br><span class="line">  .parse(process.argv);</span><br><span class="line"></span><br><span class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  spinner.stop();</span><br><span class="line">  <span class="built_in">console</span>.log(program.message);</span><br><span class="line">&#125;, program.time * <span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">[tuture-add]process.on(<span class="string">'exit'</span>, () =&gt; &#123;</span><br><span class="line">[tuture-add]  <span class="built_in">console</span>.log(<span class="string">'下次再见~'</span>);</span><br><span class="line">[tuture-add]&#125;);</span><br><span class="line">[tuture-add] </span><br><span class="line">printProgramInfo();</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'当前时间'</span>, datetime.getCurrentTime());</span><br><span class="line"><span class="keyword">const</span> spinner = ora(<span class="string">'正在加载中，请稍后 ...'</span>).start();</span><br></pre></td></tr></table></figure>

<p>运行后，会在程序退出后打印“下次再见~”的字符串。你可能会问，为啥不能在 <code>setTimeout</code> 的回调函数中添加程序退出的逻辑呢？因为除了正常运行结束（也就是等待了指定的时间），我们的程序很有可能会因为其他原因退出（例如抛出异常，或者用 <code>process.exit</code> 强制退出），这时候通过监听 <code>exit</code> 事件，就可以在确保所有情况下都能执行 <code>exit</code> 事件的回调函数。如果你觉得还是不能理解的话，可以看下面这张示意图：</p>
<p><img alt data-src="https://static.powerformer.com/c/892fa12/exit.png"></p>
<div class="note info">
            <p><strong>提示</strong></p><p><code>process</code> 对象还支持其他常用的事件，例如 <code>SIGINT</code>（用户按 Ctrl+C 时触发）等等，可参考这篇<span class="exturl" data-url="aHR0cHM6Ly9qYXZhc2NyaXB0LnJ1YW55aWZlbmcuY29tL25vZGVqcy9wcm9jZXNzLmh0bWwjdG9jMTA=" title="https://javascript.ruanyifeng.com/nodejs/process.html#toc10">文档<i class="fa fa-external-link"></i></span>。</p>
          </div>

<p>这篇 Node.js 快速入门教程到这里就结束了，希望能够成为你进一步探索 Node.js 或是前端开发的基石。exit 事件已经触发，那我们也下次再见啦~</p>
<div class="note primary">
            <p><strong>主要</strong></p><p>此教程属于<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvbm9kZWpzLXJvYWRtYXA=" title="https://github.com/tuture-dev/nodejs-roadmap">Node.js 后端工程师学习路线<i class="fa fa-external-link"></i></span>的一部分，点击可查看全部内容。</p>
          </div>
    </div>

    
    
    
      

        <div id="qrcode_subscriber-container">
  <div></div>

  <div id="qrocde-qr">
        
      
      <div style="display: inline-block">
        <img src="/uploads/wechat-qcode.png" alt="图雀社区 微信公众号">
        <p>扫一扫关注上方公众号，拉学习群和答疑解惑</p>
      </div>

  </div>
</div>

      
        
      
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>图雀社区</li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://tuture.co/2019/12/03/892fa12/" title="一杯茶的时间，上手 Node.js">https://tuture.co/2019/12/03/892fa12/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC8="><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li>
</ul>
</div>

      

      <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-next post-nav-item">
              
                <a href="/2019/11/28/1fe175a/" rel="next" title="Redux 包教包会（一）：解救 React 状态危机">
                  <i class="fa fa-chevron-left"></i> Redux 包教包会（一）：解救 React 状态危机
                </a>
              
            </div>

            <span class="post-nav-divider"></span>

            <div class="post-nav-prev post-nav-item">
              
                <a href="/2019/12/18/5e10a46/" rel="prev" title="从零到部署：用 Vue 和 Express 实现迷你全栈电商应用（三）">
                  从零到部署：用 Vue 和 Express 实现迷你全栈电商应用（三） <i class="fa fa-chevron-right"></i>
                </a>
              
            </div>
          </div>
        
      </footer>
    
  </div>
  
  
  
  </article>

  </div>


          </div>
          
    
    <div class="comments" id="gitalk-container"></div>
  

        </div>
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">
      <div>
          
          
          
          
        

        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc">
            文章目录
          </li>
          <li class="sidebar-nav-overview">
            站点概览
          </li>
        </ul>

        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#起步"><span class="nav-number">1.</span> <span class="nav-text">起步</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#什么是-Node？"><span class="nav-number">1.1.</span> <span class="nav-text">什么是 Node？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#预备知识"><span class="nav-number">1.2.</span> <span class="nav-text">预备知识</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#学习目标"><span class="nav-number">1.3.</span> <span class="nav-text">学习目标</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#运行-Node-代码"><span class="nav-number">1.4.</span> <span class="nav-text">运行 Node 代码</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#使用-REPL-快速体验"><span class="nav-number">1.4.1.</span> <span class="nav-text">使用 REPL 快速体验</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#编写-Node-脚本"><span class="nav-number">1.4.2.</span> <span class="nav-text">编写 Node 脚本</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Node-全局对象初探"><span class="nav-number">2.</span> <span class="nav-text">Node 全局对象初探</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#JavaScript-全局对象的分类"><span class="nav-number">2.1.</span> <span class="nav-text">JavaScript 全局对象的分类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Node-专属全局对象解析"><span class="nav-number">2.2.</span> <span class="nav-text">Node 专属全局对象解析</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#process"><span class="nav-number">2.2.1.</span> <span class="nav-text">process</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Buffer"><span class="nav-number">2.2.2.</span> <span class="nav-text">Buffer</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#filename-和-dirname"><span class="nav-number">2.2.3.</span> <span class="nav-text">__filename 和 __dirname</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用-Node-全局对象"><span class="nav-number">2.3.</span> <span class="nav-text">使用 Node 全局对象</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#理解-Node-模块机制"><span class="nav-number">3.</span> <span class="nav-text">理解 Node 模块机制</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#JavaScript-的模块化之路"><span class="nav-number">3.1.</span> <span class="nav-text">JavaScript 的模块化之路</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#什么是-Node-模块"><span class="nav-number">3.2.</span> <span class="nav-text">什么是 Node 模块</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Node-模块机制浅析"><span class="nav-number">3.3.</span> <span class="nav-text">Node 模块机制浅析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#重构-timer-脚本"><span class="nav-number">3.4.</span> <span class="nav-text">重构 timer 脚本</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#命令行开发：接受输入参数"><span class="nav-number">4.</span> <span class="nav-text">命令行开发：接受输入参数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#通过-process-argv-读取命令行参数"><span class="nav-number">4.1.</span> <span class="nav-text">通过 process.argv 读取命令行参数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#实现命令行应用"><span class="nav-number">4.2.</span> <span class="nav-text">实现命令行应用</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#npm：洪荒之力，都赐予你"><span class="nav-number">5.</span> <span class="nav-text">npm：洪荒之力，都赐予你</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#npm-初探"><span class="nav-number">5.1.</span> <span class="nav-text">npm 初探</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#安装-npm-包"><span class="nav-number">5.2.</span> <span class="nav-text">安装 npm 包</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#关于版本号"><span class="nav-number">5.3.</span> <span class="nav-text">关于版本号</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#站在巨人的肩膀上"><span class="nav-number">5.4.</span> <span class="nav-text">站在巨人的肩膀上</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#尝鲜-npm-scripts"><span class="nav-number">6.</span> <span class="nav-text">尝鲜 npm scripts</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#下次再见：监听-exit-事件"><span class="nav-number">7.</span> <span class="nav-text">下次再见：监听 exit 事件</span></a></li></ol></div>
          
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" src="/images/avatar.png" alt="图雀社区">
  <p class="site-author-name" itemprop="name">图雀社区</p>
  <div class="site-description" itemprop="description">由 <a href="https://github.com/tuture-dev/tuture" target="_blank" rel="external nofollow noopener noreferrer">Tuture</a> 工具写成，这里汇集了能够让你从头敲到尾并做出可运行项目的精彩的免费技术教程</div>
</div>
  <div class="feed-link motion-element">
    <a href="/atom.xml" rel="alternate">
      <i class="fa fa-rss"></i>RSS
    </a>
  </div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <span class="exturl" data-url="aHR0cHM6Ly9qdWVqaW4uaW0vdXNlci81YjMzNDE0MzUxODgyNTc0Yjk2OTRkMjg="><i class="fa fa-fw fa-custom juejin"></i>掘金</span>
      </span>
    
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <a href="/images/social/wechat.png"><i class="fa fa-fw fa-custom wechat"></i>微信</a>
      </span>
    
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <span class="exturl" data-url="aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vdHV0dXJl"><i class="fa fa-fw fa-custom zhihu"></i>知乎</span>
      </span>
    
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXY="><i class="fa fa-fw fa-github"></i>GitHub</span>
      </span>
    
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright"><span class="exturl" data-url="aHR0cDovL3d3dy5iZWlhbi5taWl0Lmdvdi5jbg==">沪ICP备19039313号 </span><span><img src="/images/gongan-url.png" style="display:inline-block;">
  
  <span class="exturl" data-url="aHR0cDovL3d3dy5iZWlhbi5nb3YuY24vcG9ydGFsL3JlZ2lzdGVyU3lzdGVtSW5mbz9yZWNvcmRjb2RlPTMxMDExNzAyMDA3MTMw">沪公网安备 31011702007130号 </span>&copy; <span itemprop="copyrightYear">2021</span>
  <span class="with-love" id="animate">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">图雀社区</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    <span title="站点总字数">891k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">13:30</span>
</span></div>
  <div class="powered-by">由 <span class="exturl theme-link" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> 强力驱动 v4.2.1</div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <span class="exturl theme-link" data-url="aHR0cHM6Ly90aGVtZS1uZXh0Lm9yZw==">NexT.Pisces</span> v7.4.0</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
</div>












        
      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js?v=3.1.0"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js"></script>

<script src="/js/utils.js?v=7.4.0.js"></script>


<script src="/js/schemes/pisces.js?v=7.4.0.js"></script>


<script src="/js/next-boot.js?v=7.4.0.js"></script>

<script src="/js/bookmark.js?v=7.4.0.js"></script>




  
  <script>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      bp.src = (curProtocol === 'https') ? 'https://zz.bdstatic.com/linksubmit/push.js' : 'http://push.zhanzhang.baidu.com/push.js';
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>








  
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/instantsearch.js@2/dist/instantsearch.min.css">
<script src="//cdn.jsdelivr.net/npm/instantsearch.js@2/dist/instantsearch.min.js"></script>
<script src="/js/algolia-search.js?v=7.4.0.js"></script>
















  

  

  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID: '6310753ce4e95163d2b0',
      clientSecret: '4fd6839b697f9d50e01eebbb9566d8bdf3bd75b4',
      repo: 'comments',
      owner: 'tuture-dev',
      admin: 'pftom,mRcfps,tuture-dev'.split(','),
      id: '3be15b04b9f5680e7cb2f7b59f55832a',
        language: 'zh-CN',
      
      distractionFreeMode: 'true'
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
</script>


  <script>
    const line = document.getElementsByClassName('line');
    const arrLine = Array.from(line);

    const delRegex = /\[.*tuture.*-.*del.*?\]/;
    const addRegex = /\[.*tuture.*-.*add.*?\]/;
    const omitRegex = /\[.*tuture.*-.*omit.*?\]/;

    const delSpaceRegex = /^\s*\[.*tuture.*-.*del.*?\]\s*$/;
    const addSpaceRegex = /^\s*\[.*tuture.*-.*add.*?\]\s*$/;
    const omitSpaceRegex = /^\s*\[.*tuture.*-.*omit.*?\]\s*$/;

    arrLine.map(item => {
      if (item.innerText.startsWith('[tuture-add]')) {
        if (addSpaceRegex.test(item.innerText)) {
          item.innerHTML = item.innerHTML.replace(addRegex, ' ');
        } else {
          item.innerHTML = item.innerHTML.replace(addRegex, '');
        }

          item.className = item.className + ' tuture-add';
      } else if (item.innerText.startsWith('[tuture-del]')) {
          if (delSpaceRegex.test(item.innerText)) {
            item.innerHTML = item.innerHTML.replace(delRegex, ' ');
          } else {
            item.innerHTML = item.innerHTML.replace(delRegex, '');
          }

          item.className = item.className + ' tuture-del';
      } else if (item.innerText.startsWith('[tuture-omit]')) {
        item.innerHTML = item.innerHTML.replace(omitRegex, '...');
        item.className = item.className + ' tuture-omit';
      }
    })
  </script>
</body>
</html>
