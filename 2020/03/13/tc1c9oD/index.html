<!DOCTYPE html>





<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <meta name="keywords" content="图雀社区,Tuture,Vue.js实战教程,微信小程序,Kotlin,React Native,Webpack,MVVM,React.js,Node.js,Redux,Django,MongoDB,Docker,JavaScript,Java,Go,Kubernetes,Nuxt,vue-router,react-router,小程序,跨端开发,Taro,react hooks,redux-saga,learn by doing,Web 前端实战教程,后端实战教程,小程序实战教程,移动端实战教程">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png?v=7.4.0">
  <link rel="mask-icon" href="/images/logo.svg?v=7.4.0" color="#222">
  <link rel="manifest" href="/images/manifest.json">
  <meta name="msapplication-config" content="/images/browserconfig.xml">
  <link rel="alternate" href="/atom.xml" title="图雀社区" type="application/atom+xml">
  <meta name="google-site-verification" content="uDCHIeBD5phhUIjsHM8GYeoNBYWJuQIJBjgchamUcAI">
  <meta name="yandex-verification" content="90341ba6c811f41d">

<link rel="stylesheet" href="/css/main.css?v=7.4.0">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '7.4.0',
    exturl: true,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":true,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":true},
    bookmark: {"enable":true,"color":"#222","save":"auto"},
    fancybox: true,
    mediumzoom: false,
    lazyload: true,
    pangu: true,
    algolia: {
      appID: '73BSUE4RKU',
      apiKey: '0b7cce26a4734cb760080065b3c4a4a1',
      indexName: 'Tuture',
      hits: {"per_page":10},
      labels: {"input_placeholder":"搜索教程","hits_empty":"我们找不到你搜索的教程: ${query}","hits_stats":"在 ${time} ms 内找到 ${hits} 条结果"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: '复制',
      copy_success: '复制成功',
      copy_failure: '复制失败'
    },
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="在之前的六篇教程中我们已经基本实现了迷你全栈电商应用，相信大家对于一个全栈应用的开发已经有了一个全面的认知。但是一个追求完美的工程师是不会吝啬他的艺术创造，仅仅实现应用的功能还不能满足用户的高需求，应用的界面效果也是提高用户体验的关键因素。因此本篇教程将基于element-ui组件库重构项目的前端代码，改善迷你电商应用的界面效果，提高用户的体验感。虽然我们可以轻松地引入现成的组件库，但是与之对应的">
<meta property="og:type" content="article">
<meta property="og:title" content="从零到部署：用 Vue 和 Express 实现迷你全栈电商应用（七）">
<meta property="og:url" content="https://tuture.co/2020/03/13/tc1c9oD/index.html">
<meta property="og:site_name" content="图雀社区">
<meta property="og:description" content="在之前的六篇教程中我们已经基本实现了迷你全栈电商应用，相信大家对于一个全栈应用的开发已经有了一个全面的认知。但是一个追求完美的工程师是不会吝啬他的艺术创造，仅仅实现应用的功能还不能满足用户的高需求，应用的界面效果也是提高用户体验的关键因素。因此本篇教程将基于element-ui组件库重构项目的前端代码，改善迷你电商应用的界面效果，提高用户的体验感。虽然我们可以轻松地引入现成的组件库，但是与之对应的">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://static.powerformer.com/c/092faf4/vue-cover-7-squashed.jpg">
<meta property="article:published_time" content="2020-03-12T18:00:37.658Z">
<meta property="article:modified_time" content="2021-08-08T15:06:53.176Z">
<meta property="article:author" content="图雀社区">
<meta property="article:tag" content="Vue">
<meta property="article:tag" content="Element UI">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://static.powerformer.com/c/092faf4/vue-cover-7-squashed.jpg">
  <link rel="canonical" href="https://tuture.co/2020/03/13/tc1c9oD/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>从零到部署：用 Vue 和 Express 实现迷你全栈电商应用（七） | 图雀社区</title>
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-124499211-1"></script>
  <script>
    var host = window.location.hostname;
    if (host !== "localhost" || !true) {
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-124499211-1');
    }
  </script>








  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

  <style>
    span.line.tuture-add {
      font-weight: bold;
    }

    span.line.tuture-del {
      opacity: 0.3;
    }

    .profileBox {
      display: flex;
      flex-direction: row;
      justify-content: center;
      align-items: center;
      flex-wrap: wrap;
    }

    .profileBox i {
      display: none;
    }

    .profileBox p {
      margin: 0;
      padding: 0;
    }

    .avatarBox {
      min-width: 60px;
    }

    .avatarBox .avatar {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      margin: 0;
    }

    .avatarBox .avatar:hover {
      cursor: pointer;
    }

    .avatarBox {
      margin-right: 20px;
    }

    .rightBox {
      display:flex;
      flex-direction: row;
      justify-content: flex-start;
      align-items: center;
    }

    .infoBox {
      min-width: 100px;
    }

    .infoBox p {
      padding: 0;
      margin: 0;
    }

    .infoBox .nickName {
      font-weight: bold;
      font-size: 20px;
      color: #979797;
      text-decoration: none;
    }

    .infoBox .nickName:hover {
      cursor: pointer;
    }

    .infoBox .motto {
      font-size: 16px;
      color: #979797;
    }

    .codeBox {
      margin-left: 49px;
      min-width: 100px;
    }

    .codeBox a {
      text-decoration: none;
    }

    .codeBox .exturl {
      border: none;
    }

    .codeBox span.codeText {
      display: inline-block;
      width: 100px;
      height: 40px;
      border-radius: 4px;
      border: 1px solid #979797;
      color: #979797;
      text-align: center;
      line-height: 40px;
      text-decoration: none;;
      transition: all 0.2s ease-in-out;
    }

    .codeBox .codeText:hover {
      cursor: pointer;
      background-color: #979797;
      color: #ffffff;
    }

    @media screen and (max-width:652px) {
      .profileBox {
        align-items: center;
        flex-direction: column;
      }

      .infoBox {
        margin-bottom: 20px;
      }

      .infoBox .nickName {
        text-align: center;
      }

      .rightBox {
        flex-direction: column;
        align-items: flex-start;
      }

      .codeBox {
        margin-left: 0;
      }

      .avatarBox {
        margin-right: 0;
      }
    }

    @media screen and (max-width:500px) {
      .rightBox {
        align-items: center;
      }

      .infoBox {
        margin-bottom: 20px;
      }

      .infoBox .nickName {
        text-align: center;
      }

      .infoBox .motto {
        text-align: center;
      }
    }

    .vsys {
      display:none !important;
      }

      figcaption .exturl {
        float: right;
      }
  </style>
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.15.10/build/styles/default.min.css">
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">
  <div class="container">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">图雀社区</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <h1 class="site-subtitle" itemprop="description">汇集精彩的实战技术教程</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
      
      
      
        
        <li class="menu-item menu-item-home">
      
    
      
      
        
      
        
      
        
      
        
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-tags">
      
    
      
      
        
      
        
      
        
          
        
      
        
      
    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签<span class="badge">45</span></a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-categories">
      
    
      
      
        
      
        
          
        
      
        
      
        
      
    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类<span class="badge">22</span></a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-archives">
      
    
      
      
        
          
        
      
        
      
        
      
        
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档<span class="badge">58</span></a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-早报">
      
    
      
      
        
      
        
      
        
      
        
      
    

    <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvZGFpbHk="><i class="menu-item-icon fa fa-fw fa-calendar"></i> <br>早报</span>

  </li>
      
      
      
        
        <li class="menu-item menu-item-about">
      
    
      
      
        
      
        
      
        
      
        
      
    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>关于</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-文档">
      
    
      
      
        
      
        
      
        
      
        
      
    

    <span class="exturl" data-url="aHR0cHM6Ly93d3cueXVxdWUuY29tL3R1dHVyZS9wcm9kdWN0LW1hbnVhbHM="><i class="menu-item-icon fa fa-fw fa-book"></i> <br>文档</span>

  </li>
      
      
      
        
        <li class="menu-item menu-item-faq">
      
    
      
      
        
      
        
      
        
      
        
      
    

    <a href="/FAQ" rel="section"><i class="menu-item-icon fa fa-fw fa-question"></i> <br>FAQ</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger">
        
          <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
      </li>
    
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input" id="search-input"></div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="algolia-results">
  <div id="algolia-stats"></div>
  <div id="algolia-hits"></div>
  <div id="algolia-pagination" class="algolia-pagination"></div>
</div>

  
</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <span class="exturl github-corner" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZXByb2plY3QvaHVi" title="Follow me on GitHub" aria-label="Follow me on GitHub"><svg width="80" height="80" viewbox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></span>


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
            

          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
      <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block post">
    <link itemprop="mainEntityOfPage" href="https://tuture.co/2020/03/13/tc1c9oD/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="图雀社区">
      <meta itemprop="description" content="图雀社区是一个供大家分享用 Tuture 写作工具完成的教程的一个平台。在这里，读者们可以尽情享受高质量且免费的实战教程，并能与作者和其他读者互动和讨论；而作者们也可以借此传播他们的技术知识，宣传他们的开源项目，找到自己输出内容的受众，加速技术的传播。">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="图雀社区">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">从零到部署：用 Vue 和 Express 实现迷你全栈电商应用（七）

          
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2020-03-13 02:00:37" itemprop="dateCreated datePublished" datetime="2020-03-13T02:00:37+08:00">2020-03-13</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-08-08 23:06:53" itemprop="dateModified" datetime="2021-08-08T23:06:53+08:00">2021-08-08</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E5%89%8D%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">前端</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E5%89%8D%E7%AB%AF/Vue/" itemprop="url" rel="index"><span itemprop="name">Vue</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E5%89%8D%E7%AB%AF/Vue/%E5%85%A5%E9%97%A8/" itemprop="url" rel="index"><span itemprop="name">入门</span></a></span>

                
                
              
            </span>
          

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
          
          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
              
                <span class="post-meta-item-text">本文字数：</span>
              
              <span>42k</span>
            </span>
          
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
              
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              
              <span>38 分钟</span>
            </span>
          
            <div class="post-description">在之前的六篇教程中我们已经基本实现了迷你全栈电商应用，相信大家对于一个全栈应用的开发已经有了一个全面的认知。但是一个追求完美的工程师是不会吝啬他的艺术创造，仅仅实现应用的功能还不能满足用户的高需求，应用的界面效果也是提高用户体验的关键因素。因此本篇教程将基于element-ui组件库重构项目的前端代码，改善迷你电商应用的界面效果，提高用户的体验感。虽然我们可以轻松地引入现成的组件库，但是与之对应的数据处理也值得我们注意，那我会在引入组件库的同时带大家一起踩一踩element-ui给我们挖的坑，毕竟踩坑才能成长嘛。</div>
          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <div class="post-gallery" itemscope itemtype="http://schema.org/ImageGallery">
            <div class="post-gallery-row">
              <img src="https://static.powerformer.com/c/092faf4/vue-cover-7-squashed.jpg" itemprop="contentUrl">
            
          

          </div>
        </div>
        <div class="profileBox">
  <div class="avatarBox">
    <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXY=" title="https://github.com/tuture-dev"><img alt class="avatar" data-src="/images/avatars/tuture-dev.jpg"><i class="fa fa-external-link"></i></span>
  </div>
  <div class="rightBox">
    <div class="infoBox">
    <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXY=" title="https://github.com/tuture-dev"><p class="nickName">@tuture-dev</p><i class="fa fa-external-link"></i></span>
  </div>
  <div class="codeBox">
    <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvdnVlLW9ubGluZS1zaG9wLWZyb250ZW5k" title="https://github.com/tuture-dev/vue-online-shop-frontend"><span class="codeText">查看代码</span><i class="fa fa-external-link"></i></span>
  </div>
  </div>
</div><a id="more"></a>

<h2 id="代码重构"><a href="#代码重构" class="headerlink" title="代码重构"></a>代码重构</h2><p>这一部分我们主要利用<code>element-ui</code>组件库重构之前的项目代码，实现极具美感的迷你电商应用。</p>
<p>这里我们简单介绍一下<code>element-ui</code>组件库(如果您了解，您可以跳过这部分)：</p>
<blockquote>
<p>Element UI 是一套采用 Vue 2.0 作为基础框架实现的组件库，一套为开发者、设计师和产品经理准备的基于 Vue 2.0的组件库，提供了配套设计资源，帮助网站快速成型。</p>
</blockquote>
<p>Element UI文档提供了很多实例代码，一般情况下我们直接拷下示例代码稍微看看改改数据之类的就OK了。但是在某些场景下，我们可能又需要使用到一些特殊的功能和属性，而这些功能属性一般在官方提供的组件中都已经内置了，所以我们可以直接先从文档中寻找查看是否有属性或者方法等能够满足我们的需求，从而避免重复造轮子。</p>
<h3 id="安装element-ui依赖"><a href="#安装element-ui依赖" class="headerlink" title="安装element-ui依赖"></a>安装element-ui依赖</h3><ul>
<li>npm 安装推荐使用 npm 的方式安装，它能更好地和 webpack 打包工具配合使用。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm i element-ui -S</span><br></pre></td></tr></table></figure>

<ul>
<li>CDN引入目前可以通过 <span class="exturl" data-url="aHR0cHM6Ly91bnBrZy5jb20vYnJvd3NlL2VsZW1lbnQtdWlAMi4xMy4wLw==" title="https://unpkg.com/browse/element-ui@2.13.0/">unpkg.com/element-ui<i class="fa fa-external-link"></i></span> 获取到最新版本的资源，在页面上引入 js 和 css 文件即可开始使用。</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 引入样式 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"https://unpkg.com/element-ui/lib/theme-chalk/index.css"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 引入组件库 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://unpkg.com/element-ui/lib/index.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>我们建议使用 CDN 引入 Element 的用户在链接地址上锁定版本，以免将来 Element升级时受到非兼容性更新的影响。锁定版本的方法请查看 <span class="exturl" data-url="aHR0cHM6Ly91bnBrZy5jb20v" title="https://unpkg.com/">unpkg.com<i class="fa fa-external-link"></i></span>。</p>
</blockquote>
<h3 id="导入依赖"><a href="#导入依赖" class="headerlink" title="导入依赖"></a>导入依赖</h3><p>依赖安装完成之后，我们需要在项目的<code>main.js</code>文件中导入并注册依赖。</p>
<blockquote>
<p>你可以引入整个 Element，或是根据需要仅引入部分组件，这里我们引入了完整的 Element。</p>
</blockquote>
<figure class="highlight js"><figcaption><span>src/main.js</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvdnVlLW9ubGluZS1zaG9wLWZyb250ZW5kL2Jsb2IvYjZkOWE4N2YxYWY4ZjJhMDY4Y2ZiNWEyZDM5MmZkMWRiYWVjODRjMy9zcmMvbWFpbi5qcw==" title="https://github.com/tuture-dev/vue-online-shop-frontend/blob/b6d9a87f1af8f2a068cfb5a2d392fd1dbaec84c3/src/main.js">查看完整代码<i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./App'</span>;</span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">'./router'</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">'./store'</span>;</span><br><span class="line">[tuture-add]<span class="keyword">import</span> ElementUI <span class="keyword">from</span> <span class="string">'element-ui'</span></span><br><span class="line">[tuture-add]<span class="keyword">import</span> <span class="string">'element-ui/lib/theme-chalk/index.css'</span></span><br><span class="line"></span><br><span class="line">Vue.config.productionTip = <span class="literal">false</span>;</span><br><span class="line">Vue.component(<span class="string">'ValidationProvider'</span>, ValidationProvider);</span><br><span class="line">[tuture-add]Vue.use(ElementUI);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></table></figure>

<p>在<code>main.js</code>文件中我们首先导入了<code>element-ui</code>组件库，需要注意的是我们要单独引入样式文件；除此之外还要使用<code>Vue.use()</code>注册组件库。</p>
<p>至此，一个基于 Vue 和 Element 的开发环境已经搭建完毕，现在就可以愉快地使用组件库进行代码重构了。</p>
<h3 id="重构导航栏"><a href="#重构导航栏" class="headerlink" title="重构导航栏"></a>重构导航栏</h3><p>我们首先来到<code>App</code>组件，这里之前是采用普通的<code>nav</code>标签展示首页导航，显得甚是简陋，现在我们可以使用<code>element-ui</code>组件库提供的<code>el-menu</code>导航菜单组件重构导航栏，绝对酷炫。</p>
<figure class="highlight html"><figcaption><span>src/App.vue</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvdnVlLW9ubGluZS1zaG9wLWZyb250ZW5kL2Jsb2IvYjZkOWE4N2YxYWY4ZjJhMDY4Y2ZiNWEyZDM5MmZkMWRiYWVjODRjMy9zcmMvQXBwLnZ1ZQ==" title="https://github.com/tuture-dev/vue-online-shop-frontend/blob/b6d9a87f1af8f2a068cfb5a2d392fd1dbaec84c3/src/App.vue">查看完整代码<i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">[tuture-del]    <span class="tag">&lt;<span class="name">nav</span>&gt;</span></span><br><span class="line">[tuture-del]      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">[tuture-del]        <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"nav__left"</span>&gt;</span></span><br><span class="line">[tuture-del]          <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">[tuture-del]            <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/"</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">[tuture-del]          <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">[tuture-del]          <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">[tuture-del]            <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/admin"</span>&gt;</span>Admin<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">[tuture-del]          <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">[tuture-del]          <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">[tuture-del]            <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/cart"</span>&gt;</span>Cart<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">[tuture-del]          <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">[tuture-del]        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">[tuture-del]      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">[tuture-del]    <span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span><br><span class="line">[tuture-del] </span><br><span class="line">[tuture-add]    <span class="tag">&lt;<span class="name">el-menu</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]      <span class="attr">class</span>=<span class="string">"menu"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]      <span class="attr">:default-active</span>=<span class="string">"activeIndex2"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]      <span class="attr">mode</span>=<span class="string">"horizontal"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]      @<span class="attr">select</span>=<span class="string">"handleSelect"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]      <span class="attr">background-color</span>=<span class="string">"#545c64"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]      <span class="attr">text-color</span>=<span class="string">"#fff"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]      <span class="attr">active-text-color</span>=<span class="string">"#ffd04b"</span>&gt;</span></span><br><span class="line">[tuture-add]      <span class="tag">&lt;<span class="name">el-menu-item</span> <span class="attr">index</span>=<span class="string">"1"</span>&gt;</span><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/"</span> <span class="attr">tag</span>=<span class="string">"div"</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span><span class="tag">&lt;/<span class="name">el-menu-item</span>&gt;</span></span><br><span class="line">[tuture-add]      <span class="tag">&lt;<span class="name">el-submenu</span> <span class="attr">index</span>=<span class="string">"2"</span>&gt;</span></span><br><span class="line">[tuture-add]        <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot</span>=<span class="string">"title"</span>&gt;</span>Admin<span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">[tuture-add]        <span class="tag">&lt;<span class="name">el-menu-item</span> <span class="attr">index</span>=<span class="string">"2-1"</span>&gt;</span><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/admin"</span> <span class="attr">tag</span>=<span class="string">"div"</span>&gt;</span>查看商品<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span><span class="tag">&lt;/<span class="name">el-menu-item</span>&gt;</span></span><br><span class="line">[tuture-add]        <span class="tag">&lt;<span class="name">el-menu-item</span> <span class="attr">index</span>=<span class="string">"2-2"</span>&gt;</span><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/admin/new"</span> <span class="attr">tag</span>=<span class="string">"div"</span>&gt;</span>添加商品<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span><span class="tag">&lt;/<span class="name">el-menu-item</span>&gt;</span></span><br><span class="line">[tuture-add]        <span class="tag">&lt;<span class="name">el-menu-item</span> <span class="attr">index</span>=<span class="string">"2-3"</span>&gt;</span><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/admin/manufacturers"</span> <span class="attr">tag</span>=<span class="string">"div"</span>&gt;</span>查看生产商<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span><span class="tag">&lt;/<span class="name">el-menu-item</span>&gt;</span></span><br><span class="line">[tuture-add]        <span class="tag">&lt;<span class="name">el-menu-item</span> <span class="attr">index</span>=<span class="string">"2-4"</span>&gt;</span><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/admin/manufacturers/new"</span> <span class="attr">tag</span>=<span class="string">"div"</span>&gt;</span>添加生产商<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span><span class="tag">&lt;/<span class="name">el-menu-item</span>&gt;</span></span><br><span class="line">[tuture-add]      <span class="tag">&lt;/<span class="name">el-submenu</span>&gt;</span>  </span><br><span class="line">[tuture-add]      <span class="tag">&lt;<span class="name">el-menu-item</span> <span class="attr">index</span>=<span class="string">"3"</span>&gt;</span><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/cart"</span> <span class="attr">tag</span>=<span class="string">"div"</span>&gt;</span>Cart<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span><span class="tag">&lt;/<span class="name">el-menu-item</span>&gt;</span></span><br><span class="line">[tuture-add]    <span class="tag">&lt;/<span class="name">el-menu</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-view</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"> // ...</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="actionscript">  name: <span class="string">'App'</span>,</span></span><br><span class="line">[tuture-add]  data() &#123;</span><br><span class="line"><span class="actionscript">[tuture-add]    <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="actionscript">[tuture-add]      activeIndex: <span class="string">'1'</span>,</span></span><br><span class="line"><span class="actionscript">[tuture-add]      activeIndex2: <span class="string">'1'</span></span></span><br><span class="line">[tuture-add]    &#125;;</span><br><span class="line">[tuture-add]  &#125;,</span><br><span class="line">[tuture-add]  methods: &#123;</span><br><span class="line">[tuture-add]    handleSelect(key, keyPath) &#123;</span><br><span class="line"><span class="javascript">[tuture-add]        <span class="built_in">console</span>.log(key, keyPath);</span></span><br><span class="line">[tuture-add]    &#125;</span><br><span class="line">[tuture-add]  &#125;</span><br><span class="line">[tuture-add] </span><br><span class="line">&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css"><span class="selector-id">#app</span> &#123;</span></span><br><span class="line">  font-family: 'Avenir', Helvetica, Arial, sans-serif;</span><br><span class="line">  -webkit-font-smoothing: antialiased;</span><br><span class="line">  -moz-osx-font-smoothing: grayscale;</span><br><span class="line">  text-align: center;</span><br><span class="line"><span class="css">  <span class="selector-tag">color</span>: <span class="selector-id">#2c3e50</span>;</span></span><br><span class="line">  margin-top: 60px;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span><span class="selector-class">.el-submenu__title</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span>  <span class="selector-tag">margin-left</span>: 40<span class="selector-tag">px</span>;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span>&#125;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这里导航栏组件的使用相信大家都能看懂，这里我们只讲一下比较特殊的地方。我们不需要在意 <code>data</code> 属性以及 <code>handleSelect</code>方法，我们暂时用不到。这里一个特殊的地方就是 <code>el-menu-item</code>标签中的 <code>tag</code> 属性，我们将其值设置为 “div” 表示将该标签渲染为 “div” 盒子，如果不设置该属性则该标签默认渲染为 “a” 标签，导致标签包裹的内容带有下划线，因此这里 <code>tag</code> 属性的设置是为了去除下划线。</p>
<h3 id="重构商品列表"><a href="#重构商品列表" class="headerlink" title="重构商品列表"></a>重构商品列表</h3><p>重新修改 <code>ProductList</code> 组件，由于该组件中的子组件 <code>ProductItem</code> 进行了重构，因此这里也需要做一定的修改，看到后面 <code>ProductItem</code> 组件的重构您就会明白我们这里修改的用意。</p>
<figure class="highlight html"><figcaption><span>src/components/products/ProductList.vue</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvdnVlLW9ubGluZS1zaG9wLWZyb250ZW5kL2Jsb2IvYjZkOWE4N2YxYWY4ZjJhMDY4Y2ZiNWEyZDM5MmZkMWRiYWVjODRjMy9zcmMvY29tcG9uZW50cy9wcm9kdWN0cy9Qcm9kdWN0TGlzdC52dWU=" title="https://github.com/tuture-dev/vue-online-shop-frontend/blob/b6d9a87f1af8f2a068cfb5a2d392fd1dbaec84c3/src/components/products/ProductList.vue">查看完整代码<i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"products"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">        This is ProductList</span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">[tuture-del]      <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-for</span>=<span class="string">"product in products"</span>&gt;</span></span><br><span class="line">[tuture-del]        <span class="tag">&lt;<span class="name">product-item</span> <span class="attr">:product</span>=<span class="string">"product"</span> <span class="attr">:key</span>=<span class="string">"product._id"</span>&gt;</span><span class="tag">&lt;/<span class="name">product-item</span>&gt;</span></span><br><span class="line">[tuture-del]      <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">[tuture-add]      <span class="comment">&lt;!-- &lt;template v-for="product in products"&gt; --&gt;</span></span><br><span class="line">[tuture-add]        <span class="tag">&lt;<span class="name">product-item</span> <span class="attr">:products</span>=<span class="string">"products"</span>&gt;</span><span class="tag">&lt;/<span class="name">product-item</span>&gt;</span></span><br><span class="line">[tuture-add]      <span class="comment">&lt;!-- &lt;/template&gt; --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"> // ...</span><br></pre></td></tr></table></figure>

<p>这里之前是将从本地获取的 <code>products</code> 数组利用 <code>v-for</code> 将 <code>product</code> 对象遍历到每个 <code>ProductItem</code> 组件中分别进行展示，但是我们这里取消了 <code>v-for</code> 遍历 <code>products</code> 数组，选择直接将 <code>products</code> 数组传入 <code>ProductItem</code> 组件中。请允许我先在这里卖个关子，继续往下看。</p>
<p>重新进入 <code>ProductItem</code> 组件进行修改，这里我们使用了 <code>element-ui</code> 组件库提供的 <code>el-table</code> 表格组件取代了原始标签来展示商品信息列表。</p>
<figure class="highlight html"><figcaption><span>src/components/products/ProductItem.vue</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvdnVlLW9ubGluZS1zaG9wLWZyb250ZW5kL2Jsb2IvYjZkOWE4N2YxYWY4ZjJhMDY4Y2ZiNWEyZDM5MmZkMWRiYWVjODRjMy9zcmMvY29tcG9uZW50cy9wcm9kdWN0cy9Qcm9kdWN0SXRlbS52dWU=" title="https://github.com/tuture-dev/vue-online-shop-frontend/blob/b6d9a87f1af8f2a068cfb5a2d392fd1dbaec84c3/src/components/products/ProductItem.vue">查看完整代码<i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">[tuture-del]  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">[tuture-del]    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"product"</span>&gt;</span></span><br><span class="line">[tuture-del]      <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">:to</span>=<span class="string">"'/detail/' + product._id"</span> <span class="attr">class</span>=<span class="string">"product-link"</span>&gt;</span></span><br><span class="line">[tuture-del]        <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"product__name"</span>&gt;</span>产品名称：&#123;&#123;product.name&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">[tuture-del]        <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"product__description"</span>&gt;</span>介绍：&#123;&#123;product.description&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">[tuture-del]        <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"product__price"</span>&gt;</span>价格：&#123;&#123;product.price&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">[tuture-del]        <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"product.manufacturer"</span>&gt;</span>生产厂商：&#123;&#123;product.manufacturer.name&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">[tuture-del]        <span class="tag">&lt;<span class="name">img</span> <span class="attr">:src</span>=<span class="string">"product.image"</span> <span class="attr">alt</span>=<span class="string">""</span> <span class="attr">class</span>=<span class="string">"product__image"</span>&gt;</span></span><br><span class="line">[tuture-del]      <span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">[tuture-del]      <span class="tag">&lt;<span class="name">product-button</span> <span class="attr">:product</span>=<span class="string">"product"</span>&gt;</span><span class="tag">&lt;/<span class="name">product-button</span>&gt;</span></span><br><span class="line">[tuture-del]    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">[tuture-add]  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"products"</span>&gt;</span></span><br><span class="line">[tuture-add]    <span class="tag">&lt;<span class="name">el-table</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]    <span class="attr">class</span>=<span class="string">"table"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]    <span class="attr">:data</span>=<span class="string">"products"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]    <span class="attr">max-height</span>=<span class="string">"250"</span>&gt;</span></span><br><span class="line">[tuture-add]      <span class="tag">&lt;<span class="name">el-table-column</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]        <span class="attr">prop</span>=<span class="string">"name"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]        <span class="attr">label</span>=<span class="string">"产品名称"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]        <span class="attr">width</span>=<span class="string">"180"</span>&gt;</span></span><br><span class="line">[tuture-add]      <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">[tuture-add]      <span class="tag">&lt;<span class="name">el-table-column</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]        <span class="attr">prop</span>=<span class="string">"description"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]        <span class="attr">label</span>=<span class="string">"介绍"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]        <span class="attr">width</span>=<span class="string">"180"</span>&gt;</span></span><br><span class="line">[tuture-add]      <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">[tuture-add]      <span class="tag">&lt;<span class="name">el-table-column</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]        <span class="attr">prop</span>=<span class="string">"price"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]        <span class="attr">label</span>=<span class="string">"价格"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]        <span class="attr">width</span>=<span class="string">"180"</span>&gt;</span></span><br><span class="line">[tuture-add]      <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">[tuture-add]      <span class="tag">&lt;<span class="name">el-table-column</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]        <span class="attr">prop</span>=<span class="string">"manufacturer.name"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]        <span class="attr">label</span>=<span class="string">"生产厂商"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]        <span class="attr">width</span>=<span class="string">"180"</span>&gt;</span></span><br><span class="line">[tuture-add]      <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">[tuture-add]      <span class="comment">&lt;!-- &lt;el-table-column</span></span><br><span class="line"><span class="comment">[tuture-add]        label="图片"</span></span><br><span class="line"><span class="comment">[tuture-add]        width="200"&gt;</span></span><br><span class="line"><span class="comment">[tuture-add]        &lt;img :src="image" alt="" class="product__image"&gt;</span></span><br><span class="line"><span class="comment">[tuture-add]      &lt;/el-table-column&gt; --&gt;</span></span><br><span class="line">[tuture-add]      <span class="tag">&lt;<span class="name">el-table-column</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]        <span class="attr">label</span>=<span class="string">"操作"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]        <span class="attr">width</span>=<span class="string">"180"</span>&gt;</span></span><br><span class="line">[tuture-add]        <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot-scope</span>=<span class="string">"scope"</span>&gt;</span></span><br><span class="line">[tuture-add]          <span class="tag">&lt;<span class="name">product-button</span> <span class="attr">:id</span>=<span class="string">"scope.row._id"</span>&gt;</span><span class="tag">&lt;/<span class="name">product-button</span>&gt;</span></span><br><span class="line">[tuture-add]        <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">[tuture-add]      <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">[tuture-add]    <span class="tag">&lt;/<span class="name">el-table</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">[tuture-add]  <span class="comment">&lt;!-- &lt;div class="product"&gt;</span></span><br><span class="line"><span class="comment">[tuture-add]    &lt;router-link :to="'/detail/' + product._id" class="product-link"&gt;</span></span><br><span class="line"><span class="comment">[tuture-add]      &lt;p class="product__name"&gt;产品名称：&#123;&#123;product.name&#125;&#125;&lt;/p&gt;</span></span><br><span class="line"><span class="comment">[tuture-add]      &lt;p class="product__description"&gt;介绍：&#123;&#123;product.description&#125;&#125;&lt;/p&gt;</span></span><br><span class="line"><span class="comment">[tuture-add]      &lt;p class="product__price"&gt;价格：&#123;&#123;product.price&#125;&#125;&lt;/p&gt;</span></span><br><span class="line"><span class="comment">[tuture-add]      &lt;p class="product.manufacturer"&gt;生产厂商：&#123;&#123;product.manufacturer.name&#125;&#125;&lt;/p&gt;</span></span><br><span class="line"><span class="comment">[tuture-add]      &lt;img :src="product.image" alt="" class="product__image"&gt;</span></span><br><span class="line"><span class="comment">[tuture-add]    &lt;/router-link&gt;</span></span><br><span class="line"><span class="comment">[tuture-add]    &lt;product-button :product="product"&gt;&lt;/product-button&gt;</span></span><br><span class="line"><span class="comment">[tuture-add]  &lt;/div&gt; --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-del]</span><span class="selector-class">.product</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-del]</span>  <span class="selector-tag">border-bottom</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-tag">black</span>;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span><span class="selector-class">.products</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span>  <span class="selector-tag">padding-top</span>: 10<span class="selector-tag">px</span>;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span>  <span class="selector-tag">text-align</span>: <span class="selector-tag">center</span>;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-del]</span> </span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-del]</span><span class="selector-class">.product__image</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-del]</span>  <span class="selector-tag">width</span>: 100<span class="selector-tag">px</span>;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-del]</span>  <span class="selector-tag">height</span>: 100<span class="selector-tag">px</span>;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span><span class="selector-class">.table</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span>  <span class="selector-tag">margin</span><span class="selector-pseudo">:0</span> <span class="selector-tag">auto</span>;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span>  <span class="selector-tag">width</span>: 900<span class="selector-tag">px</span>;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span>&#125;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span><span class="selector-class">.el-table</span> <span class="selector-class">.cell</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span>  <span class="selector-tag">text-align</span>: <span class="selector-tag">center</span>;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span>  <span class="selector-tag">padding-top</span>: 10<span class="selector-tag">px</span>;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span>  <span class="selector-tag">padding-bottom</span>: 10<span class="selector-tag">px</span>;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span><span class="comment">/* .product__image &#123;</span></span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span>  <span class="selector-tag">width</span>: 50%;</span></span><br><span class="line">[tuture-add]&#125; */</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> ProductButton <span class="keyword">from</span> <span class="string">'./ProductButton'</span>;</span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="actionscript">  name: <span class="string">'product-item'</span>,</span></span><br><span class="line"><span class="actionscript">[tuture-del]  props: [<span class="string">'product'</span>],</span></span><br><span class="line"><span class="actionscript">[tuture-add]  props: [<span class="string">'products'</span>],</span></span><br><span class="line">  components: &#123;</span><br><span class="line"><span class="actionscript">    <span class="string">'product-button'</span>: ProductButton,</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>其实这里的修改相信大家都能看懂，我们就简单的做一下介绍。您可能还记得我们在上面卖的一个关子，为什么我们直接向该组件中传入了 <code>products</code> 数组而不是遍历的 <code>product</code> 对象？相信大家看了该组件的重构也能豁然开朗，那就是因为我们使用的 <code>el-table</code> 表格组件需要传入一个数组作为 <code>data</code> 属性，并将每个元素对象作为 <code>prop</code> 传入表格，按照对应的列名展示出来。</p>
<p>除此之外，相信大家也发现了最后一个 <code>el-table-column</code> 标签中并没有定义 <code>prop</code> 属性，这是因为最后一列单元格中放置的是按钮而不是商品信息，该按钮是用于对指定行对象进行指定操作，这里我们使用 <code>scope.row</code> 获取指定行对象并将其id传递给了 <code>ProductButton</code> 按钮组件。</p>
<div class="note info">
            <p><strong>提示</strong></p><p>通过 slot-scope 可以获取到 row, column, $index 和 store（table 内部的状态管理）的数据。</p>
          </div>

<p>再次进入 <code>ProductButton</code> 组件进行修改，这里我们使用了 <code>element-ui</code> 组件库提供的 <code>el-button</code> 按钮组件替代之前普通的 <code>button</code> 标签并修改了对应的数据处理。</p>
<figure class="highlight html"><figcaption><span>src/components/products/ProductButton.vue</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvdnVlLW9ubGluZS1zaG9wLWZyb250ZW5kL2Jsb2IvYjZkOWE4N2YxYWY4ZjJhMDY4Y2ZiNWEyZDM5MmZkMWRiYWVjODRjMy9zcmMvY29tcG9uZW50cy9wcm9kdWN0cy9Qcm9kdWN0QnV0dG9uLnZ1ZQ==" title="https://github.com/tuture-dev/vue-online-shop-frontend/blob/b6d9a87f1af8f2a068cfb5a2d392fd1dbaec84c3/src/components/products/ProductButton.vue">查看完整代码<i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">[tuture-del]    <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-if</span>=<span class="string">"isAdding"</span> <span class="attr">class</span>=<span class="string">"button"</span> @<span class="attr">click</span>=<span class="string">"addToCart"</span>&gt;</span>加入购物车<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">[tuture-del]    <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-else</span> <span class="attr">class</span>=<span class="string">"button"</span> @<span class="attr">click</span>=<span class="string">"removeFromCart(product._id)"</span>&gt;</span>从购物车移除<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">[tuture-add]    <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]          <span class="attr">v-if</span>=<span class="string">"isAdding"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]          @<span class="attr">click</span>=<span class="string">"addToCart"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]          <span class="attr">type</span>=<span class="string">"text"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]          <span class="attr">size</span>=<span class="string">"small"</span>&gt;</span></span><br><span class="line">[tuture-add]          加入购物车</span><br><span class="line">[tuture-add]    <span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">[tuture-add]    <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]          <span class="attr">v-else</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]          @<span class="attr">click</span>=<span class="string">"removeFromCart(id)"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]          <span class="attr">type</span>=<span class="string">"text"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]          <span class="attr">size</span>=<span class="string">"small"</span>&gt;</span></span><br><span class="line">[tuture-add]          从购物车移除</span><br><span class="line">[tuture-add]    <span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="actionscript">[tuture-del]  props: [<span class="string">'product'</span>],</span></span><br><span class="line"><span class="actionscript">[tuture-add]  props: [<span class="string">'id'</span>],</span></span><br><span class="line">  computed: &#123;</span><br><span class="line">[tuture-add]    product() &#123;</span><br><span class="line"><span class="javascript">[tuture-add]      <span class="keyword">let</span> product = <span class="keyword">this</span>.$store.getters.allProducts.find(<span class="function"><span class="params">product</span> =&gt;</span> product._id === <span class="keyword">this</span>.id)</span></span><br><span class="line"><span class="actionscript">[tuture-add]      <span class="keyword">return</span> product;</span></span><br><span class="line">[tuture-add]    &#125;,</span><br><span class="line"><span class="actionscript">    <span class="comment">// ...</span></span></span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line"><span class="actionscript">    <span class="comment">// ...</span></span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这里我们首先简单地使用了 <code>el-button</code> 按钮组件，然后将从父组件获取的 <code>product</code> 对象修改为了 <code>id</code>，因为我们在 <code>ProductItem</code> 组件中传入的是指定对象的 <code>id</code>，因此我们在按钮组件中定义了计算属性 <code>product</code>，从本地获取指定 <code>id</code> 的 <code>product</code> 对象。</p>
<p>我们已经迫不及待把项目跑起来了，看看我们的首页导航以及商品信息列表发生了怎样不可思议的改变：</p>
<p><img alt data-src="https://static.powerformer.com/c/092faf4/170bd7f1d39bb647.png"></p>
<h3 id="重构商品信息功能"><a href="#重构商品信息功能" class="headerlink" title="重构商品信息功能"></a>重构商品信息功能</h3><p>这部分内容主要是有关商品信息功能的重构，包括商品信息列表的展示、修改指定商品信息以及添加新商品，我们都使用了 <code>element-ui</code> 组件库提供的组件进行重构，提高用户操作商品信息时的交互体验。</p>
<p>首先我们进入 <code>Products</code> 组件，同样使用了 <code>element-ui</code> 组件库提供的 <code>el-table</code> 组件替换了之前普通表格来展示商品信息列表。</p>
<figure class="highlight html"><figcaption><span>src/pages/admin/Products.vue</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvdnVlLW9ubGluZS1zaG9wLWZyb250ZW5kL2Jsb2IvYjZkOWE4N2YxYWY4ZjJhMDY4Y2ZiNWEyZDM5MmZkMWRiYWVjODRjMy9zcmMvcGFnZXMvYWRtaW4vUHJvZHVjdHMudnVl" title="https://github.com/tuture-dev/vue-online-shop-frontend/blob/b6d9a87f1af8f2a068cfb5a2d392fd1dbaec84c3/src/pages/admin/Products.vue">查看完整代码<i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">[tuture-del]  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">[tuture-del]    <span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"table"</span>&gt;</span></span><br><span class="line">[tuture-add]  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"products"</span>&gt;</span></span><br><span class="line">[tuture-add]    <span class="tag">&lt;<span class="name">el-table</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]    <span class="attr">class</span>=<span class="string">"table"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]    <span class="attr">:data</span>=<span class="string">"products"</span>&gt;</span></span><br><span class="line">[tuture-add]      <span class="tag">&lt;<span class="name">el-table-column</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]        <span class="attr">prop</span>=<span class="string">"name"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]        <span class="attr">label</span>=<span class="string">"名称"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]        <span class="attr">width</span>=<span class="string">"180"</span>&gt;</span></span><br><span class="line">[tuture-add]      <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">[tuture-add]      <span class="tag">&lt;<span class="name">el-table-column</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]        <span class="attr">prop</span>=<span class="string">"price"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]        <span class="attr">label</span>=<span class="string">"价格"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]        <span class="attr">width</span>=<span class="string">"180"</span>&gt;</span></span><br><span class="line">[tuture-add]      <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">[tuture-add]      <span class="tag">&lt;<span class="name">el-table-column</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]        <span class="attr">prop</span>=<span class="string">"manufacturer.name"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]        <span class="attr">label</span>=<span class="string">"制造商"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]        <span class="attr">width</span>=<span class="string">"180"</span>&gt;</span></span><br><span class="line">[tuture-add]      <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">[tuture-add]      <span class="tag">&lt;<span class="name">el-table-column</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]        <span class="attr">label</span>=<span class="string">"操作"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]        <span class="attr">width</span>=<span class="string">"200"</span>&gt;</span></span><br><span class="line">[tuture-add]        <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot-scope</span>=<span class="string">"scope"</span>&gt;</span></span><br><span class="line">[tuture-add]          <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">class</span>=<span class="string">"modify"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">size</span>=<span class="string">"small"</span>&gt;</span><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">:to</span>=<span class="string">"'/admin/edit/' + scope.row._id"</span>&gt;</span>修改<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span><span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">[tuture-add]          <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">class</span>=<span class="string">"remove"</span> @<span class="attr">click</span>=<span class="string">"removeProduct(scope.row._id), deleteRow(scope.$index, products)"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">size</span>=<span class="string">"small"</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">[tuture-add]        <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">[tuture-add]      <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">[tuture-add]    <span class="tag">&lt;/<span class="name">el-table</span>&gt;</span></span><br><span class="line">[tuture-add]    <span class="comment">&lt;!-- &lt;table class="table"&gt;</span></span><br><span class="line"><span class="comment">      &lt;thead&gt;</span></span><br><span class="line"><span class="comment">        &lt;tr&gt;</span></span><br><span class="line"><span class="comment">          &lt;th&gt;名称&lt;/th&gt;</span></span><br><span class="line"><span class="comment">          // ...</span></span><br><span class="line"><span class="comment">          &lt;td class="remove"&gt;&lt;a @click="removeProduct(product._id)" href="#"&gt;删除&lt;/a&gt;&lt;/td&gt;</span></span><br><span class="line"><span class="comment">        &lt;/tr&gt;</span></span><br><span class="line"><span class="comment">      &lt;/tbody&gt;</span></span><br><span class="line"><span class="comment">[tuture-del]    &lt;/table&gt;</span></span><br><span class="line"><span class="comment">[tuture-add]    &lt;/table&gt; --&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-del]</span><span class="selector-tag">table</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-del]</span>  <span class="selector-tag">margin</span>: 0 <span class="selector-tag">auto</span>;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span><span class="selector-class">.products</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span>  <span class="selector-tag">padding-top</span>: 10<span class="selector-tag">px</span>;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span>  <span class="selector-tag">text-align</span>: <span class="selector-tag">center</span>;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span>&#125;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span><span class="selector-class">.table</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span>  <span class="selector-tag">margin</span><span class="selector-pseudo">:0</span> <span class="selector-tag">auto</span>;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span>  <span class="selector-tag">width</span>: 740<span class="selector-tag">px</span>;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span>&#125;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span><span class="selector-class">.el-table</span> <span class="selector-class">.cell</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span>  <span class="selector-tag">text-align</span>: <span class="selector-tag">center</span>;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span>  <span class="selector-tag">padding-top</span>: 10<span class="selector-tag">px</span>;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span>  <span class="selector-tag">padding-bottom</span>: 10<span class="selector-tag">px</span>;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-del]</span> </span></span><br><span class="line"><span class="css"><span class="selector-class">.modify</span> &#123;</span></span><br><span class="line">  color: blue;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-del]</span><span class="selector-class">.remove</span> <span class="selector-tag">a</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span><span class="selector-class">.remove</span> &#123;</span></span><br><span class="line">  color: red;</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"> // ...</span><br></pre></td></tr></table></figure>

<p>细心的大家肯定已经发现了这里的表格有点似曾相识，没错，这里的表格与 <code>ProductItem</code> 组件中的表格非常相似，都是用来展示本地商品信息，但是两者的区别是对商品对象的操作，<code>ProductItem</code> 组件中的按钮组件是用于将商品添加或移出购物车，而该组件中的按钮组件是用于修改或删除商品对象。</p>
<p>这是我们重构之后的商品信息列表：</p>
<p><img alt data-src="https://static.powerformer.com/c/092faf4/170bd7fc2f9b7080.png"></p>
<p>然后我们先对修改功能进行重构，再次进入 <code>Edit</code> 组件，我们在这里做了数据处理修改，目的是尝试解决商品信息表单无法编辑问题。</p>
<figure class="highlight html"><figcaption><span>src/pages/admin/Edit.vue</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvdnVlLW9ubGluZS1zaG9wLWZyb250ZW5kL2Jsb2IvYjZkOWE4N2YxYWY4ZjJhMDY4Y2ZiNWEyZDM5MmZkMWRiYWVjODRjMy9zcmMvcGFnZXMvYWRtaW4vRWRpdC52dWU=" title="https://github.com/tuture-dev/vue-online-shop-frontend/blob/b6d9a87f1af8f2a068cfb5a2d392fd1dbaec84c3/src/pages/admin/Edit.vue">查看完整代码<i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line">// ...</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> ProductForm <span class="keyword">from</span> <span class="string">'@/components/products/ProductForm.vue'</span>;</span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line">[tuture-add]  data: &#123;</span><br><span class="line">[tuture-add]    model() &#123;</span><br><span class="line"><span class="actionscript">[tuture-add]      <span class="keyword">const</span> product = <span class="keyword">this</span>.$store.getters.productById(<span class="keyword">this</span>.$route.params[<span class="string">'id'</span>]);</span></span><br><span class="line"><span class="actionscript">[tuture-add]      <span class="comment">// 这里返回 product 的拷贝，是为了在修改 product 的拷贝之后，在保存之前不修改本地 Vuex stire 的 product 属性</span></span></span><br><span class="line"><span class="actionscript">[tuture-add]      <span class="keyword">return</span> &#123; ...product, manufacturer: &#123; ...product.manufacturer &#125; &#125;;</span></span><br><span class="line">[tuture-add]    &#125;</span><br><span class="line">[tuture-add]  &#125;,</span><br><span class="line">  created() &#123;</span><br><span class="line"><span class="actionscript">    <span class="keyword">const</span> &#123; name &#125; = <span class="keyword">this</span>.model;</span></span><br><span class="line">    if (!name) &#123;</span><br><span class="line"><span class="actionscript">      <span class="comment">// ...</span></span></span><br><span class="line">  computed: &#123;</span><br><span class="line">    manufacturers() &#123;</span><br><span class="line"><span class="actionscript">      <span class="keyword">return</span> <span class="keyword">this</span>.$store.getters.allManufacturers;</span></span><br><span class="line">[tuture-del]    &#125;,</span><br><span class="line">[tuture-del]    model() &#123;</span><br><span class="line"><span class="actionscript">[tuture-del]      <span class="keyword">const</span> product = <span class="keyword">this</span>.$store.getters.productById(<span class="keyword">this</span>.$route.params[<span class="string">'id'</span>]);</span></span><br><span class="line">[tuture-del] </span><br><span class="line"><span class="actionscript">[tuture-del]      <span class="comment">// 这里返回 product 的拷贝，是为了在修改 product 的拷贝之后，在保存之前不修改本地 Vuex stire 的 product 属性</span></span></span><br><span class="line"><span class="actionscript">[tuture-del]      <span class="keyword">return</span> &#123; ...product, manufacturer: &#123; ...product.manufacturer &#125; &#125;;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line"><span class="actionscript">    <span class="comment">// ...</span></span></span><br></pre></td></tr></table></figure>

<p>这里我们把定义的计算属性 <code>model</code> 修改为 <code>data</code> 属性，因为我们发现如果商品对象 <code>model</code> 作为计算属性传给子组件 <code>ProductForm</code> 进行信息展示时，无法进行表单编辑，大家可以运行起来尝试一下是否可以进行编辑。我们初始猜想是 <code>el-form</code> 表单组件中的表单数据对象 <code>model</code> 不能来自计算属性，否则无法进行编辑，因此我们首度尝试将该组件中的计算属性 <code>model</code> 放到 <code>data</code> 属性中。</p>
<p>再次进入 <code>ProductForm</code> 组件进行重构，这里我们使用了 <code>element-ui</code> 组件库提供的 <code>el-form</code> 表单组件替换之前的普通表单展示商品信息。</p>
<figure class="highlight html"><figcaption><span>src/components/products/ProductForm.vue</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvdnVlLW9ubGluZS1zaG9wLWZyb250ZW5kL2Jsb2IvYjZkOWE4N2YxYWY4ZjJhMDY4Y2ZiNWEyZDM5MmZkMWRiYWVjODRjMy9zcmMvY29tcG9uZW50cy9wcm9kdWN0cy9Qcm9kdWN0Rm9ybS52dWU=" title="https://github.com/tuture-dev/vue-online-shop-frontend/blob/b6d9a87f1af8f2a068cfb5a2d392fd1dbaec84c3/src/components/products/ProductForm.vue">查看完整代码<i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">[tuture-del]  <span class="tag">&lt;<span class="name">form</span> @<span class="attr">submit.prevent</span>=<span class="string">"saveProduct"</span>&gt;</span></span><br><span class="line">[tuture-add]  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"productInfo"</span>&gt;</span></span><br><span class="line">[tuture-add]    <span class="tag">&lt;<span class="name">el-form</span> <span class="attr">class</span>=<span class="string">"form"</span> <span class="attr">ref</span>=<span class="string">"form"</span> <span class="attr">:model</span>=<span class="string">"model"</span> <span class="attr">label-width</span>=<span class="string">"180px"</span>&gt;</span></span><br><span class="line">[tuture-add]      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">"Name"</span>&gt;</span></span><br><span class="line">[tuture-add]        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">"model.name"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">[tuture-add]      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">[tuture-add]      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">"Price"</span>&gt;</span></span><br><span class="line">[tuture-add]        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">"model.price"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">[tuture-add]      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">[tuture-add]      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">"Manufacturer "</span>&gt;</span></span><br><span class="line">[tuture-add]        <span class="tag">&lt;<span class="name">el-select</span> <span class="attr">v-model</span>=<span class="string">"model.manufacturer.name"</span> <span class="attr">clearable</span> <span class="attr">placeholder</span>=<span class="string">"请选择制造商"</span>&gt;</span></span><br><span class="line">[tuture-add]          <span class="tag">&lt;<span class="name">el-option</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]            <span class="attr">v-for</span>=<span class="string">"manufacturer in manufacturers"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]            <span class="attr">:key</span>=<span class="string">"manufacturer._id"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]            <span class="attr">:label</span>=<span class="string">"manufacturer.name"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]            <span class="attr">:value</span>=<span class="string">"manufacturer.name"</span>&gt;</span></span><br><span class="line">[tuture-add]          <span class="tag">&lt;/<span class="name">el-option</span>&gt;</span></span><br><span class="line">[tuture-add]        <span class="tag">&lt;/<span class="name">el-select</span>&gt;</span></span><br><span class="line">[tuture-add]      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">[tuture-add]      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">"Image "</span>&gt;</span></span><br><span class="line">[tuture-add]        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">"model.image"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">[tuture-add]      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">[tuture-add]      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">"Description "</span>&gt;</span></span><br><span class="line">[tuture-add]        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">type</span>=<span class="string">"textarea"</span> <span class="attr">v-model</span>=<span class="string">"model.description"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">[tuture-add]      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">[tuture-add]      <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">[tuture-add]        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">v-if</span>=<span class="string">"isEditing"</span> <span class="attr">type</span>=<span class="string">"primary"</span> @<span class="attr">click</span>=<span class="string">"onSubmit"</span>&gt;</span>Update Product<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">[tuture-add]        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">v-else</span> @<span class="attr">click</span>=<span class="string">"onSubmit"</span>&gt;</span>Add Product<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">[tuture-add]      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">[tuture-add]    <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line">[tuture-add]  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  // ...</span><br><span class="line">[tuture-del]  <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">  // ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="actionscript">  props: [<span class="string">'model'</span>, <span class="string">'manufacturers'</span>, <span class="string">'isEditing'</span>],</span></span><br><span class="line">[tuture-add]  created() &#123;</span><br><span class="line"><span class="javascript">[tuture-add]    <span class="built_in">console</span>.log(<span class="keyword">this</span>.model)</span></span><br><span class="line">[tuture-add]  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">[tuture-del]    saveProduct() &#123;</span><br><span class="line">[tuture-add]    onSubmit() &#123;</span><br><span class="line"><span class="actionscript">      <span class="keyword">this</span>.$emit(<span class="string">'save-product'</span>, <span class="keyword">this</span>.model)</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">[tuture-add]<span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span><span class="selector-class">.productInfo</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span>  <span class="selector-tag">padding-top</span>: 10<span class="selector-tag">px</span>;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span>&#125;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span><span class="selector-class">.form</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span>  <span class="selector-tag">margin</span>: 0 <span class="selector-tag">auto</span>;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span>  <span class="selector-tag">width</span>: 500<span class="selector-tag">px</span>;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span>&#125;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span><span class="selector-class">.el-input__inner</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span>  <span class="selector-tag">height</span>: 60<span class="selector-tag">px</span>;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span>&#125;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>相信大家也能轻松的看懂 <code>el-form</code> 表单组件的使用，这里的 <code>model</code> 属性表示表单数据对象，我们可以使用 <code>v-model</code> 将表单数据对象中的信息双向绑定到相应的表单内组件上。特别提醒一下商品对象 <code>model</code> 中的 <code>manufacturer</code> 是一个制造商对象，包含制造商 <code>id</code> 和 <code>name</code> 属性。</p>
<p>现在我们再进入 <code>New</code> 组件进行重构，当我们发现 <code>Edit</code> 组件中的问题之后，我们同样尝试将该组件中的计算属性 <code>model</code> 定义到 <code>data</code> 属性中。</p>
<figure class="highlight html"><figcaption><span>src/pages/admin/New.vue</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvdnVlLW9ubGluZS1zaG9wLWZyb250ZW5kL2Jsb2IvYjZkOWE4N2YxYWY4ZjJhMDY4Y2ZiNWEyZDM5MmZkMWRiYWVjODRjMy9zcmMvcGFnZXMvYWRtaW4vTmV3LnZ1ZQ==" title="https://github.com/tuture-dev/vue-online-shop-frontend/blob/b6d9a87f1af8f2a068cfb5a2d392fd1dbaec84c3/src/pages/admin/New.vue">查看完整代码<i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line">// ...</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> ProductForm <span class="keyword">from</span> <span class="string">'@/components/products/ProductForm.vue'</span>;</span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line">[tuture-add]  data() &#123;</span><br><span class="line"><span class="actionscript">[tuture-add]    <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="actionscript">[tuture-add]      model: &#123;manufacturer:&#123;name: <span class="string">''</span>&#125;&#125;</span></span><br><span class="line">[tuture-add]    &#125;</span><br><span class="line">[tuture-add]  &#125;,</span><br><span class="line"><span class="actionscript">  <span class="comment">// ...</span></span></span><br><span class="line">  computed: &#123;</span><br><span class="line">    manufacturers() &#123;</span><br><span class="line"><span class="actionscript">      <span class="keyword">return</span> <span class="keyword">this</span>.$store.getters.allManufacturers;</span></span><br><span class="line">[tuture-del]    &#125;,</span><br><span class="line">[tuture-del]    model() &#123;</span><br><span class="line"><span class="actionscript">[tuture-del]      <span class="keyword">return</span> &#123;&#125;;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"><span class="actionscript">  <span class="comment">// ...</span></span></span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>因为该组件是新建商品组件，因此我们定义的是一个空对象 <code>model</code>，但是我们需要给其一个默认初始形式 <code>model: {manufacturer: {name: ' '}}</code>，防止在子组件表单中无法访问 <code>name</code> 属性导致报错。</p>
<p>现在我们添加或者修改商品信息的表单界面变成了这样：</p>
<p><img alt data-src="https://static.powerformer.com/c/092faf4/170bd807ce1da156.png"></p>
<h3 id="重构制造商信息功能"><a href="#重构制造商信息功能" class="headerlink" title="重构制造商信息功能"></a>重构制造商信息功能</h3><p>制造商信息功能包括制造商信息展示，添加制造商以及修改制造商信息，同重构商品信息功能一样，我们也使用了 <code>element-ui</code> 组件库提供的组件进行重构，提高用户操作制造商信息时的交互体验。</p>
<p>首先我们进入 <code>Manufacturers</code> 组件进行重构，同 <code>Products</code> 组件类似，我们使用了 <code>element-ui</code> 组件库提供的 <code>el-table</code> 表格组件替换了之前普通的表格展示制造商信息列表。</p>
<figure class="highlight html"><figcaption><span>src/pages/admin/Manufacturers.vue</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvdnVlLW9ubGluZS1zaG9wLWZyb250ZW5kL2Jsb2IvYjZkOWE4N2YxYWY4ZjJhMDY4Y2ZiNWEyZDM5MmZkMWRiYWVjODRjMy9zcmMvcGFnZXMvYWRtaW4vTWFudWZhY3R1cmVycy52dWU=" title="https://github.com/tuture-dev/vue-online-shop-frontend/blob/b6d9a87f1af8f2a068cfb5a2d392fd1dbaec84c3/src/pages/admin/Manufacturers.vue">查看完整代码<i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">[tuture-del]  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">[tuture-del]    <span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"table"</span>&gt;</span></span><br><span class="line">[tuture-add]  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"manufacturers"</span>&gt;</span></span><br><span class="line">[tuture-add]    <span class="tag">&lt;<span class="name">el-table</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]    <span class="attr">class</span>=<span class="string">"table"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]    <span class="attr">:data</span>=<span class="string">"manufacturers"</span>&gt;</span></span><br><span class="line">[tuture-add]      <span class="tag">&lt;<span class="name">el-table-column</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]        <span class="attr">prop</span>=<span class="string">"name"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]        <span class="attr">label</span>=<span class="string">"制造商"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]        <span class="attr">width</span>=<span class="string">"180"</span>&gt;</span></span><br><span class="line">[tuture-add]      <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">[tuture-add]      <span class="tag">&lt;<span class="name">el-table-column</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]        <span class="attr">label</span>=<span class="string">"操作"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]        <span class="attr">width</span>=<span class="string">"200"</span>&gt;</span></span><br><span class="line">[tuture-add]        <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot-scope</span>=<span class="string">"scope"</span>&gt;</span></span><br><span class="line">[tuture-add]          <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">class</span>=<span class="string">"modify"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">size</span>=<span class="string">"small"</span>&gt;</span><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">:to</span>=<span class="string">"'/admin/manufacturers/edit/' + scope.row._id"</span>&gt;</span>修改<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span><span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">[tuture-add]          <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">class</span>=<span class="string">"remove"</span> @<span class="attr">click</span>=<span class="string">"removeManufacturer(scope.row._id), deleteRow(scope.$index, products)"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">size</span>=<span class="string">"small"</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">[tuture-add]        <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">[tuture-add]      <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">[tuture-add]    <span class="tag">&lt;/<span class="name">el-table</span>&gt;</span></span><br><span class="line">    // ...</span><br><span class="line">[tuture-del]    <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">    // ...</span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-del]</span><span class="selector-tag">table</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-del]</span>  <span class="selector-tag">margin</span>: 0 <span class="selector-tag">auto</span>;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span><span class="selector-class">.manufacturers</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span>  <span class="selector-tag">padding-top</span>: 20<span class="selector-tag">px</span>;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span>  <span class="selector-tag">text-align</span>: <span class="selector-tag">center</span>;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span>&#125;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span><span class="selector-class">.table</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span>  <span class="selector-tag">margin</span><span class="selector-pseudo">:0</span> <span class="selector-tag">auto</span>;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span>  <span class="selector-tag">width</span>: 380<span class="selector-tag">px</span>;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span>&#125;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span><span class="selector-class">.el-table</span> <span class="selector-class">.cell</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span>  <span class="selector-tag">text-align</span>: <span class="selector-tag">center</span>;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span>  <span class="selector-tag">padding-top</span>: 10<span class="selector-tag">px</span>;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span>  <span class="selector-tag">padding-bottom</span>: 10<span class="selector-tag">px</span>;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-del]</span> </span></span><br><span class="line">// ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"> // ...</span><br></pre></td></tr></table></figure>

<p>这是我们重构后的制造商信息列表：</p>
<p><img alt data-src="https://static.powerformer.com/c/092faf4/170bd8133a39a38f.png"></p>
<p>再次进入 <code>NewManufacturers</code> 组件进行重构，同样的将定义的计算属性 <code>model</code> 放到 <code>data</code> 属性中：</p>
<figure class="highlight html"><figcaption><span>src/pages/admin/NewManufacturers.vue</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvdnVlLW9ubGluZS1zaG9wLWZyb250ZW5kL2Jsb2IvYjZkOWE4N2YxYWY4ZjJhMDY4Y2ZiNWEyZDM5MmZkMWRiYWVjODRjMy9zcmMvcGFnZXMvYWRtaW4vTmV3TWFudWZhY3R1cmVycy52dWU=" title="https://github.com/tuture-dev/vue-online-shop-frontend/blob/b6d9a87f1af8f2a068cfb5a2d392fd1dbaec84c3/src/pages/admin/NewManufacturers.vue">查看完整代码<i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line">// ...</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> ManufacturerForm <span class="keyword">from</span> <span class="string">'@/components/ManufacturerForm.vue'</span>;</span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line">[tuture-del]  computed: &#123;</span><br><span class="line">[tuture-del]    model() &#123;</span><br><span class="line"><span class="actionscript">[tuture-del]      <span class="keyword">return</span> &#123;&#125;;</span></span><br><span class="line">[tuture-add]  data() &#123;</span><br><span class="line"><span class="actionscript">[tuture-add]    <span class="keyword">return</span> &#123;</span></span><br><span class="line">[tuture-add]      model: &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line"><span class="actionscript">    <span class="comment">// ...</span></span></span><br></pre></td></tr></table></figure>

<p>然后进入子组件 <code>ManufacturerForm</code> 中进行重构，同 <code>ProductForm</code> 组件类似，使用 <code>element-ui</code> 组件库提供的 <code>el-form</code> 表单组件替换了之前普通的表单展示制造商信息：</p>
<figure class="highlight html"><figcaption><span>src/components/ManufacturerForm.vue</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvdnVlLW9ubGluZS1zaG9wLWZyb250ZW5kL2Jsb2IvYjZkOWE4N2YxYWY4ZjJhMDY4Y2ZiNWEyZDM5MmZkMWRiYWVjODRjMy9zcmMvY29tcG9uZW50cy9NYW51ZmFjdHVyZXJGb3JtLnZ1ZQ==" title="https://github.com/tuture-dev/vue-online-shop-frontend/blob/b6d9a87f1af8f2a068cfb5a2d392fd1dbaec84c3/src/components/ManufacturerForm.vue">查看完整代码<i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">[tuture-del]  <span class="tag">&lt;<span class="name">form</span> @<span class="attr">submit.prevent</span>=<span class="string">"saveManufacturer"</span>&gt;</span></span><br><span class="line">[tuture-add]  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"manufacturerInfo"</span>&gt;</span></span><br><span class="line">[tuture-add]    <span class="tag">&lt;<span class="name">el-form</span> <span class="attr">class</span>=<span class="string">"form"</span> <span class="attr">ref</span>=<span class="string">"form"</span> <span class="attr">:model</span>=<span class="string">"model"</span> <span class="attr">label-width</span>=<span class="string">"180px"</span>&gt;</span></span><br><span class="line">[tuture-add]      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">"Name"</span>&gt;</span></span><br><span class="line">[tuture-add]        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">"model.name"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">[tuture-add]      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">[tuture-add]      <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">[tuture-add]        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">v-if</span>=<span class="string">"isEditing"</span> <span class="attr">type</span>=<span class="string">"primary"</span> @<span class="attr">click</span>=<span class="string">"onSubmit"</span>&gt;</span>Update Manufacturer<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">[tuture-add]        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">v-else</span> @<span class="attr">click</span>=<span class="string">"onSubmit"</span>&gt;</span>Add Manufacturer<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">[tuture-add]      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">[tuture-add]    <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line">[tuture-add]  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">[tuture-add]  <span class="comment">&lt;!-- &lt;form @submit.prevent="saveManufacturer"&gt;</span></span><br><span class="line"><span class="comment">    &lt;div class="form-group"&gt;</span></span><br><span class="line"><span class="comment">      &lt;label&gt;Name&lt;/label&gt;</span></span><br><span class="line"><span class="comment">      &lt;input</span></span><br><span class="line"><span class="comment">        // ...</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    &lt;div class="form-group new-button"&gt;</span></span><br><span class="line"><span class="comment">      &lt;button class="button"&gt;</span></span><br><span class="line"><span class="comment">[tuture-del]        &lt;i class="fa fa-pencil"&gt;&lt;/i&gt;</span></span><br><span class="line"><span class="comment">[tuture-add]        &lt;i class="fa fa-pencil"&gt;&lt;/i&gt; --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Conditional rendering for input text --&gt;</span></span><br><span class="line">[tuture-del]        <span class="tag">&lt;<span class="name">span</span> <span class="attr">v-if</span>=<span class="string">"isEditing"</span>&gt;</span>Update Manufacturer<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">[tuture-add]        <span class="comment">&lt;!-- &lt;span v-if="isEditing"&gt;Update Manufacturer&lt;/span&gt;</span></span><br><span class="line"><span class="comment">        &lt;span v-else&gt;Add Manufacturer&lt;/span&gt;</span></span><br><span class="line"><span class="comment">      &lt;/button&gt;</span></span><br><span class="line"><span class="comment">    &lt;/div&gt;</span></span><br><span class="line"><span class="comment">[tuture-del]  &lt;/form&gt;</span></span><br><span class="line"><span class="comment">[tuture-add]  &lt;/form&gt; --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="actionscript">  props: [<span class="string">'model'</span>, <span class="string">'isEditing'</span>],</span></span><br><span class="line">  methods: &#123;</span><br><span class="line">[tuture-del]    saveManufacturer() &#123;</span><br><span class="line">[tuture-add]    onSubmit() &#123;</span><br><span class="line"><span class="actionscript">      <span class="keyword">this</span>.$emit(<span class="string">'save-manufacturer'</span>, <span class="keyword">this</span>.model)</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">[tuture-add]<span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span><span class="selector-class">.manufacturerInfo</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span>  <span class="selector-tag">padding-top</span>: 10<span class="selector-tag">px</span>;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span>&#125;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span><span class="selector-class">.form</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span>  <span class="selector-tag">margin</span>: 0 <span class="selector-tag">auto</span>;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span>  <span class="selector-tag">width</span>: 500<span class="selector-tag">px</span>;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span>&#125;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span><span class="selector-class">.el-input__inner</span> &#123;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span>  <span class="selector-tag">height</span>: 50<span class="selector-tag">px</span>;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span>&#125;</span></span><br><span class="line"><span class="css"><span class="selector-attr">[tuture-add]</span></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这是我们重构后用户添加或者修改制造商信息时的表单界面：</p>
<p><img alt data-src="https://static.powerformer.com/c/092faf4/170bd81d39c3eb45.png"></p>
<p>最后我们进入 <code>Cart</code> 组件进行重构，我们会发现该组件与 <code>ProductList</code> 组件极其相似，因为两者都复用了子组件 <code>ProductItem</code>，该组件是为了展示购物车商品信息列表。</p>
<figure class="highlight html"><figcaption><span>src/pages/Cart.vue</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvdnVlLW9ubGluZS1zaG9wLWZyb250ZW5kL2Jsb2IvYjZkOWE4N2YxYWY4ZjJhMDY4Y2ZiNWEyZDM5MmZkMWRiYWVjODRjMy9zcmMvcGFnZXMvQ2FydC52dWU=" title="https://github.com/tuture-dev/vue-online-shop-frontend/blob/b6d9a87f1af8f2a068cfb5a2d392fd1dbaec84c3/src/pages/Cart.vue">查看完整代码<i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line">// ...</span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"title"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;&#123;msg&#125;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">[tuture-del]    <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-for</span>=<span class="string">"product in cart"</span>&gt;</span></span><br><span class="line">[tuture-del]      <span class="tag">&lt;<span class="name">product-item</span> <span class="attr">:product</span>=<span class="string">"product"</span> <span class="attr">:key</span>=<span class="string">"product._id"</span>&gt;</span><span class="tag">&lt;/<span class="name">product-item</span>&gt;</span></span><br><span class="line">[tuture-del]    <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">[tuture-add]    <span class="tag">&lt;<span class="name">product-item</span> <span class="attr">:products</span>=<span class="string">"cart"</span>&gt;</span><span class="tag">&lt;/<span class="name">product-item</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line">// ...</span><br></pre></td></tr></table></figure>

<p>这是重构后的购物车界面：</p>
<p><img alt data-src="https://static.powerformer.com/c/092faf4/170bd82508c14642.png"></p>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>这一节我们主要就是使用 <code>element-ui</code> 组件库进行项目代码的重构，实现了首页导航栏、商品信息功能、制造商信息功能以及购物车的页面升级，提高了用户的交互体验。但是这也造成了部分功能逻辑的瘫痪，我们在下一节会带大家一起去解决问题。</p>
<h2 id="修复-ElementUI-表单的双向绑定问题"><a href="#修复-ElementUI-表单的双向绑定问题" class="headerlink" title="修复 ElementUI 表单的双向绑定问题"></a>修复 ElementUI 表单的双向绑定问题</h2><p>上一节我们使用了 <code>element-ui</code> 组件库完成项目代码重构，可是当我们把项目跑起来之后发现表单信息仍然无法编辑，说明我们之前的尝试失败。不过我们并没有灰心，而是选择继续尝试，这一节我们又尝试新方法来修复<code>element-ui</code> 表单双向绑定问题。</p>
<p>大家遇到的问题应该是这样子：</p>
<p><img alt data-src="https://static.powerformer.com/c/092faf4/170bd829d4626c61.png"></p>
<h3 id="重构-Edit-组件"><a href="#重构-Edit-组件" class="headerlink" title="重构 Edit 组件"></a>重构 Edit 组件</h3><p>我们首先进入 <code>Edit</code> 组件进行修复，这里我们主要恢复了原先的数据定义。</p>
<figure class="highlight html"><figcaption><span>src/pages/admin/Edit.vue</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvdnVlLW9ubGluZS1zaG9wLWZyb250ZW5kL2Jsb2IvMDJmNTc2MWZkYzU0MGEzY2YzZTA1NDliMmE0ZTNmNjE2YjRmMWE0OC9zcmMvcGFnZXMvYWRtaW4vRWRpdC52dWU=" title="https://github.com/tuture-dev/vue-online-shop-frontend/blob/02f5761fdc540a3cf3e0549b2a4e3f616b4f1a48/src/pages/admin/Edit.vue">查看完整代码<i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"title"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>This is Admin/Edit<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">product-form</span></span></span><br><span class="line"><span class="tag">      @<span class="attr">save-product</span>=<span class="string">"updateProduct"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:model</span>=<span class="string">"model"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:manufacturers</span>=<span class="string">"manufacturers"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:isEditing</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-del</span>]      &gt;</span><span class="tag">&lt;/<span class="name">product-form</span>&gt;</span></span><br><span class="line">[tuture-add]    &gt;<span class="tag">&lt;/<span class="name">product-form</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">[tuture-del]<span class="keyword">import</span> ProductForm <span class="keyword">from</span> <span class="string">'@/components/products/ProductForm.vue'</span>;</span></span><br><span class="line"><span class="javascript">[tuture-add]<span class="keyword">import</span> ProductForm <span class="keyword">from</span> <span class="string">"@/components/products/ProductForm.vue"</span>;</span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line">[tuture-del]  data: &#123;</span><br><span class="line">[tuture-del]    model() &#123;</span><br><span class="line"><span class="actionscript">[tuture-del]      <span class="keyword">const</span> product = <span class="keyword">this</span>.$store.getters.productById(<span class="keyword">this</span>.$route.params[<span class="string">'id'</span>]);</span></span><br><span class="line"><span class="actionscript">[tuture-del]      <span class="comment">// 这里返回 product 的拷贝，是为了在修改 product 的拷贝之后，在保存之前不修改本地 Vuex stire 的 product 属性</span></span></span><br><span class="line"><span class="actionscript">[tuture-del]      <span class="keyword">return</span> &#123; ...product, manufacturer: &#123; ...product.manufacturer &#125; &#125;;</span></span><br><span class="line">[tuture-del]    &#125;</span><br><span class="line">[tuture-del]  &#125;,</span><br><span class="line">  created() &#123;</span><br><span class="line"><span class="actionscript">[tuture-del]    <span class="keyword">const</span> &#123; name &#125; = <span class="keyword">this</span>.model;</span></span><br><span class="line"><span class="actionscript">[tuture-add]    <span class="keyword">const</span> &#123; name = <span class="string">""</span> &#125; = <span class="keyword">this</span>.modelData || &#123;&#125;;</span></span><br><span class="line">[tuture-add] </span><br><span class="line">    if (!name) &#123;</span><br><span class="line"><span class="actionscript">[tuture-del]      <span class="keyword">this</span>.$store.dispatch(<span class="string">'productById'</span>, &#123;</span></span><br><span class="line"><span class="actionscript">[tuture-del]        productId: <span class="keyword">this</span>.$route.params[<span class="string">'id'</span>]</span></span><br><span class="line"><span class="actionscript">[tuture-add]      <span class="keyword">this</span>.$store.dispatch(<span class="string">"productById"</span>, &#123;</span></span><br><span class="line"><span class="actionscript">[tuture-add]        productId: <span class="keyword">this</span>.$route.params[<span class="string">"id"</span>]</span></span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="keyword">if</span> (<span class="keyword">this</span>.manufacturers.length === <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="actionscript">[tuture-del]      <span class="keyword">this</span>.$store.dispatch(<span class="string">'allManufacturers'</span>);</span></span><br><span class="line"><span class="actionscript">[tuture-add]      <span class="keyword">this</span>.$store.dispatch(<span class="string">"allManufacturers"</span>);</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  computed: &#123;</span><br><span class="line">    manufacturers() &#123;</span><br><span class="line"><span class="actionscript">      <span class="keyword">return</span> <span class="keyword">this</span>.$store.getters.allManufacturers;</span></span><br><span class="line">[tuture-add]    &#125;,</span><br><span class="line">[tuture-add]    model() &#123;</span><br><span class="line"><span class="actionscript">[tuture-add]      <span class="keyword">const</span> product = <span class="keyword">this</span>.$store.getters.productById(<span class="keyword">this</span>.$route.params[<span class="string">"id"</span>]);</span></span><br><span class="line"><span class="actionscript">[tuture-add]      <span class="keyword">const</span> res = &#123; ...product, manufacturer: &#123; ...product.manufacturer &#125; &#125;;</span></span><br><span class="line">[tuture-add] </span><br><span class="line"><span class="actionscript">[tuture-add]      <span class="keyword">return</span> res;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    updateProduct(product) &#123;</span><br><span class="line"><span class="actionscript">[tuture-del]      <span class="keyword">this</span>.$store.dispatch(<span class="string">'updateProduct'</span>, &#123;</span></span><br><span class="line">[tuture-del]        product,</span><br><span class="line">[tuture-del]      &#125;)</span><br><span class="line"><span class="actionscript">[tuture-add]      <span class="keyword">this</span>.$store.dispatch(<span class="string">"updateProduct"</span>, &#123;</span></span><br><span class="line">[tuture-add]        product</span><br><span class="line">[tuture-add]      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  components: &#123;</span><br><span class="line"><span class="actionscript">[tuture-del]    <span class="string">'product-form'</span>: ProductForm</span></span><br><span class="line"><span class="actionscript">[tuture-add]    <span class="string">"product-form"</span>: ProductForm</span></span><br><span class="line">  &#125;</span><br><span class="line">[tuture-del]&#125;</span><br><span class="line">[tuture-add]&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>我们又将替换到 <code>data</code> 属性中的 <code>model</code> 对象恢复到了计算属性中，用于缓存 <code>model</code> 对象信息，提高性能。我们打算在下面的 <code>ProductForm</code> 组件中进行修复表单无法编辑的问题。</p>
<h3 id="重构-ProductForm-组件"><a href="#重构-ProductForm-组件" class="headerlink" title="重构 ProductForm 组件"></a>重构 ProductForm 组件</h3><p>再次进入 <code>ProductForm</code> 组件中，我们尝试另一种方法来修复表单无法编辑的问题。</p>
<figure class="highlight html"><figcaption><span>src/components/products/ProductForm.vue</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvdnVlLW9ubGluZS1zaG9wLWZyb250ZW5kL2Jsb2IvMDJmNTc2MWZkYzU0MGEzY2YzZTA1NDliMmE0ZTNmNjE2YjRmMWE0OC9zcmMvY29tcG9uZW50cy9wcm9kdWN0cy9Qcm9kdWN0Rm9ybS52dWU=" title="https://github.com/tuture-dev/vue-online-shop-frontend/blob/02f5761fdc540a3cf3e0549b2a4e3f616b4f1a48/src/components/products/ProductForm.vue">查看完整代码<i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"productInfo"</span>&gt;</span></span><br><span class="line">[tuture-del]    <span class="tag">&lt;<span class="name">el-form</span> <span class="attr">class</span>=<span class="string">"form"</span> <span class="attr">ref</span>=<span class="string">"form"</span> <span class="attr">:model</span>=<span class="string">"model"</span> <span class="attr">label-width</span>=<span class="string">"180px"</span>&gt;</span></span><br><span class="line">[tuture-add]    <span class="tag">&lt;<span class="name">el-form</span> <span class="attr">class</span>=<span class="string">"form"</span> <span class="attr">ref</span>=<span class="string">"form"</span> <span class="attr">label-width</span>=<span class="string">"180px"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">"Name"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">"model.name"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      // ...</span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">"model.price"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">"Manufacturer "</span>&gt;</span></span><br><span class="line">[tuture-del]        <span class="tag">&lt;<span class="name">el-select</span> <span class="attr">v-model</span>=<span class="string">"model.manufacturer.name"</span> <span class="attr">clearable</span> <span class="attr">placeholder</span>=<span class="string">"请选择制造商"</span>&gt;</span></span><br><span class="line">[tuture-add]        <span class="tag">&lt;<span class="name">el-select</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]          <span class="attr">v-model</span>=<span class="string">"modelData.manufacturer.name"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]          <span class="attr">clearable</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]          <span class="attr">placeholder</span>=<span class="string">"请选择制造商"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]        &gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-option</span></span></span><br><span class="line"><span class="tag">            <span class="attr">v-for</span>=<span class="string">"manufacturer in manufacturers"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">:key</span>=<span class="string">"manufacturer._id"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">:label</span>=<span class="string">"manufacturer.name"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-del</span>]            <span class="attr">:value</span>=<span class="string">"manufacturer.name"</span>&gt;</span></span><br><span class="line">[tuture-add]            :value="manufacturer.name"</span><br><span class="line">[tuture-add]          &gt;</span><br><span class="line">          <span class="tag">&lt;/<span class="name">el-option</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-select</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      // ...</span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">type</span>=<span class="string">"textarea"</span> <span class="attr">v-model</span>=<span class="string">"model.description"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">[tuture-del]        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">v-if</span>=<span class="string">"isEditing"</span> <span class="attr">type</span>=<span class="string">"primary"</span> @<span class="attr">click</span>=<span class="string">"onSubmit"</span>&gt;</span>Update Product<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">[tuture-add]        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">v-if</span>=<span class="string">"isEditing"</span> <span class="attr">type</span>=<span class="string">"primary"</span> @<span class="attr">click</span>=<span class="string">"onSubmit"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]          &gt;</span>Update Product<span class="tag">&lt;/<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]        &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">v-else</span> @<span class="attr">click</span>=<span class="string">"onSubmit"</span>&gt;</span>Add Product<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line">  // ...</span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span> --&gt;</span><br><span class="line"></span><br><span class="line">[tuture-del]    <span class="comment">&lt;!-- &lt;div class="col-lg-4 col-md-4 col-sm-12 col-xs-12"&gt;</span></span><br><span class="line"><span class="comment">[tuture-add]  &lt;!-- &lt;div class="col-lg-4 col-md-4 col-sm-12 col-xs-12"&gt;</span></span><br><span class="line"><span class="comment">      &lt;div class="form-group"&gt;</span></span><br><span class="line"><span class="comment">        &lt;label&gt;Image&lt;/label&gt;</span></span><br><span class="line"><span class="comment">        &lt;input</span></span><br><span class="line"><span class="comment">          // ...</span></span><br><span class="line"><span class="comment">      &lt;div class="form-group new-button"&gt;</span></span><br><span class="line"><span class="comment">        &lt;button class="button"&gt;</span></span><br><span class="line"><span class="comment">          &lt;i class="fa fa-pencil"&gt;&lt;/i&gt; --&gt;</span></span><br><span class="line">[tuture-del]          <span class="comment">&lt;!-- Conditional rendering for input text --&gt;</span></span><br><span class="line">[tuture-del]          <span class="comment">&lt;!-- &lt;span v-if="isEditing"&gt;Update Product&lt;/span&gt;</span></span><br><span class="line"><span class="comment">[tuture-add]  &lt;!-- Conditional rendering for input text --&gt;</span></span><br><span class="line">[tuture-add]  <span class="comment">&lt;!-- &lt;span v-if="isEditing"&gt;Update Product&lt;/span&gt;</span></span><br><span class="line"><span class="comment">          &lt;span v-else&gt;Add Product&lt;/span&gt;</span></span><br><span class="line"><span class="comment">        &lt;/button&gt;</span></span><br><span class="line"><span class="comment">      &lt;/div&gt;</span></span><br><span class="line"><span class="comment">    // ...</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">&lt;script&gt;</span></span><br><span class="line"><span class="comment">export default &#123;</span></span><br><span class="line"><span class="comment">[tuture-del]  props: ['model', 'manufacturers', 'isEditing'],</span></span><br><span class="line"><span class="comment">[tuture-add]  data() &#123;</span></span><br><span class="line"><span class="comment">[tuture-add]    return &#123;</span></span><br><span class="line"><span class="comment">[tuture-add]      modelData: &#123; manufacturer: &#123; name: "" &#125; &#125;</span></span><br><span class="line"><span class="comment">[tuture-add]    &#125;;</span></span><br><span class="line"><span class="comment">[tuture-add]  &#125;,</span></span><br><span class="line"><span class="comment">[tuture-add]  props: ["model", "manufacturers", "isEditing"],</span></span><br><span class="line"><span class="comment">  created() &#123;</span></span><br><span class="line"><span class="comment">[tuture-del]    console.log(this.model)</span></span><br><span class="line"><span class="comment">[tuture-add]    const product = this.model;</span></span><br><span class="line"><span class="comment">[tuture-add] </span></span><br><span class="line"><span class="comment">[tuture-add]    this.modelData = &#123; ...product, manufacturer: &#123; ...product.manufacturer &#125; &#125;;</span></span><br><span class="line"><span class="comment">[tuture-add]  &#125;,</span></span><br><span class="line"><span class="comment">[tuture-add]  watch: &#123;</span></span><br><span class="line"><span class="comment">[tuture-add]    model(val, oldVal) &#123;</span></span><br><span class="line"><span class="comment">[tuture-add]      this.modelData = val;</span></span><br><span class="line"><span class="comment">[tuture-add]    &#125;</span></span><br><span class="line"><span class="comment">  &#125;,</span></span><br><span class="line"><span class="comment">  methods: &#123;</span></span><br><span class="line"><span class="comment">    onSubmit() &#123;</span></span><br><span class="line"><span class="comment">[tuture-del]      this.$emit('save-product', this.model)</span></span><br><span class="line"><span class="comment">[tuture-add]      this.$emit("save-product", this.modelData);</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">  &#125;</span></span><br><span class="line"><span class="comment">[tuture-del]&#125;</span></span><br><span class="line"><span class="comment">[tuture-add]&#125;;</span></span><br><span class="line"><span class="comment">&lt;/script&gt;</span></span><br><span class="line"><span class="comment">&lt;style&gt;</span></span><br><span class="line"><span class="comment">.productInfo &#123;</span></span><br><span class="line"><span class="comment">  // ...</span></span><br></pre></td></tr></table></figure>

<p>这里我们没有直接使用从父组件获取的 <code>model</code> 对象作为表单数据对象，而是在该组件中自定义一个 <code>modelData</code> 对象，并使用默认初始形式。然后在组件刚被创建时，先将从父组件获取的 <code>model</code> 对象赋值给一个临时变量 <code>product</code>，然后将 <code>product</code> 浅拷贝到 <code>modelData</code> 对象中，这样就避免了表单数据对象使用计算属性。但是这仅仅完成了一半的工作，因为我们需要实现双向绑定的效果，因此我们需要监测表单组件的变化，通过使用 <code>watch</code> 方法监测用户的输入，然后将新数据储存到 <code>modelData</code> 对象中，这样就成功实现了双向绑定，而且表单也能随意进行编辑。</p>
<p>但是这里我们仅仅在下拉菜单中使用了 <code>modelData</code> 对象进行尝试，因此后面我们会在整个表单内组件使用该对象。</p>
<h3 id="小结-1"><a href="#小结-1" class="headerlink" title="小结"></a>小结</h3><p>这一节我们主要带大家修复了 <code>element-ui</code> 表单双向绑定问题，通过自定义 <code>modelData</code> 对象以及 <code>watch</code> 方法监测表单数据的改变实现了表单数据的双向绑定，并且解决了表单无法编辑的问题。但是仅仅在下拉菜单中进行尝试，后面我们会重构整个商品信息表单组件。</p>
<h2 id="完善表单双向绑定问题"><a href="#完善表单双向绑定问题" class="headerlink" title="完善表单双向绑定问题"></a>完善表单双向绑定问题</h2><h3 id="重构-ProductForm-组件-1"><a href="#重构-ProductForm-组件-1" class="headerlink" title="重构 ProductForm 组件"></a>重构 ProductForm 组件</h3><p>再次进入 <code>ProductForm</code> 组件，我们需要完善上一节遗留的问题，也就是仅仅对商品信息表单中的下拉菜单进行了尝试，并且尝试成功，因此这一节我们需要将 <code>modelData</code> 对象导入所有表单内组件中，解决其他表单内组件无法编辑的问题。</p>
<figure class="highlight html"><figcaption><span>src/components/products/ProductForm.vue</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvdnVlLW9ubGluZS1zaG9wLWZyb250ZW5kL2Jsb2IvNWM3NjY2YzFmNjZiMjg4ZjJjMDJiMDRjOTY0YzUzNzkxYmE0ZWNiNS9zcmMvY29tcG9uZW50cy9wcm9kdWN0cy9Qcm9kdWN0Rm9ybS52dWU=" title="https://github.com/tuture-dev/vue-online-shop-frontend/blob/5c7666c1f66b288f2c02b04c964c53791ba4ecb5/src/components/products/ProductForm.vue">查看完整代码<i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"productInfo"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form</span> <span class="attr">class</span>=<span class="string">"form"</span> <span class="attr">ref</span>=<span class="string">"form"</span> <span class="attr">label-width</span>=<span class="string">"180px"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">"Name"</span>&gt;</span></span><br><span class="line">[tuture-del]        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">"model.name"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">[tuture-add]        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">"modelData.name"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">"Price"</span>&gt;</span></span><br><span class="line">[tuture-del]        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">"model.price"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">[tuture-add]        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">"modelData.price"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">"Manufacturer "</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-select</span></span></span><br><span class="line"><span class="tag">          // <span class="attr">...</span></span></span><br><span class="line">        &lt;/el-select&gt;</span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">"Image "</span>&gt;</span></span><br><span class="line">[tuture-del]        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">"model.image"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">[tuture-add]        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">"modelData.image"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">"Description "</span>&gt;</span></span><br><span class="line">[tuture-del]        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">type</span>=<span class="string">"textarea"</span> <span class="attr">v-model</span>=<span class="string">"model.description"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">[tuture-add]        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">type</span>=<span class="string">"textarea"</span> <span class="attr">v-model</span>=<span class="string">"modelData.description"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      // ...</span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  // ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"> // ...</span><br></pre></td></tr></table></figure>

<h3 id="小结-2"><a href="#小结-2" class="headerlink" title="小结"></a>小结</h3><p>这一节我们带大家补充了上一节遗留的问题，也就是复制下拉菜单中的尝试到其他表单内组件中，保证整个表单组件都能够顺利地实现编辑功能。</p>
<h2 id="解决操作商品信息表单报错问题"><a href="#解决操作商品信息表单报错问题" class="headerlink" title="解决操作商品信息表单报错问题"></a>解决操作商品信息表单报错问题</h2><h3 id="重构-ProductForm-组件-2"><a href="#重构-ProductForm-组件-2" class="headerlink" title="重构 ProductForm 组件"></a>重构 ProductForm 组件</h3><p>相信大家在对商品信息表单进行添加或者修改操作时，控制台会出现 <code>id</code> 属性未定义的错误，我们首先应该进入报错的组件中进行调试，大家应该都看到了报错信息出现在 <code>ProductForm</code> 组件中，因此我们需要进入 <code>ProductForm</code> 组件进行调试。</p>
<figure class="highlight html"><figcaption><span>src/components/products/ProductForm.vue</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvdnVlLW9ubGluZS1zaG9wLWZyb250ZW5kL2Jsb2IvMTExMThjMzY0ZGQ4YzNiYmUwMzgwMDc1Zjk4MDc2NzQxN2VjMWYzMy9zcmMvY29tcG9uZW50cy9wcm9kdWN0cy9Qcm9kdWN0Rm9ybS52dWU=" title="https://github.com/tuture-dev/vue-online-shop-frontend/blob/11118c364dd8c3bbe0380075f980767417ec1f33/src/components/products/ProductForm.vue">查看完整代码<i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line">// ...</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="actionscript">  <span class="comment">// ...</span></span></span><br><span class="line"><span class="actionscript">  props: [<span class="string">"model"</span>, <span class="string">"manufacturers"</span>, <span class="string">"isEditing"</span>],</span></span><br><span class="line">  created() &#123;</span><br><span class="line"><span class="actionscript">    <span class="keyword">const</span> product = <span class="keyword">this</span>.model;</span></span><br><span class="line">[tuture-del] </span><br><span class="line"><span class="actionscript">    <span class="keyword">this</span>.modelData = &#123; ...product, manufacturer: &#123; ...product.manufacturer &#125; &#125;;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  watch: &#123;</span><br><span class="line"><span class="actionscript">    <span class="comment">// ...</span></span></span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    onSubmit() &#123;</span><br><span class="line"><span class="javascript">[tuture-add]      <span class="keyword">const</span> manufacturer = <span class="keyword">this</span>.manufacturers.find(<span class="function"><span class="params">item</span> =&gt;</span> item.name === <span class="keyword">this</span>.modelData.manufacturer.name);</span></span><br><span class="line"><span class="actionscript">[tuture-add]      <span class="keyword">this</span>.modelData.manufacturer = manufacturer;</span></span><br><span class="line"><span class="actionscript">      <span class="keyword">this</span>.$emit(<span class="string">"save-product"</span>, <span class="keyword">this</span>.modelData);</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">// ...</span><br></pre></td></tr></table></figure>

<p>首先大家应该清楚商品对象中还包含了相应的制造商对象，并且制造商对象中包含了 <code>id</code> 属性和 <code>name</code> 属性。但是我们应该可以发现商品信息表单中的下拉菜单双向绑定的是商品对象中的制造商对象的 <code>name</code> 属性，因此在 <code>watch</code> 方法中存储到 <code>modelData</code> 对象中的制造商对象也只有 <code>name</code> 属性，但是后端数据库要求制造商对象必须也要有 <code>id</code> 属性，这就是我们点击更新商品信息出现报错的原因。</p>
<p>这里我们使用了本地制造商数组的 <code>find</code> 方法，检索到了对应 <code>name</code> 的制造商对象并将其覆盖掉 <code>modelData</code> 对象中的制造商对象，这样我们的 <code>modelData</code> 对象中的制造商对象就是一个符合后端数据库要求的对象了。</p>
<h3 id="小结-3"><a href="#小结-3" class="headerlink" title="小结"></a>小结</h3><p>这一节我们带大家分析并尝试解决了操作商品信息表单出现 <code>id</code> 属性未定义的问题。</p>
<h2 id="添加动态效果及消息提示"><a href="#添加动态效果及消息提示" class="headerlink" title="添加动态效果及消息提示"></a>添加动态效果及消息提示</h2><p>我们注意到了当用户进行添加或修改商品或者制造商信息时，难免会遇到更新延迟的问题，这个时候如果页面毫无反馈会显得些许尴尬，因此我们认为只要用户进行添加或者修改操作，在后端数据同步完成之前我们为页面添加一个动态加载的效果，给用户一个反馈表示数据正在处理中，请耐心等待；并且在后端同步完成之后为页面添加一个消息提示，给用户一个反馈表示数据处理成功，这样就避免了尴尬的场面，提高了用户的交互体验。</p>
<h3 id="实现-loading-动态加载效果"><a href="#实现-loading-动态加载效果" class="headerlink" title="实现 loading 动态加载效果"></a>实现 loading 动态加载效果</h3><p>再次进入 <code>ManufactureForm</code> 组件，实现用户在添加或者修改制造商信息时且当后端数据同步完成之前，页面出现 <code>loading</code>动态加载效果。</p>
<figure class="highlight html"><figcaption><span>src/components/ManufacturerForm.vue</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvdnVlLW9ubGluZS1zaG9wLWZyb250ZW5kL2Jsb2IvMzhjYWY2ZDQ3ZDQwNzc2ZDA3M2Y1MTdlYTdmZjI1YzllMjFiMGE4Yi9zcmMvY29tcG9uZW50cy9NYW51ZmFjdHVyZXJGb3JtLnZ1ZQ==" title="https://github.com/tuture-dev/vue-online-shop-frontend/blob/38caf6d47d40776d073f517ea7ff25c9e21b0a8b/src/components/ManufacturerForm.vue">查看完整代码<i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"manufacturerInfo"</span>&gt;</span></span><br><span class="line">[tuture-del]    <span class="tag">&lt;<span class="name">el-form</span> <span class="attr">class</span>=<span class="string">"form"</span> <span class="attr">ref</span>=<span class="string">"form"</span> <span class="attr">:model</span>=<span class="string">"model"</span> <span class="attr">label-width</span>=<span class="string">"180px"</span>&gt;</span></span><br><span class="line">[tuture-add]    <span class="tag">&lt;<span class="name">el-form</span> </span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]    <span class="attr">class</span>=<span class="string">"form"</span> </span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]    <span class="attr">ref</span>=<span class="string">"form"</span> </span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]    <span class="attr">label-width</span>=<span class="string">"180px"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]    <span class="attr">v-loading</span>=<span class="string">"loading"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]    <span class="attr">element-loading-text</span>=<span class="string">"拼命加载中"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]    <span class="attr">element-loading-spinner</span>=<span class="string">"el-icon-loading"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]    <span class="attr">element-loading-background</span>=<span class="string">"rgba(0, 0, 0, 0.8)"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">"Name"</span>&gt;</span></span><br><span class="line">[tuture-del]        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">"model.name"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">[tuture-add]        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">"manufacturerData.name"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">[tuture-del]        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">v-if</span>=<span class="string">"isEditing"</span> <span class="attr">type</span>=<span class="string">"primary"</span> @<span class="attr">click</span>=<span class="string">"onSubmit"</span>&gt;</span>Update Manufacturer<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">[tuture-add]        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">v-if</span>=<span class="string">"isEditing"</span> <span class="attr">type</span>=<span class="string">"primary"</span> <span class="attr">native-type</span>=<span class="string">"submit"</span> @<span class="attr">click</span>=<span class="string">"onSubmit"</span>&gt;</span>Update Manufacturer<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">v-else</span> @<span class="attr">click</span>=<span class="string">"onSubmit"</span>&gt;</span>Add Manufacturer<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  // ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="actionscript">  props: [<span class="string">'model'</span>, <span class="string">'isEditing'</span>],</span></span><br><span class="line">[tuture-add]  data() &#123;</span><br><span class="line"><span class="actionscript">[tuture-add]    <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="actionscript">[tuture-add]      manufacturerData: &#123;name: <span class="string">''</span>&#125;</span></span><br><span class="line">[tuture-add]    &#125;</span><br><span class="line">[tuture-add]  &#125;,</span><br><span class="line">[tuture-add]  created() &#123;</span><br><span class="line"><span class="actionscript">[tuture-add]    <span class="keyword">this</span>.manufacturerData = <span class="keyword">this</span>.model</span></span><br><span class="line">[tuture-add]  &#125;,</span><br><span class="line">[tuture-add]  watch: &#123;</span><br><span class="line">[tuture-add]    model(val, oldVal) &#123;</span><br><span class="line"><span class="actionscript">[tuture-add]      <span class="keyword">this</span>.manufacturerData = val;</span></span><br><span class="line">[tuture-add]    &#125;</span><br><span class="line">[tuture-add]  &#125;,</span><br><span class="line">[tuture-add]  computed: &#123;</span><br><span class="line">[tuture-add]    loading() &#123;</span><br><span class="line"><span class="actionscript">[tuture-add]      <span class="keyword">return</span> <span class="keyword">this</span>.$store.state.showLoader</span></span><br><span class="line">[tuture-add]    &#125;</span><br><span class="line">[tuture-add]  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    onSubmit() &#123;</span><br><span class="line"><span class="actionscript">[tuture-del]      <span class="keyword">this</span>.$emit(<span class="string">'save-manufacturer'</span>, <span class="keyword">this</span>.model)</span></span><br><span class="line"><span class="actionscript">[tuture-add]      <span class="keyword">this</span>.$emit(<span class="string">'save-manufacturer'</span>, <span class="keyword">this</span>.manufacturerData);</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">// ...</span><br></pre></td></tr></table></figure>

<p>首先我们在该组件中使用了 <code>element-ui</code> 组件库提供的自定义指令 <code>v-loading</code>，通过判断 <code>loading</code> 为true还是false来决定是否实现动态加载效果。这里我们通过获取本地状态中的 <code>showLoader</code> 属性作为 <code>loading</code> 属性值，因为在用户刚进行添加或修改操作时，向后端发起数据请求，此时本地状态中的 <code>showLoader</code> 属性值为true，当成功获取到了数据响应之后，也就是后端数据同步完成，此时 <code>showLoader</code> 属性值为false，这样就实现了在指定时间显示动态加载效果；除此之外，我们还按照 <code>ProductForm</code> 组件补充修改了数据处理，解决制造商表单组件编辑问题。</p>
<p>同样进入 <code>ProductForm</code> 组件进行修改，实现用户在添加或修改商品信息时，且当后端数据同步完成之前，页面出现 <code>loading</code> 动态加载效果。</p>
<figure class="highlight html"><figcaption><span>src/components/products/ProductForm.vue</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvdnVlLW9ubGluZS1zaG9wLWZyb250ZW5kL2Jsb2IvMzhjYWY2ZDQ3ZDQwNzc2ZDA3M2Y1MTdlYTdmZjI1YzllMjFiMGE4Yi9zcmMvY29tcG9uZW50cy9wcm9kdWN0cy9Qcm9kdWN0Rm9ybS52dWU=" title="https://github.com/tuture-dev/vue-online-shop-frontend/blob/38caf6d47d40776d073f517ea7ff25c9e21b0a8b/src/components/products/ProductForm.vue">查看完整代码<i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"productInfo"</span>&gt;</span></span><br><span class="line">[tuture-del]    <span class="tag">&lt;<span class="name">el-form</span> <span class="attr">class</span>=<span class="string">"form"</span> <span class="attr">ref</span>=<span class="string">"form"</span> <span class="attr">label-width</span>=<span class="string">"180px"</span>&gt;</span></span><br><span class="line">[tuture-add]    <span class="tag">&lt;<span class="name">el-form</span> </span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]    <span class="attr">class</span>=<span class="string">"form"</span> </span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]    <span class="attr">ref</span>=<span class="string">"form"</span> </span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]    <span class="attr">label-width</span>=<span class="string">"180px"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]    <span class="attr">v-loading</span>=<span class="string">"loading"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]    <span class="attr">element-loading-text</span>=<span class="string">"拼命加载中"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]    <span class="attr">element-loading-spinner</span>=<span class="string">"el-icon-loading"</span></span></span><br><span class="line"><span class="tag">[<span class="attr">tuture-add</span>]    <span class="attr">element-loading-background</span>=<span class="string">"rgba(0, 0, 0, 0.8)"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">"Name"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">"modelData.name"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      // ...</span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">type</span>=<span class="string">"textarea"</span> <span class="attr">v-model</span>=<span class="string">"modelData.description"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">[tuture-del]        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">v-if</span>=<span class="string">"isEditing"</span> <span class="attr">type</span>=<span class="string">"primary"</span> @<span class="attr">click</span>=<span class="string">"onSubmit"</span></span></span><br><span class="line">[tuture-add]        &lt;el-button v-if="isEditing" type="primary" native-type="submit" @click="onSubmit"</span><br><span class="line">          &gt;Update Product<span class="tag">&lt;/<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">        &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">v-else</span> @<span class="attr">click</span>=<span class="string">"onSubmit"</span>&gt;</span>Add Product<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">      // ...</span><br><span class="line">      this.modelData = val;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">[tuture-add]  computed: &#123;</span><br><span class="line">[tuture-add]    loading() &#123;</span><br><span class="line">[tuture-add]      return this.$store.state.showLoader</span><br><span class="line">[tuture-add]    &#125;</span><br><span class="line">[tuture-add]  &#125;,</span><br><span class="line">[tuture-add]  // updated() &#123;</span><br><span class="line">[tuture-add]  //   // 等待后端完成商品信息的同步更新，设置loading为false</span><br><span class="line">[tuture-add]  //   const newProductName = this.$store.getters.productById(this.model._id);</span><br><span class="line">[tuture-add]  //   const isLoaded = this.modelData.name === newProductName;</span><br><span class="line">[tuture-add]  //   if(isLoaded) &#123;</span><br><span class="line">[tuture-add]  //     this.loading = false;</span><br><span class="line">[tuture-add]  //   &#125;</span><br><span class="line">[tuture-add]  // &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    onSubmit() &#123;</span><br><span class="line">[tuture-add]      // 由于表单中只绑定了modelData.manufacturer.name，</span><br><span class="line">[tuture-add]      // 缺少manufacturer._id,但是后端需要manufacturer整个对象,</span><br><span class="line">[tuture-add]      // 所以需要将manufacturers中对应的manufacturer找出并覆盖到modelData中</span><br><span class="line">      const manufacturer = this.manufacturers.find(item =&gt; item.name === this.modelData.manufacturer.name);</span><br><span class="line">      this.modelData.manufacturer = manufacturer;</span><br><span class="line">[tuture-add]      </span><br><span class="line">      this.$emit("save-product", this.modelData);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">// ...</span><br></pre></td></tr></table></figure>

<h3 id="实现消息提示功能"><a href="#实现消息提示功能" class="headerlink" title="实现消息提示功能"></a>实现消息提示功能</h3><p>首先进入 <code>actions.js</code> 文件进行修改，由于发送网络请求数据的操作在该文件中执行，因此我们可以将消息提示功能添加到这里。</p>
<figure class="highlight js"><figcaption><span>src/store/actions.js</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvdnVlLW9ubGluZS1zaG9wLWZyb250ZW5kL2Jsb2IvMzhjYWY2ZDQ3ZDQwNzc2ZDA3M2Y1MTdlYTdmZjI1YzllMjFiMGE4Yi9zcmMvc3RvcmUvYWN0aW9ucy5qcw==" title="https://github.com/tuture-dev/vue-online-shop-frontend/blob/38caf6d47d40776d073f517ea7ff25c9e21b0a8b/src/store/actions.js">查看完整代码<i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="comment">// ...</span></span><br><span class="line">[tuture-add]<span class="keyword">import</span> &#123; Message &#125; <span class="keyword">from</span> <span class="string">'element-ui'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> productActions = &#123;</span><br><span class="line">  allProducts(&#123; commit &#125;) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;,</span><br><span class="line">  productById(&#123; commit &#125;, payload) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;,</span><br><span class="line">  removeProduct(&#123; commit &#125;, payload) &#123;</span><br><span class="line">    commit(REMOVE_PRODUCT);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> &#123; productId &#125; = payload;</span><br><span class="line">[tuture-del]    axios.delete(<span class="string">`<span class="subst">$&#123;API_BASE&#125;</span>/products/<span class="subst">$&#123;productId&#125;</span>`</span>).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">[tuture-add]    axios.delete(<span class="string">`<span class="subst">$&#123;API_BASE&#125;</span>/products/<span class="subst">$&#123;productId&#125;</span>`</span>)</span><br><span class="line">[tuture-add]    .then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 返回 productId，用于删除本地对应的商品</span></span><br><span class="line">      commit(REMOVE_PRODUCT_SUCCESS, &#123;</span><br><span class="line">        productId,</span><br><span class="line">      &#125;);</span><br><span class="line">[tuture-add]      Message(&#123;</span><br><span class="line">[tuture-add]        message: <span class="string">'恭喜你，商品删除成功！'</span>,</span><br><span class="line">[tuture-add]        type: <span class="string">'success'</span></span><br><span class="line">[tuture-add]      &#125;)</span><br><span class="line">[tuture-add]    &#125;)</span><br><span class="line">[tuture-add]    .catch(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">[tuture-add]      Message.error(<span class="string">'不好意思，商品删除失败！'</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  updateProduct(&#123; commit &#125;, payload) &#123;</span><br><span class="line">    commit(UPDATE_PRODUCT);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> &#123; product &#125; = payload;</span><br><span class="line">[tuture-del]    axios.put(<span class="string">`<span class="subst">$&#123;API_BASE&#125;</span>/products/<span class="subst">$&#123;product._id&#125;</span>`</span>, product).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">[tuture-add]    axios.put(<span class="string">`<span class="subst">$&#123;API_BASE&#125;</span>/products/<span class="subst">$&#123;product._id&#125;</span>`</span>, product)</span><br><span class="line">[tuture-add]    .then(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">      commit(UPDATE_PRODUCT_SUCCESS, &#123;</span><br><span class="line">[tuture-del]        product,</span><br><span class="line">[tuture-add]        product: response.data,</span><br><span class="line">      &#125;);</span><br><span class="line">[tuture-add]      Message(&#123;</span><br><span class="line">[tuture-add]        message: <span class="string">'恭喜你，商品更新成功！'</span>,</span><br><span class="line">[tuture-add]        type: <span class="string">'success'</span></span><br><span class="line">[tuture-add]      &#125;)</span><br><span class="line">[tuture-add]    &#125;)</span><br><span class="line">[tuture-add]    .catch(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">[tuture-add]      Message.error(<span class="string">'不好意思，商品更新失败！'</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  addProduct(&#123; commit &#125;, payload) &#123;</span><br><span class="line">    commit(ADD_PRODUCT);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> &#123; product &#125; = payload;</span><br><span class="line">[tuture-del]    axios.post(<span class="string">`<span class="subst">$&#123;API_BASE&#125;</span>/products`</span>, product).then(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">[tuture-add]    axios.post(<span class="string">`<span class="subst">$&#123;API_BASE&#125;</span>/products`</span>, product)</span><br><span class="line">[tuture-add]    .then(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">      commit(ADD_PRODUCT_SUCCESS, &#123;</span><br><span class="line">        product: response.data,</span><br><span class="line">      &#125;)</span><br><span class="line">[tuture-del]      <span class="built_in">console</span>.log(response.data);</span><br><span class="line">[tuture-add]      Message(&#123;</span><br><span class="line">[tuture-add]        message: <span class="string">'恭喜你，商品添加成功！'</span>,</span><br><span class="line">[tuture-add]        type: <span class="string">'success'</span></span><br><span class="line">[tuture-add]      &#125;)</span><br><span class="line">[tuture-add]    &#125;)</span><br><span class="line">[tuture-add]    .catch(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">[tuture-add]      Message.error(<span class="string">'不好意思，商品添加失败！'</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"> <span class="comment">// ...</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> manufacturerActions = &#123;</span><br><span class="line">  allManufacturers(&#123; commit &#125;) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;,</span><br><span class="line">  manufacturerById(&#123; commit &#125;, payload) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;,</span><br><span class="line">  removeManufacturer(&#123; commit &#125;, payload) &#123;</span><br><span class="line">    commit(REMOVE_MANUFACTURER);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> &#123; manufacturerId &#125; = payload;</span><br><span class="line">[tuture-del]    axios.delete(<span class="string">`<span class="subst">$&#123;API_BASE&#125;</span>/manufacturers/<span class="subst">$&#123;manufacturerId&#125;</span>`</span>).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">[tuture-add]    axios.delete(<span class="string">`<span class="subst">$&#123;API_BASE&#125;</span>/manufacturers/<span class="subst">$&#123;manufacturerId&#125;</span>`</span>)</span><br><span class="line">[tuture-add]    .then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 返回 manufacturerId，用于删除本地对应的制造商</span></span><br><span class="line">      commit(REMOVE_MANUFACTURER_SUCCESS, &#123;</span><br><span class="line">        manufacturerId,</span><br><span class="line">      &#125;);</span><br><span class="line">[tuture-add]      Message(&#123;</span><br><span class="line">[tuture-add]        message: <span class="string">'恭喜你，制造商删除成功！'</span>,</span><br><span class="line">[tuture-add]        type: <span class="string">'success'</span></span><br><span class="line">[tuture-add]      &#125;)</span><br><span class="line">[tuture-add]    &#125;)</span><br><span class="line">[tuture-add]    .catch(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">[tuture-add]      Message.error(<span class="string">'不好意思，制造商删除失败！'</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  updateManufacturer(&#123; commit &#125;, payload) &#123;</span><br><span class="line">    commit(UPDATE_MANUFACTURER);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> &#123; manufacturer &#125; = payload;</span><br><span class="line">[tuture-del]    axios.put(<span class="string">`<span class="subst">$&#123;API_BASE&#125;</span>/manufacturers/<span class="subst">$&#123;manufacturer._id&#125;</span>`</span>, manufacturer).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">[tuture-add]    axios.put(<span class="string">`<span class="subst">$&#123;API_BASE&#125;</span>/manufacturers/<span class="subst">$&#123;manufacturer._id&#125;</span>`</span>, manufacturer)</span><br><span class="line">[tuture-add]    .then(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">      commit(UPDATE_MANUFACTURER_SUCCESS, &#123;</span><br><span class="line">[tuture-del]        manufacturer,</span><br><span class="line">[tuture-add]        manufacturer: response.data,</span><br><span class="line">      &#125;);</span><br><span class="line">[tuture-add]      Message(&#123;</span><br><span class="line">[tuture-add]        message: <span class="string">'恭喜你，制造商更新成功！'</span>,</span><br><span class="line">[tuture-add]        type: <span class="string">'success'</span></span><br><span class="line">[tuture-add]      &#125;)</span><br><span class="line">[tuture-add]    &#125;)</span><br><span class="line">[tuture-add]    .catch(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">[tuture-add]      Message.error(<span class="string">'不好意思，制造商更新失败！'</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  addManufacturer(&#123; commit &#125;, payload) &#123;</span><br><span class="line">    commit(ADD_MANUFACTURER);</span><br><span class="line">[tuture-del] </span><br><span class="line">    <span class="keyword">const</span> &#123; manufacturer &#125; = payload;</span><br><span class="line">[tuture-del]    axios.post(<span class="string">`<span class="subst">$&#123;API_BASE&#125;</span>/manufacturers`</span>, manufacturer).then(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">[tuture-add]    axios.post(<span class="string">`<span class="subst">$&#123;API_BASE&#125;</span>/manufacturers`</span>, manufacturer)</span><br><span class="line">[tuture-add]    .then(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">      commit(ADD_MANUFACTURER_SUCCESS, &#123;</span><br><span class="line">        manufacturer: response.data,</span><br><span class="line">[tuture-add]      &#125;);</span><br><span class="line">[tuture-add]      Message(&#123;</span><br><span class="line">[tuture-add]        message: <span class="string">'恭喜你，制造商添加成功！'</span>,</span><br><span class="line">[tuture-add]        type: <span class="string">'success'</span></span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">[tuture-add]    .catch(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">[tuture-add]      Message.error(<span class="string">'不好意思，制造商添加失败！'</span>);</span><br><span class="line">[tuture-add]    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里我们首先导入了 <code>element-ui</code> 组件库提供的 <code>Message</code> 消息提示组件，并在网络请求成功之后添加成功消息提醒，在请求失败之后添加失败消息提醒。</p>
<p>然后进入 <code>mutations.js</code> 文件进行修改，这里的修改是为本地购物车数据处理添加消息提示。</p>
<figure class="highlight js"><figcaption><span>src/store/mutations.js</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvdnVlLW9ubGluZS1zaG9wLWZyb250ZW5kL2Jsb2IvMzhjYWY2ZDQ3ZDQwNzc2ZDA3M2Y1MTdlYTdmZjI1YzllMjFiMGE4Yi9zcmMvc3RvcmUvbXV0YXRpb25zLmpz" title="https://github.com/tuture-dev/vue-online-shop-frontend/blob/38caf6d47d40776d073f517ea7ff25c9e21b0a8b/src/store/mutations.js">查看完整代码<i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="comment">// ...</span></span><br><span class="line">[tuture-add]<span class="keyword">import</span> &#123; Message &#125; <span class="keyword">from</span> <span class="string">'element-ui'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> cartMutations = &#123;</span><br><span class="line">  [ADD_TO_CART](state, payload) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; product &#125; = payload;</span><br><span class="line">[tuture-del]    state.cart.push(product)</span><br><span class="line">[tuture-add]    state.cart.push(product);</span><br><span class="line">[tuture-add]    Message(&#123;</span><br><span class="line">[tuture-add]      message: <span class="string">'恭喜你，成功加入购物车！'</span>,</span><br><span class="line">[tuture-add]      type: <span class="string">'success'</span></span><br><span class="line">[tuture-add]    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  [REMOVE_FROM_CART](state, payload) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; productId &#125; = payload</span><br><span class="line">    state.cart = state.cart.filter(<span class="function"><span class="params">product</span> =&gt;</span> product._id !== productId)</span><br><span class="line">[tuture-add]    Message(&#123;</span><br><span class="line">[tuture-add]      message: <span class="string">'恭喜你，成功移除购物车！'</span>,</span><br><span class="line">[tuture-add]      type: <span class="string">'success'</span></span><br><span class="line">[tuture-add]    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></table></figure>

<p>同样的我们首先需要导入 <code>element-ui</code> 组件库提供的 <code>Message</code> 消息提示组件，当用户进行添加或者移除购物车操作时，执行操作成功消息提醒。</p>
<p>我们在进行添加、删除、修改以及加入或移除购物车操作时都会得到这样的反馈：</p>
<p><img alt data-src="https://static.powerformer.com/c/092faf4/170bd8414598aa64.png"></p>
<h3 id="小结-4"><a href="#小结-4" class="headerlink" title="小结"></a>小结</h3><p>这一节我们主要做的几点工作：</p>
<ul>
<li>为表单组件添加 <code>element-ui</code> 组件库提供的 <code>v-loading</code> 指令，实现动态加载效果；</li>
<li>添加了 <code>element-ui</code> 组件库提供的 <code>Message</code> 消息提示组件，实现用户操作表单信息后得到的反馈消息提示。</li>
</ul>
<h2 id="解决表单信息修改后无法显示最新"><a href="#解决表单信息修改后无法显示最新" class="headerlink" title="解决表单信息修改后无法显示最新"></a>解决表单信息修改后无法显示最新</h2><p>重构到这里相信有些朋友已经迫不及待地将项目跑起来了，但是总是事与愿违，但是大家丝毫不用方，只要您跟着我们一步一步脚踏实地地去分析问题，那么什么问题都会迎刃而解了。现在的问题就是当用户对商品或者制造商进行信息修改时，点击更新之后表单却又显示了旧信息。</p>
<p>大家遇到的状况应该是这样：</p>
<p><img alt data-src="https://static.powerformer.com/c/092faf4/170bd845ae228eb9.png"></p>
<p><img alt data-src="https://static.powerformer.com/c/092faf4/170bd848f59fad3b.png"></p>
<p>数据出现问题我们应该根据 </p>
<p><code>vue</code></p>
<p> 的单向数据流原则进行调试，当用户对表单信息进行更新时，应该首先向后端发起网络请求，然后将最新数据同步到本地状态中进行展示，因此我们来到 </p>
<p><code>actions.js</code></p>
<p> 文件中进行调试。</p>
<h3 id="提交最新数据"><a href="#提交最新数据" class="headerlink" title="提交最新数据"></a>提交最新数据</h3><p>再次进入 <code>actions.js</code> 文件进行调试，我们可以大胆的猜测网络请求成功之后提交到 <code>mutations.js</code> 文件中的数据对象不是用户修改的最新数据。</p>
<figure class="highlight js"><figcaption><span>src/store/actions.js</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvdnVlLW9ubGluZS1zaG9wLWZyb250ZW5kL2Jsb2IvYWEyMzc3NWQ2NDIzNzM0MTNhYTUxYjk3YmMzZTc5MTVhYzllMjA5NS9zcmMvc3RvcmUvYWN0aW9ucy5qcw==" title="https://github.com/tuture-dev/vue-online-shop-frontend/blob/aa23775d642373413aa51b97bc3e7915ac9e2095/src/store/actions.js">查看完整代码<i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> productActions = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  updateProduct(&#123; commit &#125;, payload) &#123;</span><br><span class="line">    commit(UPDATE_PRODUCT);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> &#123; product &#125; = payload;</span><br><span class="line">    axios.put(<span class="string">`<span class="subst">$&#123;API_BASE&#125;</span>/products/<span class="subst">$&#123;product._id&#125;</span>`</span>, product)</span><br><span class="line">    .then(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">      commit(UPDATE_PRODUCT_SUCCESS, &#123;</span><br><span class="line">[tuture-del]        product: response.data,</span><br><span class="line">[tuture-add]        product: product,</span><br><span class="line">      &#125;);</span><br><span class="line">      Message(&#123;</span><br><span class="line">        message: <span class="string">'恭喜你，商品更新成功！'</span>,</span><br><span class="line">        type: <span class="string">'success'</span></span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">    .catch(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      Message.error(<span class="string">'不好意思，商品更新失败！'</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br><span class="line"> <span class="comment">// ...</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> manufacturerActions = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  updateManufacturer(&#123; commit &#125;, payload) &#123;</span><br><span class="line">    commit(UPDATE_MANUFACTURER);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> &#123; manufacturer &#125; = payload;</span><br><span class="line">    axios.put(<span class="string">`<span class="subst">$&#123;API_BASE&#125;</span>/manufacturers/<span class="subst">$&#123;manufacturer._id&#125;</span>`</span>, manufacturer)</span><br><span class="line">    .then(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">      commit(UPDATE_MANUFACTURER_SUCCESS, &#123;</span><br><span class="line">[tuture-del]        manufacturer: response.data,</span><br><span class="line">[tuture-add]        manufacturer: manufacturer,</span><br><span class="line">      &#125;);</span><br><span class="line">      Message(&#123;</span><br><span class="line">        message: <span class="string">'恭喜你，制造商更新成功！'</span>,</span><br><span class="line">        type: <span class="string">'success'</span></span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">    .catch(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      Message.error(<span class="string">'不好意思，制造商更新失败！'</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们在这里将网络请求成功时提交的载荷修改为了最新数据对象，然后提交到对应类型的 <code>mutation</code> 中进行本地数据的更新。</p>
<h3 id="将最新数据同步到本地"><a href="#将最新数据同步到本地" class="headerlink" title="将最新数据同步到本地"></a>将最新数据同步到本地</h3><p>紧接着我们需要进入 <code>mutations.js</code> 文件，将其获取到的最新数据同步到本地状态中。</p>
<figure class="highlight js"><figcaption><span>src/store/mutations.js</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvdnVlLW9ubGluZS1zaG9wLWZyb250ZW5kL2Jsb2IvYWEyMzc3NWQ2NDIzNzM0MTNhYTUxYjk3YmMzZTc5MTVhYzllMjA5NS9zcmMvc3RvcmUvbXV0YXRpb25zLmpz" title="https://github.com/tuture-dev/vue-online-shop-frontend/blob/aa23775d642373413aa51b97bc3e7915ac9e2095/src/store/mutations.js">查看完整代码<i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> productMutations = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  [UPDATE_PRODUCT_SUCCESS](state, payload) &#123;</span><br><span class="line">    state.showLoader = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> &#123; <span class="attr">product</span>: newProduct &#125; = payload;</span><br><span class="line">    state.product = newProduct;</span><br><span class="line">[tuture-del]    state.products = state.products.map(<span class="function"><span class="params">product</span> =&gt;</span> &#123;</span><br><span class="line">[tuture-add]    state.products = state.products.map( <span class="function"><span class="params">product</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (product._id === newProduct._id) &#123;</span><br><span class="line">        <span class="keyword">return</span> newProduct;</span><br><span class="line">      &#125;</span><br><span class="line">[tuture-del] </span><br><span class="line">      <span class="keyword">return</span> product;</span><br><span class="line">[tuture-del]    &#125;)</span><br><span class="line">[tuture-add]    &#125;);</span><br><span class="line">[tuture-add] </span><br><span class="line">[tuture-add]    state.product = newProduct;</span><br><span class="line">  &#125;,</span><br><span class="line">  [ADD_PRODUCT](state) &#123;</span><br><span class="line">    state.showLoader = <span class="literal">true</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br><span class="line"> <span class="comment">// ...</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> manufacturerMutations = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  [UPDATE_MANUFACTURER_SUCCESS](state, payload) &#123;</span><br><span class="line">    state.showLoader = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> &#123; <span class="attr">manufacturer</span>: newManufacturer &#125; = payload;</span><br><span class="line">    state.manufacturers = state.manufacturers.map(<span class="function"><span class="params">manufacturer</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (manufacturer._id === newManufacturer._id) &#123;</span><br><span class="line">        <span class="keyword">return</span> newManufacturer;</span><br><span class="line">      &#125;</span><br><span class="line">[tuture-del] </span><br><span class="line">      <span class="keyword">return</span> manufacturer;</span><br><span class="line">    &#125;);</span><br><span class="line">[tuture-add] </span><br><span class="line">[tuture-add]    state.manufacturer = newManufacturer;</span><br><span class="line">  &#125;,</span><br><span class="line">  [ADD_MANUFACTURER](state) &#123;</span><br><span class="line">    state.showLoader = <span class="literal">true</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="小结-5"><a href="#小结-5" class="headerlink" title="小结"></a>小结</h3><p>这一节我们主要带大家分析并尝试解决了表单信息修改后无法显示最新信息的问题。</p>
<p>本篇教程为大家呈现了在实际开发过程中，使用element-ui组件库对电商应用前端代码进行重构所遇到的一些问题，并且我们一步一步地带大家去分析及尝试解决问题。希望这篇教程让大家对element-ui组件库的使用需要注意的问题有一个大致的了解，重要的是分析和尝试解决问题的能力。好了，到这里我们的项目基本上可以愉快地跑起来了，用户的交互体验感明显得到了改善。</p>

    </div>

    
    
    
      

        <div id="qrcode_subscriber-container">
  <div></div>

  <div id="qrocde-qr">
        
      
      <div style="display: inline-block">
        <img src="/uploads/wechat-qcode.png" alt="图雀社区 微信公众号">
        <p>扫一扫关注上方公众号，拉学习群和答疑解惑</p>
      </div>

  </div>
</div>

      
        
      
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>图雀社区</li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://tuture.co/2020/03/13/tc1c9oD/" title="从零到部署：用 Vue 和 Express 实现迷你全栈电商应用（七）">https://tuture.co/2020/03/13/tc1c9oD/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC8="><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li>
</ul>
</div>

      

      <footer class="post-footer">
          
            
          
          <div class="post-tags">
            
              <a href="/tags/Vue/" rel="tag"><i class="fa fa-tag"></i> Vue</a>
            
              <a href="/tags/Element-UI/" rel="tag"><i class="fa fa-tag"></i> Element UI</a>
            
          </div>
        

        

          <div class="post-nav">
            <div class="post-nav-next post-nav-item">
              
                <a href="/2020/03/06/0X8ssR3/" rel="next" title="Docker 筑梦师系列（二）：上手容器数据管理">
                  <i class="fa fa-chevron-left"></i> Docker 筑梦师系列（二）：上手容器数据管理
                </a>
              
            </div>

            <span class="post-nav-divider"></span>

            <div class="post-nav-prev post-nav-item">
              
                <a href="/2020/03/14/-td0ssr/" rel="prev" title="从零到部署：用 Vue 和 Express 实现迷你全栈电商应用（八）">
                  从零到部署：用 Vue 和 Express 实现迷你全栈电商应用（八） <i class="fa fa-chevron-right"></i>
                </a>
              
            </div>
          </div>
        
      </footer>
    
  </div>
  
  
  
  </article>

  </div>


          </div>
          
    
    <div class="comments" id="gitalk-container"></div>
  

        </div>
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">
      <div>
          
          
          
          
        

        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc">
            文章目录
          </li>
          <li class="sidebar-nav-overview">
            站点概览
          </li>
        </ul>

        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#代码重构"><span class="nav-number">1.</span> <span class="nav-text">代码重构</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#安装element-ui依赖"><span class="nav-number">1.1.</span> <span class="nav-text">安装element-ui依赖</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#导入依赖"><span class="nav-number">1.2.</span> <span class="nav-text">导入依赖</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#重构导航栏"><span class="nav-number">1.3.</span> <span class="nav-text">重构导航栏</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#重构商品列表"><span class="nav-number">1.4.</span> <span class="nav-text">重构商品列表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#重构商品信息功能"><span class="nav-number">1.5.</span> <span class="nav-text">重构商品信息功能</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#重构制造商信息功能"><span class="nav-number">1.6.</span> <span class="nav-text">重构制造商信息功能</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#小结"><span class="nav-number">1.7.</span> <span class="nav-text">小结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#修复-ElementUI-表单的双向绑定问题"><span class="nav-number">2.</span> <span class="nav-text">修复 ElementUI 表单的双向绑定问题</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#重构-Edit-组件"><span class="nav-number">2.1.</span> <span class="nav-text">重构 Edit 组件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#重构-ProductForm-组件"><span class="nav-number">2.2.</span> <span class="nav-text">重构 ProductForm 组件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#小结-1"><span class="nav-number">2.3.</span> <span class="nav-text">小结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#完善表单双向绑定问题"><span class="nav-number">3.</span> <span class="nav-text">完善表单双向绑定问题</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#重构-ProductForm-组件-1"><span class="nav-number">3.1.</span> <span class="nav-text">重构 ProductForm 组件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#小结-2"><span class="nav-number">3.2.</span> <span class="nav-text">小结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#解决操作商品信息表单报错问题"><span class="nav-number">4.</span> <span class="nav-text">解决操作商品信息表单报错问题</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#重构-ProductForm-组件-2"><span class="nav-number">4.1.</span> <span class="nav-text">重构 ProductForm 组件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#小结-3"><span class="nav-number">4.2.</span> <span class="nav-text">小结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#添加动态效果及消息提示"><span class="nav-number">5.</span> <span class="nav-text">添加动态效果及消息提示</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#实现-loading-动态加载效果"><span class="nav-number">5.1.</span> <span class="nav-text">实现 loading 动态加载效果</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#实现消息提示功能"><span class="nav-number">5.2.</span> <span class="nav-text">实现消息提示功能</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#小结-4"><span class="nav-number">5.3.</span> <span class="nav-text">小结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#解决表单信息修改后无法显示最新"><span class="nav-number">6.</span> <span class="nav-text">解决表单信息修改后无法显示最新</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#提交最新数据"><span class="nav-number">6.1.</span> <span class="nav-text">提交最新数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#将最新数据同步到本地"><span class="nav-number">6.2.</span> <span class="nav-text">将最新数据同步到本地</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#小结-5"><span class="nav-number">6.3.</span> <span class="nav-text">小结</span></a></li></ol></li></ol></div>
          
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" src="/images/avatar.png" alt="图雀社区">
  <p class="site-author-name" itemprop="name">图雀社区</p>
  <div class="site-description" itemprop="description">由 <a href="https://github.com/tuture-dev/tuture" target="_blank" rel="external nofollow noopener noreferrer">Tuture</a> 工具写成，这里汇集了能够让你从头敲到尾并做出可运行项目的精彩的免费技术教程</div>
</div>
  <div class="feed-link motion-element">
    <a href="/atom.xml" rel="alternate">
      <i class="fa fa-rss"></i>RSS
    </a>
  </div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <span class="exturl" data-url="aHR0cHM6Ly9qdWVqaW4uaW0vdXNlci81YjMzNDE0MzUxODgyNTc0Yjk2OTRkMjg="><i class="fa fa-fw fa-custom juejin"></i>掘金</span>
      </span>
    
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <a href="/images/social/wechat.png"><i class="fa fa-fw fa-custom wechat"></i>微信</a>
      </span>
    
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <span class="exturl" data-url="aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vdHV0dXJl"><i class="fa fa-fw fa-custom zhihu"></i>知乎</span>
      </span>
    
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXY="><i class="fa fa-fw fa-github"></i>GitHub</span>
      </span>
    
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright"><span class="exturl" data-url="aHR0cDovL3d3dy5iZWlhbi5taWl0Lmdvdi5jbg==">沪ICP备19039313号 </span><span><img src="/images/gongan-url.png" style="display:inline-block;">
  
  <span class="exturl" data-url="aHR0cDovL3d3dy5iZWlhbi5nb3YuY24vcG9ydGFsL3JlZ2lzdGVyU3lzdGVtSW5mbz9yZWNvcmRjb2RlPTMxMDExNzAyMDA3MTMw">沪公网安备 31011702007130号 </span>&copy; <span itemprop="copyrightYear">2021</span>
  <span class="with-love" id="animate">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">图雀社区</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    <span title="站点总字数">891k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">13:30</span>
</span></div>
  <div class="powered-by">由 <span class="exturl theme-link" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> 强力驱动 v4.2.1</div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <span class="exturl theme-link" data-url="aHR0cHM6Ly90aGVtZS1uZXh0Lm9yZw==">NexT.Pisces</span> v7.4.0</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
</div>












        
      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js?v=3.1.0"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js"></script>

<script src="/js/utils.js?v=7.4.0.js"></script>


<script src="/js/schemes/pisces.js?v=7.4.0.js"></script>


<script src="/js/next-boot.js?v=7.4.0.js"></script>

<script src="/js/bookmark.js?v=7.4.0.js"></script>




  
  <script>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      bp.src = (curProtocol === 'https') ? 'https://zz.bdstatic.com/linksubmit/push.js' : 'http://push.zhanzhang.baidu.com/push.js';
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>








  
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/instantsearch.js@2/dist/instantsearch.min.css">
<script src="//cdn.jsdelivr.net/npm/instantsearch.js@2/dist/instantsearch.min.js"></script>
<script src="/js/algolia-search.js?v=7.4.0.js"></script>
















  

  

  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID: '6310753ce4e95163d2b0',
      clientSecret: '4fd6839b697f9d50e01eebbb9566d8bdf3bd75b4',
      repo: 'comments',
      owner: 'tuture-dev',
      admin: 'pftom,mRcfps,tuture-dev'.split(','),
      id: '4af22eb4c8dbe611dacca972ced1a5bc',
        language: 'zh-CN',
      
      distractionFreeMode: 'true'
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
</script>


  <script>
    const line = document.getElementsByClassName('line');
    const arrLine = Array.from(line);

    const delRegex = /\[.*tuture.*-.*del.*?\]/;
    const addRegex = /\[.*tuture.*-.*add.*?\]/;
    const omitRegex = /\[.*tuture.*-.*omit.*?\]/;

    const delSpaceRegex = /^\s*\[.*tuture.*-.*del.*?\]\s*$/;
    const addSpaceRegex = /^\s*\[.*tuture.*-.*add.*?\]\s*$/;
    const omitSpaceRegex = /^\s*\[.*tuture.*-.*omit.*?\]\s*$/;

    arrLine.map(item => {
      if (item.innerText.startsWith('[tuture-add]')) {
        if (addSpaceRegex.test(item.innerText)) {
          item.innerHTML = item.innerHTML.replace(addRegex, ' ');
        } else {
          item.innerHTML = item.innerHTML.replace(addRegex, '');
        }

          item.className = item.className + ' tuture-add';
      } else if (item.innerText.startsWith('[tuture-del]')) {
          if (delSpaceRegex.test(item.innerText)) {
            item.innerHTML = item.innerHTML.replace(delRegex, ' ');
          } else {
            item.innerHTML = item.innerHTML.replace(delRegex, '');
          }

          item.className = item.className + ' tuture-del';
      } else if (item.innerText.startsWith('[tuture-omit]')) {
        item.innerHTML = item.innerHTML.replace(omitRegex, '...');
        item.className = item.className + ' tuture-omit';
      }
    })
  </script>
</body>
</html>
