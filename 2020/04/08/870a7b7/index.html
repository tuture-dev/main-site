<!DOCTYPE html>





<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <meta name="keywords" content="å›¾é›€ç¤¾åŒº,Tuture,Vue.jså®æˆ˜æ•™ç¨‹,å¾®ä¿¡å°ç¨‹åº,Kotlin,React Native,Webpack,MVVM,React.js,Node.js,Redux,Django,MongoDB,Docker,JavaScript,Java,Go,Kubernetes,Nuxt,vue-router,react-router,å°ç¨‹åº,è·¨ç«¯å¼€å‘,Taro,react hooks,redux-saga,learn by doing,Web å‰ç«¯å®æˆ˜æ•™ç¨‹,åç«¯å®æˆ˜æ•™ç¨‹,å°ç¨‹åºå®æˆ˜æ•™ç¨‹,ç§»åŠ¨ç«¯å®æˆ˜æ•™ç¨‹">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png?v=7.4.0">
  <link rel="mask-icon" href="/images/logo.svg?v=7.4.0" color="#222">
  <link rel="manifest" href="/images/manifest.json">
  <meta name="msapplication-config" content="/images/browserconfig.xml">
  <link rel="alternate" href="/atom.xml" title="å›¾é›€ç¤¾åŒº" type="application/atom+xml">
  <meta name="google-site-verification" content="uDCHIeBD5phhUIjsHM8GYeoNBYWJuQIJBjgchamUcAI">
  <meta name="yandex-verification" content="90341ba6c811f41d">

<link rel="stylesheet" href="/css/main.css?v=7.4.0">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '7.4.0',
    exturl: true,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":true,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":true},
    bookmark: {"enable":true,"color":"#222","save":"auto"},
    fancybox: true,
    mediumzoom: false,
    lazyload: true,
    pangu: true,
    algolia: {
      appID: '73BSUE4RKU',
      apiKey: '0b7cce26a4734cb760080065b3c4a4a1',
      indexName: 'Tuture',
      hits: {"per_page":10},
      labels: {"input_placeholder":"æœç´¢æ•™ç¨‹","hits_empty":"æˆ‘ä»¬æ‰¾ä¸åˆ°ä½ æœç´¢çš„æ•™ç¨‹: ${query}","hits_stats":"åœ¨ ${time} ms å†…æ‰¾åˆ° ${hits} æ¡ç»“æœ"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: 'å¤åˆ¶',
      copy_success: 'å¤åˆ¶æˆåŠŸ',
      copy_failure: 'å¤åˆ¶å¤±è´¥'
    },
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="è‡ªä» React 16.8 å‘å¸ƒä¹‹åï¼Œå®ƒå¸¦æ¥çš„ React Hooks åœ¨å‰ç«¯åœˆå¼•èµ·äº†ä¸€åœºæ— æ³•é€†è½¬çš„é£æš´ã€‚React Hooks ä¸ºå‡½æ•°å¼ç»„ä»¶æä¾›äº†æ— é™çš„åŠŸèƒ½ï¼Œè§£å†³äº†ç±»ç»„ä»¶å¾ˆå¤šçš„å›ºæœ‰ç¼ºé™·ã€‚è¿™ç¯‡æ•™ç¨‹å°†å¸¦ä½ å¿«é€Ÿç†Ÿæ‚‰å¹¶æŒæ¡æœ€å¸¸ç”¨çš„ä¸¤ä¸ª Hookï¼šuseState å’Œ useEffectã€‚åœ¨äº†è§£å¦‚ä½•ä½¿ç”¨çš„åŒæ—¶ï¼Œè¿˜èƒ½ç®¡çª¥èƒŒåçš„åŸç†ï¼Œé¡ºä¾¿å®ç°ä¸€ä¸ª COVID-19ï¼ˆæ–°å† è‚ºç‚ï¼‰å¯è§†åŒ–åº”ç”¨ã€‚">
<meta property="og:type" content="article">
<meta property="og:title" content="ç”¨åŠ¨ç”»å’Œå®æˆ˜æ‰“å¼€ React Hooksï¼ˆä¸€ï¼‰ï¼šuseState å’Œ useEffect">
<meta property="og:url" content="https://tuture.co/2020/04/08/870a7b7/index.html">
<meta property="og:site_name" content="å›¾é›€ç¤¾åŒº">
<meta property="og:description" content="è‡ªä» React 16.8 å‘å¸ƒä¹‹åï¼Œå®ƒå¸¦æ¥çš„ React Hooks åœ¨å‰ç«¯åœˆå¼•èµ·äº†ä¸€åœºæ— æ³•é€†è½¬çš„é£æš´ã€‚React Hooks ä¸ºå‡½æ•°å¼ç»„ä»¶æä¾›äº†æ— é™çš„åŠŸèƒ½ï¼Œè§£å†³äº†ç±»ç»„ä»¶å¾ˆå¤šçš„å›ºæœ‰ç¼ºé™·ã€‚è¿™ç¯‡æ•™ç¨‹å°†å¸¦ä½ å¿«é€Ÿç†Ÿæ‚‰å¹¶æŒæ¡æœ€å¸¸ç”¨çš„ä¸¤ä¸ª Hookï¼šuseState å’Œ useEffectã€‚åœ¨äº†è§£å¦‚ä½•ä½¿ç”¨çš„åŒæ—¶ï¼Œè¿˜èƒ½ç®¡çª¥èƒŒåçš„åŸç†ï¼Œé¡ºä¾¿å®ç°ä¸€ä¸ª COVID-19ï¼ˆæ–°å† è‚ºç‚ï¼‰å¯è§†åŒ–åº”ç”¨ã€‚">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://static.powerformer.com/c/870a7b7/hook1.jpg">
<meta property="article:published_time" content="2020-04-07T18:52:36.227Z">
<meta property="article:modified_time" content="2021-08-08T15:05:59.627Z">
<meta property="article:author" content="å›¾é›€ç¤¾åŒº">
<meta property="article:tag" content="React">
<meta property="article:tag" content="React Hooks">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://static.powerformer.com/c/870a7b7/hook1.jpg">
  <link rel="canonical" href="https://tuture.co/2020/04/08/870a7b7/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>ç”¨åŠ¨ç”»å’Œå®æˆ˜æ‰“å¼€ React Hooksï¼ˆä¸€ï¼‰ï¼šuseState å’Œ useEffect | å›¾é›€ç¤¾åŒº</title>
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-124499211-1"></script>
  <script>
    var host = window.location.hostname;
    if (host !== "localhost" || !true) {
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-124499211-1');
    }
  </script>








  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

  <style>
    span.line.tuture-add {
      font-weight: bold;
    }

    span.line.tuture-del {
      opacity: 0.3;
    }

    .profileBox {
      display: flex;
      flex-direction: row;
      justify-content: center;
      align-items: center;
      flex-wrap: wrap;
    }

    .profileBox i {
      display: none;
    }

    .profileBox p {
      margin: 0;
      padding: 0;
    }

    .avatarBox {
      min-width: 60px;
    }

    .avatarBox .avatar {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      margin: 0;
    }

    .avatarBox .avatar:hover {
      cursor: pointer;
    }

    .avatarBox {
      margin-right: 20px;
    }

    .rightBox {
      display:flex;
      flex-direction: row;
      justify-content: flex-start;
      align-items: center;
    }

    .infoBox {
      min-width: 100px;
    }

    .infoBox p {
      padding: 0;
      margin: 0;
    }

    .infoBox .nickName {
      font-weight: bold;
      font-size: 20px;
      color: #979797;
      text-decoration: none;
    }

    .infoBox .nickName:hover {
      cursor: pointer;
    }

    .infoBox .motto {
      font-size: 16px;
      color: #979797;
    }

    .codeBox {
      margin-left: 49px;
      min-width: 100px;
    }

    .codeBox a {
      text-decoration: none;
    }

    .codeBox .exturl {
      border: none;
    }

    .codeBox span.codeText {
      display: inline-block;
      width: 100px;
      height: 40px;
      border-radius: 4px;
      border: 1px solid #979797;
      color: #979797;
      text-align: center;
      line-height: 40px;
      text-decoration: none;;
      transition: all 0.2s ease-in-out;
    }

    .codeBox .codeText:hover {
      cursor: pointer;
      background-color: #979797;
      color: #ffffff;
    }

    @media screen and (max-width:652px) {
      .profileBox {
        align-items: center;
        flex-direction: column;
      }

      .infoBox {
        margin-bottom: 20px;
      }

      .infoBox .nickName {
        text-align: center;
      }

      .rightBox {
        flex-direction: column;
        align-items: flex-start;
      }

      .codeBox {
        margin-left: 0;
      }

      .avatarBox {
        margin-right: 0;
      }
    }

    @media screen and (max-width:500px) {
      .rightBox {
        align-items: center;
      }

      .infoBox {
        margin-bottom: 20px;
      }

      .infoBox .nickName {
        text-align: center;
      }

      .infoBox .motto {
        text-align: center;
      }
    }

    .vsys {
      display:none !important;
      }

      figcaption .exturl {
        float: right;
      }
  </style>
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.15.10/build/styles/default.min.css">
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">
  <div class="container">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">å›¾é›€ç¤¾åŒº</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <h1 class="site-subtitle" itemprop="description">æ±‡é›†ç²¾å½©çš„å®æˆ˜æŠ€æœ¯æ•™ç¨‹</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
      
      
      
        
        <li class="menu-item menu-item-home">
      
    
      
      
        
      
        
      
        
      
        
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>é¦–é¡µ</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-tags">
      
    
      
      
        
      
        
      
        
          
        
      
        
      
    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>æ ‡ç­¾<span class="badge">45</span></a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-categories">
      
    
      
      
        
      
        
          
        
      
        
      
        
      
    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>åˆ†ç±»<span class="badge">22</span></a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-archives">
      
    
      
      
        
          
        
      
        
      
        
      
        
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>å½’æ¡£<span class="badge">58</span></a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-æ—©æŠ¥">
      
    
      
      
        
      
        
      
        
      
        
      
    

    <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvZGFpbHk="><i class="menu-item-icon fa fa-fw fa-calendar"></i> <br>æ—©æŠ¥</span>

  </li>
      
      
      
        
        <li class="menu-item menu-item-about">
      
    
      
      
        
      
        
      
        
      
        
      
    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>å…³äº</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-æ–‡æ¡£">
      
    
      
      
        
      
        
      
        
      
        
      
    

    <span class="exturl" data-url="aHR0cHM6Ly93d3cueXVxdWUuY29tL3R1dHVyZS9wcm9kdWN0LW1hbnVhbHM="><i class="menu-item-icon fa fa-fw fa-book"></i> <br>æ–‡æ¡£</span>

  </li>
      
      
      
        
        <li class="menu-item menu-item-faq">
      
    
      
      
        
      
        
      
        
      
        
      
    

    <a href="/FAQ" rel="section"><i class="menu-item-icon fa fa-fw fa-question"></i> <br>FAQ</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger">
        
          <i class="menu-item-icon fa fa-search fa-fw"></i> <br>æœç´¢</a>
      </li>
    
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input" id="search-input"></div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="algolia-results">
  <div id="algolia-stats"></div>
  <div id="algolia-hits"></div>
  <div id="algolia-pagination" class="algolia-pagination"></div>
</div>

  
</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <span class="exturl github-corner" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZXByb2plY3QvaHVi" title="Follow me on GitHub" aria-label="Follow me on GitHub"><svg width="80" height="80" viewbox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></span>


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
            

          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
      <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block post">
    <link itemprop="mainEntityOfPage" href="https://tuture.co/2020/04/08/870a7b7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="å›¾é›€ç¤¾åŒº">
      <meta itemprop="description" content="å›¾é›€ç¤¾åŒºæ˜¯ä¸€ä¸ªä¾›å¤§å®¶åˆ†äº«ç”¨ Tuture å†™ä½œå·¥å…·å®Œæˆçš„æ•™ç¨‹çš„ä¸€ä¸ªå¹³å°ã€‚åœ¨è¿™é‡Œï¼Œè¯»è€…ä»¬å¯ä»¥å°½æƒ…äº«å—é«˜è´¨é‡ä¸”å…è´¹çš„å®æˆ˜æ•™ç¨‹ï¼Œå¹¶èƒ½ä¸ä½œè€…å’Œå…¶ä»–è¯»è€…äº’åŠ¨å’Œè®¨è®ºï¼›è€Œä½œè€…ä»¬ä¹Ÿå¯ä»¥å€Ÿæ­¤ä¼ æ’­ä»–ä»¬çš„æŠ€æœ¯çŸ¥è¯†ï¼Œå®£ä¼ ä»–ä»¬çš„å¼€æºé¡¹ç›®ï¼Œæ‰¾åˆ°è‡ªå·±è¾“å‡ºå†…å®¹çš„å—ä¼—ï¼ŒåŠ é€ŸæŠ€æœ¯çš„ä¼ æ’­ã€‚">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="å›¾é›€ç¤¾åŒº">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">ç”¨åŠ¨ç”»å’Œå®æˆ˜æ‰“å¼€ React Hooksï¼ˆä¸€ï¼‰ï¼šuseState å’Œ useEffect

          
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              
                
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-04-08 02:52:36" itemprop="dateCreated datePublished" datetime="2020-04-08T02:52:36+08:00">2020-04-08</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-08-08 23:05:59" itemprop="dateModified" datetime="2021-08-08T23:05:59+08:00">2021-08-08</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E5%89%8D%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">å‰ç«¯</span></a></span>

                
                
                  ï¼Œ
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E5%89%8D%E7%AB%AF/React/" itemprop="url" rel="index"><span itemprop="name">React</span></a></span>

                
                
                  ï¼Œ
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E5%89%8D%E7%AB%AF/React/%E5%85%A5%E9%97%A8/" itemprop="url" rel="index"><span itemprop="name">å…¥é—¨</span></a></span>

                
                
              
            </span>
          

          
            <span class="post-meta-item" title="é˜…è¯»æ¬¡æ•°" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
          
          <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
              
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              
              <span>14k</span>
            </span>
          
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
              
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              
              <span>12 åˆ†é’Ÿ</span>
            </span>
          
            <div class="post-description">è‡ªä» React 16.8 å‘å¸ƒä¹‹åï¼Œå®ƒå¸¦æ¥çš„ React Hooks åœ¨å‰ç«¯åœˆå¼•èµ·äº†ä¸€åœºæ— æ³•é€†è½¬çš„é£æš´ã€‚React Hooks ä¸ºå‡½æ•°å¼ç»„ä»¶æä¾›äº†æ— é™çš„åŠŸèƒ½ï¼Œè§£å†³äº†ç±»ç»„ä»¶å¾ˆå¤šçš„å›ºæœ‰ç¼ºé™·ã€‚è¿™ç¯‡æ•™ç¨‹å°†å¸¦ä½ å¿«é€Ÿç†Ÿæ‚‰å¹¶æŒæ¡æœ€å¸¸ç”¨çš„ä¸¤ä¸ª Hookï¼šuseState å’Œ useEffectã€‚åœ¨äº†è§£å¦‚ä½•ä½¿ç”¨çš„åŒæ—¶ï¼Œè¿˜èƒ½ç®¡çª¥èƒŒåçš„åŸç†ï¼Œé¡ºä¾¿å®ç°ä¸€ä¸ª COVID-19ï¼ˆæ–°å† è‚ºç‚ï¼‰å¯è§†åŒ–åº”ç”¨ã€‚</div>
          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <div class="post-gallery" itemscope itemtype="http://schema.org/ImageGallery">
            <div class="post-gallery-row">
              <img src="https://static.powerformer.com/c/870a7b7/hook1.jpg" itemprop="contentUrl">
            
          

          </div>
        </div>
        <div class="profileBox">
  <div class="avatarBox">
    <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXY=" title="https://github.com/tuture-dev"><img alt class="avatar" data-src="/images/avatars/tuture-dev.jpg"><i class="fa fa-external-link"></i></span>
  </div>
  <div class="rightBox">
    <div class="infoBox">
    <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXY=" title="https://github.com/tuture-dev"><p class="nickName">@tuture-dev</p><i class="fa fa-external-link"></i></span>
  </div>
  <div class="codeBox">
    <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvY292aWQtMTktd2l0aC1ob29rcw==" title="https://github.com/tuture-dev/covid-19-with-hooks"><span class="codeText">æŸ¥çœ‹ä»£ç </span><i class="fa fa-external-link"></i></span>
  </div>
  </div>
</div><a id="more"></a>

<h2 id="èµ·æ­¥"><a href="#èµ·æ­¥" class="headerlink" title="èµ·æ­¥"></a>èµ·æ­¥</h2><h3 id="å‰ææ¡ä»¶"><a href="#å‰ææ¡ä»¶" class="headerlink" title="å‰ææ¡ä»¶"></a>å‰ææ¡ä»¶</h3><p>åœ¨é˜…è¯»è¿™ç¯‡æ•™ç¨‹ä¹‹å‰ï¼Œå¸Œæœ›ä½ å·²ç»åšäº†å¦‚ä¸‹å‡†å¤‡ï¼š</p>
<ul>
<li>æŒæ¡äº† React åŸºç¡€çŸ¥è¯†ï¼Œä¾‹å¦‚ç»„ä»¶ã€JSXã€çŠ¶æ€ç­‰ç­‰ï¼Œå¦‚æœä½ ä¸äº†è§£çš„è¯ï¼Œè¯·å…ˆå­¦ä¹ <a href="https://tuture.co/2019/11/18/07acf61/">ã€Šä¸€æ¯èŒ¶çš„æ—¶é—´ï¼Œä¸Šæ‰‹ React æ¡†æ¶ã€‹</a></li>
<li>é…ç½®å¥½ Node ç¯å¢ƒï¼Œå¯å‚è€ƒ<a href="https://tuture.co/2019/12/03/892fa12/">ã€Šä¸€æ¯èŒ¶çš„æ—¶é—´ï¼Œä¸Šæ‰‹ Node.jsã€‹</a></li>
</ul>
<h3 id="ä¸ºä»€ä¹ˆä¼šæœ‰-Hooksï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆä¼šæœ‰-Hooksï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆä¼šæœ‰ Hooksï¼Ÿ"></a>ä¸ºä»€ä¹ˆä¼šæœ‰ Hooksï¼Ÿ</h3><p>åœ¨ Hooks å‡ºç°ä¹‹å‰ï¼Œç±»ç»„ä»¶å’Œå‡½æ•°ç»„ä»¶çš„åˆ†å·¥ä¸€èˆ¬æ˜¯è¿™æ ·çš„ï¼š</p>
<ul>
<li><strong>ç±»ç»„ä»¶</strong>æä¾›äº†å®Œæ•´çš„çŠ¶æ€ç®¡ç†å’Œç”Ÿå‘½å‘¨æœŸæ§åˆ¶ï¼Œé€šå¸¸ç”¨æ¥æ‰¿æ¥å¤æ‚çš„ä¸šåŠ¡é€»è¾‘ï¼Œè¢«ç§°ä¸º<em>â€œèªæ˜ç»„ä»¶â€</em></li>
<li><strong>å‡½æ•°ç»„ä»¶</strong>åˆ™æ˜¯çº¯ç²¹çš„ä»æ•°æ®åˆ°è§†å›¾çš„æ˜ å°„ï¼Œå¯¹çŠ¶æ€æ¯«æ— æ„ŸçŸ¥ï¼Œå› æ­¤é€šå¸¸è¢«ç§°ä¸ºâ€œ<em>å‚»ç“œç»„ä»¶</em>â€</li>
</ul>
<p>æœ‰äº›å›¢é˜Ÿè¿˜åˆ¶å®šäº†è¿™æ ·çš„ React ç»„ä»¶å¼€å‘çº¦å®šï¼š</p>
<blockquote>
<p>æœ‰çŠ¶æ€çš„ç»„ä»¶æ²¡æœ‰æ¸²æŸ“ï¼Œæœ‰æ¸²æŸ“çš„ç»„ä»¶æ²¡æœ‰çŠ¶æ€ã€‚</p>
</blockquote>
<p>é‚£ä¹ˆ Hooks çš„å‡ºç°åˆæ˜¯ä¸ºäº†è§£å†³ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥è¯•å›¾æ€»ç»“ä¸€ä¸‹ç±»ç»„ä»¶é¢‡å…·ä»£è¡¨æ€§çš„<strong>ç—›ç‚¹</strong>ï¼š</p>
<ol>
<li>ä»¤äººå¤´ç–¼çš„ <code>this</code> ç®¡ç†ï¼Œå®¹æ˜“å¼•å…¥éš¾ä»¥è¿½è¸ªçš„ Bug</li>
<li>ç”Ÿå‘½å‘¨æœŸçš„åˆ’åˆ†å¹¶ä¸ç¬¦åˆâ€œå†…èšæ€§â€åŸåˆ™ï¼Œä¾‹å¦‚ <code>setInterval</code> å’Œ <code>clearInterval</code> è¿™ç§å…·æœ‰å¼ºå…³è”çš„é€»è¾‘è¢«æ‹†åˆ†åœ¨ä¸åŒçš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¸­</li>
<li>ç»„ä»¶å¤ç”¨ï¼ˆæ•°æ®å…±äº«æˆ–åŠŸèƒ½å¤ç”¨ï¼‰çš„å›°å±€ï¼Œä»æ—©æœŸçš„ Mixinï¼Œåˆ°<span class="exturl" data-url="aHR0cHM6Ly96aC1oYW5zLnJlYWN0anMub3JnL2RvY3MvaGlnaGVyLW9yZGVyLWNvbXBvbmVudHMuaHRtbA==" title="https://zh-hans.reactjs.org/docs/higher-order-components.html">é«˜é˜¶ç»„ä»¶ï¼ˆHOCï¼‰<i class="fa fa-external-link"></i></span>ï¼Œå†åˆ° <span class="exturl" data-url="aHR0cHM6Ly96aC1oYW5zLnJlYWN0anMub3JnL2RvY3MvcmVuZGVyLXByb3BzLmh0bWw=" title="https://zh-hans.reactjs.org/docs/render-props.html">Render Props<i class="fa fa-external-link"></i></span>ï¼Œå§‹ç»ˆæ²¡æœ‰ä¸€ä¸ªæ¸…æ™°ç›´è§‚åˆä¾¿äºç»´æŠ¤çš„ç»„ä»¶å¤ç”¨æ–¹æ¡ˆ</li>
</ol>
<p>æ²¡é”™ï¼Œéšç€ Hooks çš„æ¨å‡ºï¼Œè¿™äº›ç—›ç‚¹éƒ½æˆä¸ºäº†å†å²ï¼</p>
<h3 id="ä¸ºä»€ä¹ˆè¦å†™è¿™ä¸€ç³»åˆ—-Hooks-æ•™ç¨‹ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆè¦å†™è¿™ä¸€ç³»åˆ—-Hooks-æ•™ç¨‹ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆè¦å†™è¿™ä¸€ç³»åˆ— Hooks æ•™ç¨‹ï¼Ÿ"></a>ä¸ºä»€ä¹ˆè¦å†™è¿™ä¸€ç³»åˆ— Hooks æ•™ç¨‹ï¼Ÿ</h3><p>å¦‚ä½•å¿«é€Ÿå­¦ä¹ å¹¶æŒæ¡ React Hooks ä¸€ç›´æ˜¯å›°æ‰°å¾ˆå¤šæ–°æ‰‹æˆ–è€…è€ç©å®¶çš„ä¸€ä¸ªé—®é¢˜ï¼Œè€Œç¬”è€…åœ¨æ—¥å¸¸çš„å­¦ä¹ å’Œå¼€å‘ä¸­ä¹Ÿå‘ç°äº†ä»¥ä¸‹å¤´ç–¼ä¹‹å¤„ï¼š</p>
<ul>
<li>React å®˜æ–¹æ–‡æ¡£å¯¹ Hooks çš„è®²è§£ååº”ç”¨ï¼Œå¯¹åŸç†çš„é˜è¿°ä¸€ç¬”å¸¦è¿‡</li>
<li>è®² React Hooks çš„ä¼˜ç§€æ–‡ç« å¾ˆå¤šï¼Œä½†å¤§å¤šä¸“æ³¨äºè®²è§£ä¸€ä¸¤ä¸ª Hookï¼Œè¦æƒ³ä¸€ç½‘æ‰“å°½æœ‰éš¾åº¦</li>
<li>çœ‹äº†å¾ˆå¤šä½¿ç”¨æ–¹æ³•ç”šè‡³æºç åˆ†æï¼Œä½†æ˜¯æ²¡æ³•å’Œå…·ä½“çš„ä½¿ç”¨åœºæ™¯å¯¹åº”èµ·æ¥ï¼Œä¸äº†è§£æ€ä¹ˆåœ¨å®é™…å¼€å‘ä¸­çµæ´»è¿ç”¨</li>
</ul>
<p>å¦‚æœä½ ä¹Ÿæœ‰åŒæ ·çš„å›°æƒ‘ï¼Œå¸Œæœ›è¿™ä¸€ç³»åˆ—æ–‡ç« èƒ½å¸®åŠ©ä½ æ‹¨å¼€äº‘é›¾ï¼Œè®© Hooks æˆä¸ºä½ çš„ç§°æ‰‹å…µå™¨ã€‚æˆ‘ä»¬å°†é€šè¿‡ä¸€ä¸ªå®Œæ•´çš„ COVID-19 æ•°æ®å¯è§†åŒ–é¡¹ç›®ï¼Œç»“åˆ Hooks çš„åŠ¨ç”»åŸç†è®²è§£ï¼Œè®©ä½ çœŸæ­£åœ°ç²¾é€š React Hooksï¼</p>
<p>è¯´å®è¯ï¼ŒHooks çš„çŸ¥è¯†ç‚¹ç›¸å½“åˆ†æ•£ï¼Œå°±åƒæ¸¸ä¹å›­çš„æ¸¸ç©é¡¹ç›®ä¸€æ ·ï¼Œé€‰æ‹©ä¸€æ¡å®Œç¾çš„è·¯çº¿å¾ˆéš¾ã€‚ä½†æ˜¯ä¸ç®¡æ€ä¹ˆæ ·ï¼Œå¸Œæœ›åœ¨æ¥ä¸‹æ¥çš„æ—…ç¨‹ä¸­ï¼Œä½ èƒ½ç©å¾—å¼€å¿ƒğŸ˜Šï¼</p>
<h3 id="åˆå§‹åŒ–é¡¹ç›®"><a href="#åˆå§‹åŒ–é¡¹ç›®" class="headerlink" title="åˆå§‹åŒ–é¡¹ç›®"></a>åˆå§‹åŒ–é¡¹ç›®</h3><p>é¦–å…ˆï¼Œé€šè¿‡ Create React Appï¼ˆä»¥ä¸‹ç®€ç§° CRAï¼‰ åˆå§‹åŒ–é¡¹ç›®ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npx create-react-app covid-19-with-hooks</span><br></pre></td></tr></table></figure>

<p>åœ¨å°‘è®¸ç­‰å¾…ä¹‹åï¼Œè¿›å…¥é¡¹ç›®ã€‚</p>
<div class="note info">
            <p><strong>æç¤º</strong></p><p>æˆ‘ä»¬æ‰€æœ‰çš„æ•°æ®æºè‡ª <span class="exturl" data-url="aHR0cHM6Ly9jb3JvbmEubG1hby5uaW5qYS9kb2NzLyMv" title="https://corona.lmao.ninja/docs/#/">NovelCOVID 19 API<i class="fa fa-external-link"></i></span>ï¼Œå¯ä»¥ç‚¹å‡»è®¿é—®å…¶å…¨éƒ¨çš„ API æ–‡æ¡£ã€‚</p>
          </div>

<p>ä¸€åˆ‡å°±ç»ªï¼Œè®©æˆ‘ä»¬å‡ºå‘å§ï¼</p>
<h2 id="useState-useEffectï¼šåˆæ¥ä¹åˆ°"><a href="#useState-useEffectï¼šåˆæ¥ä¹åˆ°" class="headerlink" title="useState + useEffectï¼šåˆæ¥ä¹åˆ°"></a>useState + useEffectï¼šåˆæ¥ä¹åˆ°</h2><p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬ä»æœ€æœ€æœ€å¸¸ç”¨çš„ä¸¤ä¸ª Hooks è¯´èµ·ï¼š<code>useState</code> å’Œ <code>useEffect</code> ã€‚å¾ˆæœ‰å¯èƒ½ï¼Œä½ åœ¨å¹³æ—¶çš„å­¦ä¹ å’Œå¼€å‘ä¸­å·²ç»æ¥è§¦å¹¶ä½¿ç”¨è¿‡äº†ï¼ˆå½“ç„¶å¦‚æœä½ åˆšå¼€å§‹å­¦ä¹Ÿæ²¡å…³ç³»å•¦ï¼‰ã€‚ä¸è¿‡åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆç†Ÿæ‚‰ä¸€ä¸‹ React å‡½æ•°å¼ç»„ä»¶çš„è¿è¡Œè¿‡ç¨‹ã€‚</p>
<h3 id="ç†è§£å‡½æ•°å¼ç»„ä»¶çš„è¿è¡Œè¿‡ç¨‹"><a href="#ç†è§£å‡½æ•°å¼ç»„ä»¶çš„è¿è¡Œè¿‡ç¨‹" class="headerlink" title="ç†è§£å‡½æ•°å¼ç»„ä»¶çš„è¿è¡Œè¿‡ç¨‹"></a>ç†è§£å‡½æ•°å¼ç»„ä»¶çš„è¿è¡Œè¿‡ç¨‹</h3><p>æˆ‘ä»¬çŸ¥é“ï¼ŒHooks <strong>åªèƒ½ç”¨äº React å‡½æ•°å¼ç»„ä»¶</strong>ã€‚å› æ­¤ç†è§£å‡½æ•°å¼ç»„ä»¶çš„è¿è¡Œè¿‡ç¨‹å¯¹æŒæ¡ Hooks ä¸­è®¸å¤šé‡è¦çš„ç‰¹æ€§å¾ˆå…³é”®ï¼Œè¯·çœ‹ä¸‹å›¾ï¼š</p>
<p><img alt data-src="https://static.powerformer.com/c/870a7b7/1717865fb8a13cfe.gif"></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œå‡½æ•°å¼ç»„ä»¶ä¸¥æ ¼éµå¾ª <code>UI = render(data)</code> çš„æ¨¡å¼ã€‚å½“æˆ‘ä»¬ç¬¬ä¸€æ¬¡è°ƒç”¨ç»„ä»¶å‡½æ•°æ—¶ï¼Œè§¦å‘<strong>åˆæ¬¡æ¸²æŸ“</strong>ï¼›ç„¶åéšç€ <code>props</code> çš„æ”¹å˜ï¼Œä¾¿ä¼šé‡æ–°è°ƒç”¨è¯¥ç»„ä»¶å‡½æ•°ï¼Œè§¦å‘<strong>é‡æ¸²æŸ“</strong>ã€‚</p>
<p>ä½ ä¹Ÿè®¸ä¼šçº³é—·ï¼ŒåŠ¨ç”»é‡Œé¢ä¸ºå•¥è¦å¹¶æ’ç”»ä¸‰ä¸ªä¸€æ ·çš„ç»„ä»¶å‘¢ï¼Ÿå› ä¸ºæˆ‘æƒ³é€šè¿‡è¿™ç§æ–¹å¼ç›´è§‚åœ°é˜è¿°å‡½æ•°å¼ç»„ä»¶çš„ä¸€ä¸ªé‡è¦æ€æƒ³ï¼š</p>
<blockquote>
<p>æ¯ä¸€æ¬¡æ¸²æŸ“éƒ½æ˜¯å®Œå…¨ç‹¬ç«‹çš„ã€‚</p>
</blockquote>
<p>åé¢æˆ‘ä»¬å°†æ²¿ç”¨è¿™æ ·çš„é£æ ¼ï¼Œå¹¶ä¸€æ­¥æ­¥åœ°ä»‹ç» Hook åœ¨å‡½æ•°å¼ç»„ä»¶ä¸­æ‰®æ¼”æ€æ ·çš„è§’è‰²ã€‚</p>
<h3 id="useState-ä½¿ç”¨æµ…æ"><a href="#useState-ä½¿ç”¨æµ…æ" class="headerlink" title="useState ä½¿ç”¨æµ…æ"></a>useState ä½¿ç”¨æµ…æ</h3><p>é¦–å…ˆæˆ‘ä»¬æ¥ç®€å•åœ°äº†è§£ä¸€ä¸‹ <code>useState</code> é’©å­çš„ä½¿ç”¨ï¼Œå®˜æ–¹æ–‡æ¡£ä»‹ç»çš„ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> [state, setState] = useState(initialValue);</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­ <code>state</code> å°±æ˜¯ä¸€ä¸ªçŠ¶æ€å˜é‡ï¼Œ<code>setState</code> æ˜¯ä¸€ä¸ªç”¨äºä¿®æ”¹çŠ¶æ€çš„ Setter å‡½æ•°ï¼Œè€Œ <code>initialValue</code> åˆ™æ˜¯çŠ¶æ€çš„åˆå§‹å€¼ã€‚</p>
<p>å…‰çœ‹ä»£ç å¯èƒ½æœ‰ç‚¹æŠ½è±¡ï¼Œè¯·çœ‹ä¸‹é¢çš„åŠ¨ç”»ï¼š</p>
<p><img alt data-src="https://static.powerformer.com/c/870a7b7/1717865fbad32d1c.gif"></p>
<p>ä¸ä¹‹å‰çš„çº¯å‡½æ•°å¼ç»„ä»¶ç›¸æ¯”ï¼Œæˆ‘ä»¬å¼•å…¥äº† <code>useState</code> è¿™ä¸ªé’©å­ï¼Œç¬é—´å°±æ‰“ç ´äº†ä¹‹å‰ <code>UI = render(data)</code> çš„å®‰é™ç”»é¢â€”â€”å‡½æ•°ç»„ä»¶å±…ç„¶å¯ä»¥<strong>ä»ç»„ä»¶ä¹‹å¤–æŠŠçŠ¶æ€å’Œä¿®æ”¹çŠ¶æ€çš„å‡½æ•°â€œé’©â€è¿‡æ¥</strong>ï¼å¹¶ä¸”ä»”ç»†çœ‹ä¸Šé¢çš„åŠ¨ç”»ï¼Œ<strong>é€šè¿‡è°ƒç”¨ Setter å‡½æ•°ï¼Œå±…ç„¶è¿˜å¯ä»¥ç›´æ¥è§¦å‘ç»„ä»¶çš„é‡æ¸²æŸ“</strong>ï¼</p>
<div class="note info">
            <p><strong>æç¤º</strong></p><p>ä½ ä¹Ÿè®¸æ³¨æ„åˆ°äº†æ‰€æœ‰çš„â€œé’©å­â€éƒ½æŒ‡å‘äº†ä¸€ä¸ªç»¿è‰²çš„é—®å·ï¼Œæˆ‘ä»¬ä¼šåœ¨ä¸‹é¢è¯¦ç»†åœ°åˆ†æé‚£æ˜¯ä»€ä¹ˆï¼Œç°åœ¨å°±æš‚æ—¶æŠŠå®ƒçœ‹ä½œæ˜¯ç»„ä»¶ä¹‹å¤–å¯ä»¥è®¿é—®çš„ä¸€ä¸ªâ€œç¥ç§˜é¢†åŸŸâ€ã€‚</p>
          </div>

<p>ç»“åˆä¸Šé¢çš„åŠ¨ç”»ï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºä¸€ä¸ªé‡è¦çš„æ¨è®ºï¼š<strong>æ¯æ¬¡æ¸²æŸ“å…·æœ‰ç‹¬ç«‹çš„çŠ¶æ€å€¼</strong>ï¼ˆæ¯•ç«Ÿæ¯æ¬¡æ¸²æŸ“éƒ½æ˜¯å®Œå…¨ç‹¬ç«‹çš„å˜›ï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯ä¸ªå‡½æ•°ä¸­çš„ <code>state</code> å˜é‡åªæ˜¯ä¸€ä¸ªç®€å•çš„<strong>å¸¸é‡</strong>ï¼Œæ¯æ¬¡æ¸²æŸ“æ—¶ä»é’©å­ä¸­è·å–åˆ°çš„å¸¸é‡ï¼Œå¹¶æ²¡æœ‰é™„ç€æ•°æ®ç»‘å®šä¹‹ç±»çš„ç¥å¥‡é­”æ³•ã€‚</p>
<p>è¿™ä¹Ÿå°±æ˜¯è€ç”Ÿå¸¸è°ˆçš„ <strong>Capture Value</strong> ç‰¹æ€§ã€‚å¯ä»¥çœ‹ä¸‹é¢è¿™æ®µç»å…¸çš„è®¡æ•°å™¨ä»£ç ï¼ˆæ¥è‡ª Dan çš„<span class="exturl" data-url="aHR0cHM6Ly9vdmVycmVhY3RlZC5pby9hLWNvbXBsZXRlLWd1aWRlLXRvLXVzZWVmZmVjdC8=" title="https://overreacted.io/a-complete-guide-to-useeffect/">è¿™ç¯‡ç²¾å½©çš„æ–‡ç« <i class="fa fa-external-link"></i></span>ï¼‰ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Counter</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> [count, setCount] = useState(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">handleAlertClick</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      alert(<span class="string">'You clicked on: '</span> + count);</span><br><span class="line">    &#125;, <span class="number">3000</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;p&gt;You clicked &#123;count&#125; times&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">      &lt;button onClick=&#123;() =&gt; setCount(count + 1)&#125;&gt;</span></span><br><span class="line"><span class="regexp">        Click me</span></span><br><span class="line"><span class="regexp">      &lt;/</span>button&gt;</span><br><span class="line">      &lt;button onClick=&#123;handleAlertClick&#125;&gt;</span><br><span class="line">        Show alert</span><br><span class="line">      &lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å®ç°äº†ä¸Šé¢è¿™ä¸ªè®¡æ•°å™¨åï¼ˆä¹Ÿå¯ä»¥ç›´æ¥é€šè¿‡è¿™ä¸ª <span class="exturl" data-url="aHR0cHM6Ly9jb2Rlc2FuZGJveC5pby9zL3cyd3hsM3lvMGw=" title="https://codesandbox.io/s/w2wxl3yo0l">Sandbox<i class="fa fa-external-link"></i></span> è¿›è¡Œä½“éªŒï¼‰ï¼ŒæŒ‰å¦‚ä¸‹æ­¥éª¤æ“ä½œï¼š1ï¼‰ç‚¹å‡» Click me æŒ‰é’®ï¼ŒæŠŠæ•°å­—å¢åŠ åˆ° 3ï¼›2ï¼‰ç‚¹å‡» Show alert æŒ‰é’®ï¼›3ï¼‰åœ¨ <code>setTimeout</code> è§¦å‘ä¹‹å‰ç‚¹å‡» Click meï¼ŒæŠŠæ•°å­—å¢åŠ åˆ° 5ã€‚</p>
<p><img alt data-src="https://static.powerformer.com/c/870a7b7/1717865fbc70e63d.gif"></p>
<p>ç»“æœæ˜¯ Alert æ˜¾ç¤º 3ï¼</p>
<p>å¦‚æœä½ è§‰å¾—è¿™ä¸ªç»“æœå¾ˆæ­£å¸¸ï¼Œæ­å–œä½ å·²ç»ç†è§£äº† Capture Value çš„æ€æƒ³ï¼å¦‚æœä½ è§‰å¾—åŒªå¤·æ‰€æ€å˜›â€¦â€¦æ¥ç®€å•è§£é‡Šä¸€ä¸‹ï¼š</p>
<ul>
<li>æ¯æ¬¡æ¸²æŸ“ç›¸äº’ç‹¬ç«‹ï¼Œå› æ­¤æ¯æ¬¡æ¸²æŸ“æ—¶ç»„ä»¶ä¸­çš„çŠ¶æ€ã€äº‹ä»¶å¤„ç†å‡½æ•°ç­‰ç­‰éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œæˆ–è€…è¯´<strong>åªå±äº</strong>æ‰€åœ¨çš„é‚£ä¸€æ¬¡æ¸²æŸ“</li>
<li>æˆ‘ä»¬åœ¨ <code>count</code> ä¸º 3 çš„æ—¶å€™è§¦å‘äº† <code>handleAlertClick</code> å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°<strong>æ‰€è®°ä½çš„</strong> <code>count</code> ä¹Ÿä¸º 3</li>
<li>ä¸‰ç§’ç§åï¼Œåˆšæ‰å‡½æ•°çš„ <code>setTimeout</code> ç»“æŸï¼Œè¾“å‡º<strong>å½“æ—¶è®°ä½çš„</strong>ç»“æœï¼š3</li>
</ul>
<p>è¿™é“ç†å°±åƒï¼Œä½ ç¿»å¼€åå¹´å‰çš„æ—¥è®°æœ¬ï¼Œè™½ç„¶æ˜¯ç°åœ¨ç¿»å¼€çš„ï¼Œä½†è®°å½•çš„ä»ç„¶æ˜¯åå¹´å‰çš„æ—¶å…‰ã€‚æˆ–è€…è¯´ï¼Œæ—¥è®°æœ¬ Capture äº†é‚£ä¸€æ®µç¾å¥½çš„å›å¿†ã€‚</p>
<h3 id="useEffect-ä½¿ç”¨æµ…æ"><a href="#useEffect-ä½¿ç”¨æµ…æ" class="headerlink" title="useEffect ä½¿ç”¨æµ…æ"></a>useEffect ä½¿ç”¨æµ…æ</h3><p>ä½ å¯èƒ½å·²ç»å¬è¯´ <code>useEffect</code> ç±»ä¼¼ç±»ç»„ä»¶ä¸­çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚ä½†æ˜¯åœ¨å¼€å§‹å­¦ä¹  <code>useEffect</code> ä¹‹å‰ï¼Œå»ºè®®ä½ æš‚æ—¶å¿˜è®°ç”Ÿå‘½å‘¨æœŸæ¨¡å‹ï¼Œæ¯•ç«Ÿå‡½æ•°ç»„ä»¶å’Œç±»ç»„ä»¶æ˜¯ä¸åŒçš„ä¸–ç•Œã€‚å®˜æ–¹æ–‡æ¡£ä»‹ç» <code>useEffect</code> çš„ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">useEffect(effectFn, deps)</span><br></pre></td></tr></table></figure>

<p><code>effectFn</code> æ˜¯ä¸€ä¸ªæ‰§è¡ŒæŸäº›å¯èƒ½å…·æœ‰<strong>å‰¯ä½œç”¨</strong>çš„ Effect å‡½æ•°ï¼ˆä¾‹å¦‚æ•°æ®è·å–ã€è®¾ç½®/é”€æ¯å®šæ—¶å™¨ç­‰ï¼‰ï¼Œå®ƒå¯ä»¥è¿”å›ä¸€ä¸ª<strong>æ¸…ç†å‡½æ•°</strong>ï¼ˆCleanupï¼‰ï¼Œä¾‹å¦‚å¤§å®¶æ‰€ç†Ÿæ‚‰çš„ <code>setInterval</code> å’Œ <code>clearInterval</code> ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> intervalId = setInterval(doSomething(), <span class="number">1000</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> clearInterval(intervalId);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬åœ¨ Effect å‡½æ•°ä½“å†…é€šè¿‡ <code>setInterval</code> å¯åŠ¨äº†ä¸€ä¸ªå®šæ—¶å™¨ï¼Œéšååˆè¿”å›äº†ä¸€ä¸ª Cleanup å‡½æ•°ï¼Œç”¨äºé”€æ¯åˆšåˆšåˆ›å»ºçš„å®šæ—¶å™¨ã€‚</p>
<p>OKï¼Œå¬ä¸Šå»è¿˜æ˜¯å¾ˆæŠ½è±¡ï¼Œå†æ¥çœ‹çœ‹ä¸‹é¢çš„åŠ¨ç”»å§ï¼š</p>
<p><img alt data-src="https://static.powerformer.com/c/870a7b7/1717865fbc8ba58f.gif"></p>
<p>åŠ¨ç”»ä¸­æœ‰ä»¥ä¸‹éœ€è¦æ³¨æ„çš„ç‚¹ï¼š</p>
<ul>
<li>æ¯ä¸ª Effect å¿…ç„¶åœ¨æ¸²æŸ“ä¹‹åæ‰§è¡Œï¼Œå› æ­¤ä¸ä¼šé˜»å¡æ¸²æŸ“ï¼Œæé«˜äº†æ€§èƒ½</li>
<li>åœ¨è¿è¡Œæ¯ä¸ª Effect ä¹‹å‰ï¼Œè¿è¡Œå‰ä¸€æ¬¡æ¸²æŸ“çš„ Effect Cleanup å‡½æ•°ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰</li>
<li>å½“ç»„ä»¶é”€æ¯æ—¶ï¼Œè¿è¡Œæœ€åä¸€æ¬¡ Effect çš„ Cleanup å‡½æ•°</li>
</ul>
<div class="note info">
            <p><strong>æç¤º</strong></p><p>å°† Effect æ¨è¿Ÿåˆ°æ¸²æŸ“å®Œæˆä¹‹åæ‰§è¡Œæ˜¯å‡ºäºæ€§èƒ½çš„è€ƒè™‘ï¼Œå¦‚æœä½ æƒ³åœ¨æ¸²æŸ“ä¹‹å‰æ‰§è¡ŒæŸäº›é€»è¾‘ï¼ˆä¸æƒœç‰ºç‰²æ¸²æŸ“æ€§èƒ½ï¼‰ï¼Œé‚£ä¹ˆå¯ä½¿ç”¨ <span class="exturl" data-url="aHR0cHM6Ly9yZWFjdGpzLm9yZy9kb2NzL2hvb2tzLXJlZmVyZW5jZS5odG1sI3VzZWxheW91dGVmZmVjdA==" title="https://reactjs.org/docs/hooks-reference.html#uselayouteffect"><code>useLayoutEffect</code><i class="fa fa-external-link"></i></span> é’©å­ï¼Œä½¿ç”¨æ–¹æ³•ä¸ <code>useEffect</code> å®Œå…¨ä¸€è‡´ï¼Œåªæ˜¯æ‰§è¡Œçš„æ—¶æœºä¸åŒã€‚</p>
          </div>

<p>å†æ¥çœ‹çœ‹ <code>useEffect</code> çš„ç¬¬äºŒä¸ªå‚æ•°ï¼š<code>deps</code> ï¼ˆä¾èµ–æ•°ç»„ï¼‰ã€‚ä»ä¸Šé¢çš„æ¼”ç¤ºåŠ¨ç”»ä¸­å¯ä»¥çœ‹å‡ºï¼ŒReact ä¼šåœ¨<strong>æ¯æ¬¡æ¸²æŸ“åéƒ½è¿è¡Œ Effect</strong>ã€‚è€Œä¾èµ–æ•°ç»„å°±æ˜¯ç”¨æ¥æ§åˆ¶æ˜¯å¦åº”è¯¥è§¦å‘ Effectï¼Œä»è€Œèƒ½å¤Ÿå‡å°‘ä¸å¿…è¦çš„è®¡ç®—ï¼Œä»è€Œä¼˜åŒ–äº†æ€§èƒ½ã€‚å…·ä½“è€Œè¨€ï¼Œåªè¦ä¾èµ–æ•°ç»„ä¸­çš„æ¯ä¸€é¡¹ä¸ä¸Šä¸€æ¬¡æ¸²æŸ“ç›¸æ¯”éƒ½æ²¡æœ‰æ”¹å˜ï¼Œé‚£ä¹ˆå°±è·³è¿‡æœ¬æ¬¡ Effect çš„æ‰§è¡Œã€‚</p>
<p>ä»”ç»†ä¸€æƒ³ï¼Œæˆ‘ä»¬å‘ç° <code>useEffect</code> é’©å­ä¸ä¹‹å‰ç±»ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸç›¸æ¯”ï¼Œæœ‰ä¸¤ä¸ªæ˜¾è‘—çš„ç‰¹ç‚¹ï¼š</p>
<ul>
<li>å°†åˆæ¬¡æ¸²æŸ“ï¼ˆ<code>componentDidMount</code>ï¼‰ã€é‡æ¸²æŸ“ï¼ˆ<code>componentDidUpdate</code>ï¼‰å’Œé”€æ¯ï¼ˆ<code>componentDidUnmount</code>ï¼‰ä¸‰ä¸ªé˜¶æ®µçš„é€»è¾‘ç”¨ä¸€ä¸ªç»Ÿä¸€çš„ API å»è§£å†³</li>
<li>æŠŠç›¸å…³çš„é€»è¾‘éƒ½æ”¾åˆ°ä¸€ä¸ª Effect é‡Œé¢ï¼ˆä¾‹å¦‚ <code>setInterval</code> å’Œ <code>clearInterval</code>ï¼‰ï¼Œæ›´çªå‡ºé€»è¾‘çš„å†…èšæ€§</li>
</ul>
<p>åœ¨æœ€æç«¯çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‡å®š <code>deps</code> ä¸ºç©ºæ•°ç»„ <code>[]</code> ï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿ Effect <strong>åªä¼šåœ¨ç»„ä»¶åˆæ¬¡æ¸²æŸ“åæ‰§è¡Œ</strong>ã€‚å®é™…æ•ˆæœåŠ¨ç”»å¦‚ä¸‹ï¼š</p>
<p><img alt data-src="https://static.powerformer.com/c/870a7b7/1717865fbf149bdc.gif"></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œåé¢çš„æ‰€æœ‰é‡æ¸²æŸ“éƒ½ä¸ä¼šè§¦å‘ Effect çš„æ‰§è¡Œï¼›åœ¨ç»„ä»¶é”€æ¯æ—¶ï¼Œè¿è¡Œ Effect Cleanup å‡½æ•°ã€‚</p>
<div class="note warning">
            <p><strong>æ³¨æ„</strong></p><p>å¦‚æœä½ ç†Ÿæ‚‰ React çš„é‡æ¸²æŸ“æœºåˆ¶ï¼Œé‚£ä¹ˆåº”è¯¥å¯ä»¥çŒœåˆ° <code>deps</code> æ•°ç»„åœ¨åˆ¤æ–­å…ƒç´ æ˜¯å¦å‘ç”Ÿæ”¹å˜æ—¶åŒæ ·ä¹Ÿä½¿ç”¨äº† <code>Object.is</code> è¿›è¡Œæ¯”è¾ƒã€‚å› æ­¤ä¸€ä¸ªéšæ‚£ä¾¿æ˜¯ï¼Œå½“ <code>deps</code> ä¸­æŸä¸€å…ƒç´ ä¸ºéåŸå§‹ç±»å‹æ—¶ï¼ˆä¾‹å¦‚å‡½æ•°ã€å¯¹è±¡ç­‰ï¼‰ï¼Œ<strong>æ¯æ¬¡æ¸²æŸ“éƒ½ä¼šå‘ç”Ÿæ”¹å˜</strong>ï¼Œä»è€Œå¤±å»äº† <code>deps</code> æœ¬èº«çš„æ„ä¹‰ï¼ˆæ¡ä»¶å¼åœ°è§¦å‘ Effectï¼‰ã€‚æˆ‘ä»¬ä¼šåœ¨æ¥ä¸‹æ¥è®²è§£å¦‚ä½•è§„é¿è¿™ä¸ªå›°å¢ƒã€‚</p>
          </div>

<h3 id="å®æˆ˜ç¯èŠ‚"><a href="#å®æˆ˜ç¯èŠ‚" class="headerlink" title="å®æˆ˜ç¯èŠ‚"></a>å®æˆ˜ç¯èŠ‚</h3><p>OKï¼Œåˆ°äº†å®æˆ˜ç¯èŠ‚ï¼Œæˆ‘ä»¬å…ˆå®ç°è·å–å…¨çƒæ•°æ®æ¦‚å†µï¼ˆæ¯ 5 ç§’é‡æ–°è·å–ä¸€æ¬¡ï¼‰ã€‚åˆ›å»º <code>src/components/GlobalStats.js</code> ç»„ä»¶ï¼Œç”¨äºå±•ç¤ºå…¨çƒæ•°æ®æ¦‚å†µï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><figcaption><span>src/components/GlobalStats.js</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvY292aWQtMTktd2l0aC1ob29rcy9ibG9iLzVkODIzMmQyNjBjZmI3ZTE4ODU1NzVjZTE1MTNkM2YwN2Q2NjJhMzAvc3JjL2NvbXBvbmVudHMvR2xvYmFsU3RhdHMuanM=" title="https://github.com/tuture-dev/covid-19-with-hooks/blob/5d8232d260cfb7e1885575ce1513d3f07d662a30/src/components/GlobalStats.js">æŸ¥çœ‹å®Œæ•´ä»£ç <i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">"react"</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Stat</span>(<span class="params">&#123; number, color &#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">color:</span> <span class="attr">color</span>, <span class="attr">fontWeight:</span> "<span class="attr">bold</span>" &#125;&#125;&gt;</span>&#123;number&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">GlobalStats</span>(<span class="params">&#123; stats &#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; cases, deaths, recovered, active, updated &#125; = stats;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div className=<span class="string">'global-stats'</span>&gt;</span><br><span class="line">      &lt;small&gt;Updated on &#123;<span class="keyword">new</span> <span class="built_in">Date</span>(updated).toLocaleString()&#125;&lt;<span class="regexp">/small&gt;</span></span><br><span class="line"><span class="regexp">      &lt;table&gt;</span></span><br><span class="line"><span class="regexp">        &lt;tr&gt;</span></span><br><span class="line"><span class="regexp">          &lt;td&gt;</span></span><br><span class="line"><span class="regexp">            Cases: &lt;Stat number=&#123;cases&#125; color='red' /</span>&gt;</span><br><span class="line">          &lt;<span class="regexp">/td&gt;</span></span><br><span class="line"><span class="regexp">          &lt;td&gt;</span></span><br><span class="line"><span class="regexp">            Deaths: &lt;Stat number=&#123;deaths&#125; color='gray' /</span>&gt;</span><br><span class="line">          &lt;<span class="regexp">/td&gt;</span></span><br><span class="line"><span class="regexp">          &lt;td&gt;</span></span><br><span class="line"><span class="regexp">            Recovered: &lt;Stat number=&#123;recovered&#125; color='green' /</span>&gt;</span><br><span class="line">          &lt;<span class="regexp">/td&gt;</span></span><br><span class="line"><span class="regexp">          &lt;td&gt;</span></span><br><span class="line"><span class="regexp">            Active: &lt;Stat number=&#123;active&#125; color='orange' /</span>&gt;</span><br><span class="line">          &lt;<span class="regexp">/td&gt;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>tr&gt;</span><br><span class="line">      &lt;<span class="regexp">/table&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> GlobalStats;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°ï¼Œ<code>GlobalStats</code> å°±æ˜¯ä¸€ä¸ªç®€å•çš„å‡½æ•°å¼ç»„ä»¶ï¼Œæ²¡æœ‰ä»»ä½•é’©å­ã€‚</p>
<p>ç„¶åä¿®æ”¹ <code>src/App.js</code> ï¼Œå¼•å…¥åˆšåˆšåˆ›å»ºçš„ <code>GlobalStats</code> ç»„ä»¶ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><figcaption><span>src/App.js</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvY292aWQtMTktd2l0aC1ob29rcy9ibG9iLzVkODIzMmQyNjBjZmI3ZTE4ODU1NzVjZTE1MTNkM2YwN2Q2NjJhMzAvc3JjL0FwcC5qcw==" title="https://github.com/tuture-dev/covid-19-with-hooks/blob/5d8232d260cfb7e1885575ce1513d3f07d662a30/src/App.js">æŸ¥çœ‹å®Œæ•´ä»£ç <i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line">[tuture-del]<span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line">[tuture-del]<span class="keyword">import</span> logo <span class="keyword">from</span> <span class="string">'./logo.svg'</span>;</span><br><span class="line">[tuture-del]<span class="keyword">import</span> <span class="string">'./App.css'</span>;</span><br><span class="line">[tuture-add]<span class="keyword">import</span> React, &#123; useState, useEffect &#125; <span class="keyword">from</span> <span class="string">"react"</span>;</span><br><span class="line">[tuture-add] </span><br><span class="line">[tuture-add]<span class="keyword">import</span> <span class="string">"./App.css"</span>;</span><br><span class="line">[tuture-add]<span class="keyword">import</span> GlobalStats <span class="keyword">from</span> <span class="string">"./components/GlobalStats"</span>;</span><br><span class="line">[tuture-add] </span><br><span class="line">[tuture-add]<span class="keyword">const</span> BASE_URL = <span class="string">"https://corona.lmao.ninja/v2"</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">[tuture-add]  <span class="keyword">const</span> [globalStats, setGlobalStats] = useState(&#123;&#125;);</span><br><span class="line">[tuture-add] </span><br><span class="line">[tuture-add]  useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">[tuture-add]    <span class="keyword">const</span> fetchGlobalStats = <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">[tuture-add]      <span class="keyword">const</span> response = <span class="keyword">await</span> fetch(<span class="string">`<span class="subst">$&#123;BASE_URL&#125;</span>/all`</span>);</span><br><span class="line">[tuture-add]      <span class="keyword">const</span> data = <span class="keyword">await</span> response.json();</span><br><span class="line">[tuture-add]      setGlobalStats(data);</span><br><span class="line">[tuture-add]    &#125;;</span><br><span class="line">[tuture-add] </span><br><span class="line">[tuture-add]    fetchGlobalStats();</span><br><span class="line">[tuture-add]    <span class="keyword">const</span> intervalId = setInterval(fetchGlobalStats, <span class="number">5000</span>);</span><br><span class="line">[tuture-add] </span><br><span class="line">[tuture-add]    <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> clearInterval(intervalId);</span><br><span class="line">[tuture-add]  &#125;, []);</span><br><span class="line">[tuture-add] </span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">[tuture-del]    &lt;div className=<span class="string">"App"</span>&gt;</span><br><span class="line">[tuture-del]      &lt;header className=<span class="string">"App-header"</span>&gt;</span><br><span class="line">[tuture-del]        &lt;img src=&#123;logo&#125; className=<span class="string">"App-logo"</span> alt=<span class="string">"logo"</span> /&gt;</span><br><span class="line">[tuture-del]        &lt;p&gt;</span><br><span class="line">[tuture-del]          Edit &lt;code&gt;src/App.js&lt;<span class="regexp">/code&gt; and save to reload.</span></span><br><span class="line"><span class="regexp">[tuture-del]        &lt;/</span>p&gt;</span><br><span class="line">[tuture-del]        &lt;a</span><br><span class="line">[tuture-del]          className=<span class="string">"App-link"</span></span><br><span class="line">[tuture-del]          href=<span class="string">"https://reactjs.org"</span></span><br><span class="line">[tuture-del]          target=<span class="string">"_blank"</span></span><br><span class="line">[tuture-del]          rel=<span class="string">"noopener noreferrer"</span></span><br><span class="line">[tuture-del]        &gt;</span><br><span class="line">[tuture-del]          Learn React</span><br><span class="line">[tuture-del]        &lt;<span class="regexp">/a&gt;</span></span><br><span class="line"><span class="regexp">[tuture-del]      &lt;/</span>header&gt;</span><br><span class="line">[tuture-add]    &lt;div className=<span class="string">'App'</span>&gt;</span><br><span class="line">[tuture-add]      &lt;h1&gt;COVID<span class="number">-19</span>&lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">[tuture-add]      &lt;GlobalStats stats=&#123;globalStats&#125; /</span>&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default App;</span></span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬åœ¨ <code>App</code> ç»„ä»¶ä¸­ï¼Œé¦–å…ˆé€šè¿‡ <code>useState</code> é’©å­å¼•å…¥äº† <code>globalStats</code> çŠ¶æ€å˜é‡ï¼Œä»¥åŠä¿®æ”¹è¯¥çŠ¶æ€çš„å‡½æ•°ã€‚ç„¶åé€šè¿‡ <code>useEffect</code> é’©å­è·å– API æ•°æ®ï¼Œå…¶ä¸­æœ‰ä»¥ä¸‹éœ€è¦æ³¨æ„çš„ç‚¹ï¼š</p>
<ol>
<li>æˆ‘ä»¬é€šè¿‡å®šä¹‰äº†ä¸€ä¸ª <code>fetchGlobalStats</code> å¼‚æ­¥å‡½æ•°å¹¶è¿›è¡Œè°ƒç”¨ä»è€Œè·å–æ•°æ®ï¼Œè€Œä¸æ˜¯ç›´æ¥æŠŠè¿™ä¸ª async å‡½æ•°ä½œä¸º <code>useEffect</code> çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼›</li>
<li>åˆ›å»ºäº†ä¸€ä¸ª Intervalï¼Œç”¨äºæ¯ 5 ç§’é’Ÿé‡æ–°è·å–ä¸€æ¬¡æ•°æ®ï¼›</li>
<li>è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºé”€æ¯ä¹‹å‰åˆ›å»ºçš„ Intervalã€‚</li>
</ol>
<p>æ­¤å¤–ï¼Œç¬¬äºŒä¸ªå‚æ•°ï¼ˆä¾èµ–æ•°ç»„ï¼‰ä¸ºç©ºæ•°ç»„ï¼Œå› æ­¤æ•´ä¸ª Effect å‡½æ•°åªä¼šè¿è¡Œä¸€æ¬¡ã€‚</p>
<div class="note warning">
            <p><strong>æ³¨æ„</strong></p><p>æœ‰æ—¶å€™ï¼Œä½ ä¹Ÿè®¸ä¼šä¸ç»æ„é—´æŠŠ Effect å†™æˆä¸€ä¸ª async å‡½æ•°ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">useEffect(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> response = <span class="keyword">await</span> fetch(<span class="string">'...'</span>);</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;, []);</span><br></pre></td></tr></table></figure><p>è¿™æ ·å¯ä»¥å—ï¼Ÿ<strong>å¼ºçƒˆå»ºè®®ä½ ä¸è¦è¿™æ ·åš</strong>ã€‚<code>useEffect</code> çº¦å®š Effect å‡½æ•°è¦ä¹ˆæ²¡æœ‰è¿”å›å€¼ï¼Œè¦ä¹ˆè¿”å›ä¸€ä¸ª Cleanup å‡½æ•°ã€‚è€Œè¿™é‡Œ async å‡½æ•°ä¼šéšå¼åœ°è¿”å›ä¸€ä¸ª Promiseï¼Œç›´æ¥è¿åäº†è¿™ä¸€çº¦å®šï¼Œä¼šé€ æˆä¸å¯é¢„æµ‹çš„ç»“æœã€‚</p>
          </div>

<p>æœ€åé™„ä¸Šåº”ç”¨çš„å…¨å±€ CSS æ–‡ä»¶ï¼Œä»£ç å¦‚ä¸‹ï¼ˆç›´æ¥å¤åˆ¶ç²˜è´´å³å¯ï¼‰ï¼š</p>
<figure class="highlight css"><figcaption><span>src/App.css</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvY292aWQtMTktd2l0aC1ob29rcy9ibG9iLzVkODIzMmQyNjBjZmI3ZTE4ODU1NzVjZTE1MTNkM2YwN2Q2NjJhMzAvc3JjL0FwcC5jc3M=" title="https://github.com/tuture-dev/covid-19-with-hooks/blob/5d8232d260cfb7e1885575ce1513d3f07d662a30/src/App.css">æŸ¥çœ‹å®Œæ•´ä»£ç <i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.App</span> &#123;</span><br><span class="line">[tuture-add]  width: 1200px;</span><br><span class="line"><span class="selector-attr">[tuture-add]</span>  <span class="selector-tag">margin</span>: <span class="selector-tag">auto</span>;</span><br><span class="line">  <span class="selector-tag">text-align</span>: <span class="selector-tag">center</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[tuture-del]</span><span class="selector-class">.App-logo</span> &#123;</span><br><span class="line">[tuture-del]  height: 40vmin;</span><br><span class="line"><span class="selector-attr">[tuture-del]</span>  <span class="selector-tag">pointer-events</span>: <span class="selector-tag">none</span>;</span><br><span class="line"><span class="selector-attr">[tuture-del]</span>&#125;</span><br><span class="line"><span class="selector-attr">[tuture-del]</span> </span><br><span class="line"><span class="selector-attr">[tuture-del]</span><span class="keyword">@media</span> (<span class="attribute">prefers-reduced-motion:</span> no-preference) &#123;</span><br><span class="line"><span class="selector-attr">[tuture-del]</span>  <span class="selector-class">.App-logo</span> &#123;</span><br><span class="line">[tuture-del]    animation: App-logo-spin infinite 20s linear;</span><br><span class="line"><span class="selector-attr">[tuture-del]</span>  &#125;</span><br><span class="line"><span class="selector-attr">[tuture-del]</span>&#125;</span><br><span class="line"><span class="selector-attr">[tuture-del]</span> </span><br><span class="line"><span class="selector-attr">[tuture-del]</span><span class="selector-class">.App-header</span> &#123;</span><br><span class="line">[tuture-del]  background-color: #282c34;</span><br><span class="line"><span class="selector-attr">[tuture-del]</span>  <span class="selector-tag">min-height</span>: 100<span class="selector-tag">vh</span>;</span><br><span class="line"><span class="selector-attr">[tuture-add]</span><span class="selector-class">.history-group</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">[tuture-del]  flex-direction: column;</span><br><span class="line"><span class="selector-attr">[tuture-del]</span>  <span class="selector-tag">align-items</span>: <span class="selector-tag">center</span>;</span><br><span class="line">  <span class="selector-tag">justify-content</span>: <span class="selector-tag">center</span>;</span><br><span class="line"><span class="selector-attr">[tuture-del]</span>  <span class="selector-tag">font-size</span>: <span class="selector-tag">calc</span>(10<span class="selector-tag">px</span> + 2<span class="selector-tag">vmin</span>);</span><br><span class="line"><span class="selector-attr">[tuture-del]</span>  <span class="selector-tag">color</span>: <span class="selector-tag">white</span>;</span><br><span class="line"><span class="selector-attr">[tuture-add]</span>  <span class="selector-tag">width</span>: 1200<span class="selector-tag">px</span>;</span><br><span class="line"><span class="selector-attr">[tuture-add]</span>  <span class="selector-tag">margin</span>: <span class="selector-tag">auto</span>;</span><br><span class="line"><span class="selector-attr">[tuture-add]</span>&#125;</span><br><span class="line"><span class="selector-attr">[tuture-add]</span> </span><br><span class="line"><span class="selector-attr">[tuture-add]</span><span class="selector-tag">table</span>,</span><br><span class="line"><span class="selector-attr">[tuture-add]</span><span class="selector-tag">th</span>,</span><br><span class="line"><span class="selector-attr">[tuture-add]</span><span class="selector-tag">td</span> &#123;</span><br><span class="line">[tuture-add]  border: 1px solid #ccc;</span><br><span class="line"><span class="selector-attr">[tuture-add]</span>  <span class="selector-tag">border-collapse</span>: <span class="selector-tag">collapse</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[tuture-del]</span><span class="selector-class">.App-link</span> &#123;</span><br><span class="line">[tuture-del]  color: #61dafb;</span><br><span class="line"><span class="selector-attr">[tuture-add]</span><span class="selector-tag">th</span>,</span><br><span class="line"><span class="selector-attr">[tuture-add]</span><span class="selector-tag">td</span> &#123;</span><br><span class="line">[tuture-add]  padding: 5px;</span><br><span class="line"><span class="selector-attr">[tuture-add]</span>  <span class="selector-tag">text-align</span>: <span class="selector-tag">left</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[tuture-del]</span><span class="keyword">@keyframes</span> App-logo-spin &#123;</span><br><span class="line"><span class="selector-attr">[tuture-del]</span>  <span class="selector-tag">from</span> &#123;</span><br><span class="line">[tuture-del]    transform: rotate(0deg);</span><br><span class="line"><span class="selector-attr">[tuture-del]</span>  &#125;</span><br><span class="line"><span class="selector-attr">[tuture-del]</span>  <span class="selector-tag">to</span> &#123;</span><br><span class="line">[tuture-del]    transform: rotate(360deg);</span><br><span class="line"><span class="selector-attr">[tuture-del]</span>  &#125;</span><br><span class="line"><span class="selector-attr">[tuture-add]</span><span class="selector-class">.global-stats</span> &gt; <span class="selector-tag">table</span> &#123;</span><br><span class="line">[tuture-add]  margin: auto;</span><br><span class="line"><span class="selector-attr">[tuture-add]</span>  <span class="selector-tag">margin-top</span>: 0<span class="selector-class">.5rem</span>;</span><br><span class="line"><span class="selector-attr">[tuture-add]</span>  <span class="selector-tag">margin-bottom</span>: 1<span class="selector-tag">rem</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡ <code>npm start</code> å¼€å¯é¡¹ç›®ï¼š</p>
<p><img alt data-src="https://static.powerformer.com/c/870a7b7/171786603098c448.png"></p>
<p>æ­¤å¤–ï¼Œä½ å¯ä»¥æ£€æŸ¥ä¸€ä¸‹æ§åˆ¶å°çš„ Network é€‰é¡¹å¡ï¼Œåº”è¯¥èƒ½çœ‹åˆ°æˆ‘ä»¬çš„åº”ç”¨æ¯äº”ç§’å°±ä¼šå‘èµ·ä¸€æ¬¡è¯·æ±‚æŸ¥è¯¢æœ€æ–°çš„æ•°æ®ã€‚æ­å–œä½ ï¼ŒæˆåŠŸåœ°ç”¨ Hooks è¿›è¡Œäº†ä¸€æ¬¡æ•°æ®è·å–ï¼</p>
<h2 id="useState-useEffectï¼šæ¸å…¥ä½³å¢ƒ"><a href="#useState-useEffectï¼šæ¸å…¥ä½³å¢ƒ" class="headerlink" title="useState + useEffectï¼šæ¸å…¥ä½³å¢ƒ"></a>useState + useEffectï¼šæ¸å…¥ä½³å¢ƒ</h2><p>åœ¨ä¸Šä¸€æ­¥éª¤ä¸­ï¼Œæˆ‘ä»¬åœ¨ <code>App</code> ç»„ä»¶ä¸­å®šä¹‰äº†ä¸€ä¸ª State å’Œ Effectï¼Œä½†æ˜¯å®é™…åº”ç”¨ä¸å¯èƒ½è¿™ä¹ˆç®€å•ï¼Œä¸€èˆ¬éƒ½éœ€è¦å¤šä¸ª State å’Œ Effectï¼Œè¿™æ—¶å€™åˆè¯¥æ€ä¹ˆå»ç†è§£å’Œä½¿ç”¨å‘¢ï¼Ÿ</p>
<h3 id="æ·±å…¥-useState-çš„æœ¬è´¨"><a href="#æ·±å…¥-useState-çš„æœ¬è´¨" class="headerlink" title="æ·±å…¥ useState çš„æœ¬è´¨"></a>æ·±å…¥ useState çš„æœ¬è´¨</h3><p>åœ¨ä¸Šä¸€èŠ‚çš„åŠ¨ç”»ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°æ¯ä¸€æ¬¡æ¸²æŸ“ç»„ä»¶æ—¶ï¼Œæˆ‘ä»¬éƒ½èƒ½é€šè¿‡ä¸€ä¸ªç¥å¥‡çš„é’©å­æŠŠçŠ¶æ€â€é’©â€œè¿‡æ¥ï¼Œä¸è¿‡è¿™äº›é’©å­ä»ä½•è€Œæ¥æˆ‘ä»¬æ‰“äº†ä¸€ä¸ªé—®å·ã€‚ç°åœ¨ï¼Œæ˜¯æ—¶å€™è§£å¼€è°œå›¢äº†ã€‚</p>
<div class="note warning">
            <p><strong>æ³¨æ„</strong></p><p>ä»¥ä¸‹åŠ¨ç”»æ¼”ç¤ºå¹¶ä¸å®Œå…¨å¯¹åº” React Hooks çš„æºç å®ç°ï¼Œä½†æ˜¯å®ƒèƒ½å¾ˆå¥½åœ°å¸®åŠ©ä½ ç†è§£å…¶å·¥ä½œåŸç†ã€‚å½“ç„¶ï¼Œä¹Ÿèƒ½å¸®åŠ©ä½ å»å•ƒçœŸæ­£çš„æºç ã€‚</p>
          </div>

<p>æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹å½“ç»„ä»¶åˆæ¬¡æ¸²æŸ“ï¼ˆæŒ‚è½½ï¼‰æ—¶ï¼Œæƒ…å†µåˆ°åº•æ˜¯ä»€ä¹ˆæ ·çš„ï¼š</p>
<p><img alt data-src="https://static.powerformer.com/c/870a7b7/171786605bc81ad0.gif"></p>
<p>æ³¨æ„ä»¥ä¸‹è¦ç‚¹ï¼š</p>
<ol>
<li>åœ¨åˆæ¬¡æ¸²æŸ“æ—¶ï¼Œæˆ‘ä»¬é€šè¿‡ <code>useState</code> å®šä¹‰äº†å¤šä¸ªçŠ¶æ€ï¼›</li>
<li>æ¯è°ƒç”¨ä¸€æ¬¡ <code>useState</code> ï¼Œéƒ½ä¼šåœ¨ç»„ä»¶ä¹‹å¤–ç”Ÿæˆä¸€æ¡ Hook è®°å½•ï¼ŒåŒæ—¶åŒ…æ‹¬çŠ¶æ€å€¼ï¼ˆç”¨ <code>useState</code> ç»™å®šçš„åˆå§‹å€¼åˆå§‹åŒ–ï¼‰å’Œä¿®æ”¹çŠ¶æ€çš„ Setter å‡½æ•°ï¼›</li>
<li>å¤šæ¬¡è°ƒç”¨ <code>useState</code> ç”Ÿæˆçš„ Hook è®°å½•å½¢æˆäº†ä¸€æ¡<strong>é“¾è¡¨</strong>ï¼›</li>
<li>è§¦å‘ <code>onClick</code> å›è°ƒå‡½æ•°ï¼Œè°ƒç”¨ <code>setS2</code> å‡½æ•°ä¿®æ”¹ <code>s2</code> çš„çŠ¶æ€ï¼Œä¸ä»…ä¿®æ”¹äº† Hook è®°å½•ä¸­çš„çŠ¶æ€å€¼ï¼Œè¿˜å³å°†<strong>è§¦å‘é‡æ¸²æŸ“</strong>ã€‚</li>
</ol>
<p>OKï¼Œé‡æ¸²æŸ“çš„æ—¶å€™åˆ°äº†ï¼ŒåŠ¨ç”»å¦‚ä¸‹ï¼š</p>
<p><img alt data-src="https://static.powerformer.com/c/870a7b7/171786607069e72d.gif"></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨åˆæ¬¡æ¸²æŸ“ç»“æŸä¹‹åã€é‡æ¸²æŸ“ä¹‹å‰ï¼ŒHook è®°å½•é“¾è¡¨ä¾ç„¶å­˜åœ¨ã€‚å½“æˆ‘ä»¬é€ä¸ªè°ƒç”¨ <code>useState</code> çš„æ—¶å€™ï¼Œ<code>useState</code> ä¾¿è¿”å›äº† Hook é“¾è¡¨ä¸­å­˜å‚¨çš„çŠ¶æ€ï¼Œä»¥åŠä¿®æ”¹çŠ¶æ€çš„ Setterã€‚</p>
<div class="note info">
            <p><strong>æç¤º</strong></p><p>å½“ä½ å……åˆ†ç†è§£ä¸Šé¢ä¸¤ä¸ªåŠ¨ç”»ä¹‹åï¼Œå…¶å®å°±èƒ½ç†è§£ä¸ºä»€ä¹ˆè¿™ä¸ª Hook å« <code>useState</code> è€Œä¸æ˜¯ <code>createState</code> äº†â€”â€”ä¹‹æ‰€ä»¥å« <code>use</code> ï¼Œæ˜¯å› ä¸ºæ²¡æœ‰çš„æ—¶å€™æ‰åˆ›å»ºï¼ˆåˆæ¬¡æ¸²æŸ“çš„æ—¶å€™ï¼‰ï¼Œæœ‰çš„æ—¶å€™å°±ç›´æ¥è¯»å–ï¼ˆé‡æ¸²æŸ“çš„æ—¶å€™ï¼‰ã€‚</p>
          </div>

<p>é€šè¿‡ä»¥ä¸Šçš„åˆ†æï¼Œæˆ‘ä»¬ä¸éš¾å‘ç° <code>useState</code> åœ¨è®¾è®¡æ–¹é¢çš„ç²¾å·§ï¼ˆæ‘˜è‡ªå¼ ç«‹ç†ï¼š<span class="exturl" data-url="aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC80ODI2NDcxMw==" title="https://zhuanlan.zhihu.com/p/48264713">å¯¹ React Hooks çš„ä¸€äº›æ€è€ƒ<i class="fa fa-external-link"></i></span>ï¼‰ï¼š</p>
<ul>
<li>çŠ¶æ€å’Œä¿®æ”¹çŠ¶æ€çš„ Setter å‡½æ•°ä¸¤ä¸¤é…å¯¹ï¼Œå¹¶ä¸”åè€…ä¸€å®šå½±å“å‰è€…ï¼Œå‰è€…åªè¢«åè€…å½±å“ï¼Œä½œä¸ºä¸€ä¸ªæ•´ä½“å®ƒä»¬å®Œå…¨ä¸å—å¤–ç•Œçš„å½±å“</li>
<li>é¼“åŠ±ç»†ç²’åº¦å’Œæ‰å¹³åŒ–çš„çŠ¶æ€å®šä¹‰å’Œæ§åˆ¶ï¼Œå¯¹äºä»£ç è¡Œä¸ºçš„å¯é¢„æµ‹æ€§å’Œå¯æµ‹è¯•æ€§å¤§æœ‰å¸®åŠ©</li>
<li>é™¤äº† <code>useState</code> ï¼ˆå’Œå…¶ä»–é’©å­ï¼‰ï¼Œå‡½æ•°ç»„ä»¶ä¾ç„¶æ˜¯å®ç°æ¸²æŸ“é€»è¾‘çš„â€œçº¯â€ç»„ä»¶ï¼Œå¯¹çŠ¶æ€çš„ç®¡ç†è¢« Hooks æ‰€å°è£…äº†èµ·æ¥</li>
</ul>
<h3 id="æ·±å…¥-useEffect-çš„æœ¬è´¨"><a href="#æ·±å…¥-useEffect-çš„æœ¬è´¨" class="headerlink" title="æ·±å…¥ useEffect çš„æœ¬è´¨"></a>æ·±å…¥ useEffect çš„æœ¬è´¨</h3><p>åœ¨å¯¹ <code>useState</code> è¿›è¡Œä¸€æ³¢æ·±æŒ–ä¹‹åï¼Œæˆ‘ä»¬å†æ¥æ­å¼€ <code>useEffect</code> ç¥ç§˜çš„é¢çº±ã€‚å®é™…ä¸Šï¼Œä½ å¯èƒ½å·²ç»çŒœåˆ°äº†â€”â€”åŒæ ·æ˜¯é€šè¿‡ä¸€ä¸ªé“¾è¡¨è®°å½•æ‰€æœ‰çš„ Hookï¼Œè¯·çœ‹ä¸‹é¢çš„æ¼”ç¤ºï¼š</p>
<p><img alt data-src="https://static.powerformer.com/c/870a7b7/17178660689c7301.gif"></p>
<p>æ³¨æ„å…¶ä¸­ä¸€äº›ç»†èŠ‚ï¼š</p>
<ol>
<li><code>useState</code> å’Œ <code>useEffect</code> åœ¨æ¯æ¬¡è°ƒç”¨æ—¶éƒ½è¢«æ·»åŠ åˆ° Hook é“¾è¡¨ä¸­ï¼›</li>
<li><code>useEffect</code> è¿˜ä¼šé¢å¤–åœ°åœ¨ä¸€ä¸ªé˜Ÿåˆ—ä¸­æ·»åŠ ä¸€ä¸ªç­‰å¾…æ‰§è¡Œçš„ Effect å‡½æ•°ï¼›</li>
<li>åœ¨æ¸²æŸ“å®Œæˆåï¼Œä¾æ¬¡è°ƒç”¨ Effect é˜Ÿåˆ—ä¸­çš„æ¯ä¸€ä¸ª Effect å‡½æ•°ã€‚</li>
</ol>
<p>è‡³æ­¤ï¼Œä¸Šä¸€èŠ‚çš„åŠ¨ç”»ä¸­é‚£ä¸¤ä¸ªâ€œé—®å·â€çš„èº«ä¸–ä¹Ÿå°±æ­æ™“äº†â€”â€”åªä¸è¿‡æ˜¯<strong>é“¾è¡¨</strong>ç½¢äº†ï¼å›è¿‡å¤´æ¥ï¼Œæˆ‘ä»¬æƒ³èµ·æ¥ React å®˜æ–¹æ–‡æ¡£ Rules of Hooks ä¸­å¼ºè°ƒè¿‡ä¸€ç‚¹ï¼š</p>
<blockquote>
<p>Only call hooks at the top level. åªåœ¨æœ€é¡¶å±‚ä½¿ç”¨ Hookã€‚</p>
</blockquote>
<p>å…·ä½“åœ°è¯´ï¼Œä¸è¦åœ¨å¾ªç¯ã€åµŒå¥—ã€æ¡ä»¶è¯­å¥ä¸­ä½¿ç”¨ Hookâ€”â€”å› ä¸ºè¿™äº›åŠ¨æ€çš„è¯­å¥å¾ˆæœ‰å¯èƒ½ä¼šå¯¼è‡´æ¯æ¬¡æ‰§è¡Œç»„ä»¶å‡½æ•°æ—¶è°ƒç”¨ Hook çš„é¡ºåºä¸èƒ½å®Œå…¨ä¸€è‡´ï¼Œå¯¼è‡´ Hook é“¾è¡¨è®°å½•çš„æ•°æ®å¤±æ•ˆã€‚å…·ä½“çš„åœºæ™¯å°±ä¸ç”»åŠ¨ç”»å•¦ï¼Œè‡ªè¡Œè„‘è¡¥å§~</p>
<h3 id="ä¸è¦æ’’è°ï¼šå…³äº-deps-çš„é‚£äº›äº‹"><a href="#ä¸è¦æ’’è°ï¼šå…³äº-deps-çš„é‚£äº›äº‹" class="headerlink" title="ä¸è¦æ’’è°ï¼šå…³äº deps çš„é‚£äº›äº‹"></a>ä¸è¦æ’’è°ï¼šå…³äº deps çš„é‚£äº›äº‹</h3><p><code>useEffect</code> ï¼ˆåŒ…æ‹¬å…¶ä»–ç±»ä¼¼çš„ <code>useCallback</code> å’Œ <code>useMemo</code> ç­‰ï¼‰éƒ½æœ‰ä¸ªä¾èµ–æ•°ç»„ï¼ˆ<code>deps</code>ï¼‰å‚æ•°ï¼Œè¿™ä¸ªå‚æ•°æ¯”è¾ƒæœ‰è¶£çš„ä¸€ç‚¹æ˜¯ï¼šæŒ‡å®šä¾èµ–çš„å†³å®šæƒå®Œå…¨åœ¨ä½ æ‰‹é‡Œã€‚ä½ å½“ç„¶å¯ä»¥é€‰æ‹©â€œæ’’è°â€ï¼Œä¸ç®¡ä»€ä¹ˆæƒ…å†µéƒ½ç»™ä¸€ä¸ªç©ºçš„ <code>deps</code> æ•°ç»„ï¼Œä»¿ä½›åœ¨è¯´â€œè¿™ä¸ª Effect å‡½æ•°ä»€ä¹ˆä¾èµ–éƒ½æ²¡æœ‰ï¼Œç›¸ä¿¡æˆ‘â€ã€‚</p>
<p>ç„¶è€Œï¼Œè¿™ç§æœ‰ç‚¹å·æ‡’çš„åšæ³•æ˜¾ç„¶ä¼šå¼•æ¥å„ç§ Bugã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæ‰€ä½¿ç”¨åˆ°çš„ <code>prop</code> æˆ–è€… <code>state</code> éƒ½åº”è¯¥è¢«æ·»åŠ åˆ° <code>deps</code> æ•°ç»„é‡Œé¢å»ã€‚å¹¶ä¸”ï¼ŒReact å®˜æ–¹è¿˜æ¨å‡ºäº†ä¸€ä¸ªä¸“é—¨çš„ <span class="exturl" data-url="aHR0cHM6Ly93d3cubnBtanMuY29tL3BhY2thZ2UvZXNsaW50LXBsdWdpbi1yZWFjdC1ob29rcw==" title="https://www.npmjs.com/package/eslint-plugin-react-hooks">ESLint æ’ä»¶<i class="fa fa-external-link"></i></span>ï¼Œå¯ä»¥å¸®ä½ è‡ªåŠ¨ä¿®å¤ <code>deps</code> æ•°ç»„ï¼ˆ<em>è¯´å®è¯ï¼Œè¿™ä¸ªæ’ä»¶çš„è‡ªåŠ¨ä¿®å¤æœ‰æ—¶å€™è¿˜æ˜¯æŒºé—¹å¿ƒçš„â€¦â€¦</em>ï¼‰ã€‚</p>
<h3 id="å®æˆ˜ç¯èŠ‚-1"><a href="#å®æˆ˜ç¯èŠ‚-1" class="headerlink" title="å®æˆ˜ç¯èŠ‚"></a>å®æˆ˜ç¯èŠ‚</h3><p>ä»è¿™ä¸€æ­¥å¼€å§‹ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ <span class="exturl" data-url="aHR0cDovL3JlY2hhcnRzLm9yZw==" title="http://recharts.org">Recharts<i class="fa fa-external-link"></i></span> ä½œä¸ºå¯è§†åŒ–åº”ç”¨çš„å›¾è¡¨åº“ï¼Œå®ƒæä¾›äº†å‡ºè‰²çš„ D3 å’Œ React çš„ç»‘å®šå±‚ã€‚é€šè¿‡å¦‚ä¸‹å‘½ä»¤æ·»åŠ  <code>recharts</code> ä¾èµ–ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install recharts</span><br></pre></td></tr></table></figure>

<p>åˆ›å»º <code>src/components/CountriesChart.js</code> ï¼Œç”¨äºå±•ç¤ºå¤šä¸ªå›½å®¶çš„ç›¸å…³æ•°æ®ç›´æ–¹å›¾ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><figcaption><span>src/components/CountriesChart.js</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvY292aWQtMTktd2l0aC1ob29rcy9ibG9iL2FjYTE3NzQ2OGVjYjQyMjBhMzM2ZDBkOGY5MWUzNmY5YmRkNzBiOTcvc3JjL2NvbXBvbmVudHMvQ291bnRyaWVzQ2hhcnQuanM=" title="https://github.com/tuture-dev/covid-19-with-hooks/blob/aca177468ecb4220a336d0d8f91e36f9bdd70b97/src/components/CountriesChart.js">æŸ¥çœ‹å®Œæ•´ä»£ç <i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">"react"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  BarChart,</span><br><span class="line">  CartesianGrid,</span><br><span class="line">  XAxis,</span><br><span class="line">  YAxis,</span><br><span class="line">  Tooltip,</span><br><span class="line">  Legend,</span><br><span class="line">  Bar,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">"recharts"</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">CountriesChart</span>(<span class="params">&#123; data, dataKey &#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;BarChart</span><br><span class="line">      width=&#123;<span class="number">1200</span>&#125;</span><br><span class="line">      height=&#123;<span class="number">250</span>&#125;</span><br><span class="line">      style=&#123;&#123; <span class="attr">margin</span>: <span class="string">"auto"</span> &#125;&#125;</span><br><span class="line">      margin=&#123;&#123; <span class="attr">top</span>: <span class="number">30</span>, <span class="attr">left</span>: <span class="number">20</span>, <span class="attr">right</span>: <span class="number">30</span> &#125;&#125;</span><br><span class="line">      data=&#123;data&#125;</span><br><span class="line">    &gt;</span><br><span class="line">      &lt;CartesianGrid strokeDasharray=<span class="string">'3 3'</span> /&gt;</span><br><span class="line">      &lt;XAxis dataKey=<span class="string">'country'</span> /&gt;</span><br><span class="line">      &lt;YAxis /&gt;</span><br><span class="line">      &lt;Tooltip /&gt;</span><br><span class="line">      &lt;Legend /&gt;</span><br><span class="line">      &lt;Bar dataKey=&#123;dataKey&#125; fill=<span class="string">'#8884d8'</span> /&gt;</span><br><span class="line">    &lt;<span class="regexp">/BarChart&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default CountriesChart;</span></span><br></pre></td></tr></table></figure>

<p>åˆ›å»º <code>src/components/SelectDataKey.js</code> ï¼Œç”¨äºé€‰æ‹©éœ€è¦å±•ç¤ºçš„å…³é”®æŒ‡æ ‡ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><figcaption><span>src/components/SelectDataKey.js</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvY292aWQtMTktd2l0aC1ob29rcy9ibG9iL2FjYTE3NzQ2OGVjYjQyMjBhMzM2ZDBkOGY5MWUzNmY5YmRkNzBiOTcvc3JjL2NvbXBvbmVudHMvU2VsZWN0RGF0YUtleS5qcw==" title="https://github.com/tuture-dev/covid-19-with-hooks/blob/aca177468ecb4220a336d0d8f91e36f9bdd70b97/src/components/SelectDataKey.js">æŸ¥çœ‹å®Œæ•´ä»£ç <i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">"react"</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SelectDataKey</span>(<span class="params">&#123; onChange &#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;&gt;</span><br><span class="line">      &lt;label htmlFor=<span class="string">'key-select'</span>&gt;Select a key <span class="keyword">for</span> sorting: &lt;<span class="regexp">/label&gt;</span></span><br><span class="line"><span class="regexp">      &lt;select id='key-select' onChange=&#123;onChange&#125;&gt;</span></span><br><span class="line"><span class="regexp">        &lt;option value='cases'&gt;Cases&lt;/</span>option&gt;</span><br><span class="line">        &lt;option value=<span class="string">'todayCases'</span>&gt;Today Cases&lt;<span class="regexp">/option&gt;</span></span><br><span class="line"><span class="regexp">        &lt;option value='deaths'&gt;Death&lt;/</span>option&gt;</span><br><span class="line">        &lt;option value=<span class="string">'recovered'</span>&gt;Recovered&lt;<span class="regexp">/option&gt;</span></span><br><span class="line"><span class="regexp">        &lt;option value='active'&gt;Active&lt;/</span>option&gt;</span><br><span class="line">      &lt;<span class="regexp">/select&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> SelectDataKey;</span><br></pre></td></tr></table></figure>

<p><code>SelectDataKey</code> ç”¨äºè®©ç”¨æˆ·é€‰æ‹©ä»¥ä¸‹å…³é”®æŒ‡æ ‡ï¼š</p>
<ul>
<li><code>cases</code> ï¼šç´¯ç§¯ç¡®è¯Šç—…ä¾‹</li>
<li><code>todayCases</code> ï¼šä»Šæ—¥ç¡®è¯Šç—…ä¾‹</li>
<li><code>deaths</code> ï¼šç´¯ç§¯æ­»äº¡ç—…ä¾‹</li>
<li><code>recovered</code> ï¼šæ²»æ„ˆäººæ•°</li>
<li><code>active</code> ï¼šç°å­˜ç¡®è¯Šäººæ•°</li>
</ul>
<p>æœ€åæˆ‘ä»¬åœ¨æ ¹ç»„ä»¶ <code>src/App.js</code> ä¸­å¼•å…¥ä¸Šé¢åˆ›å»ºçš„ä¸¤ä¸ªç»„ä»¶ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><figcaption><span>src/App.js</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvY292aWQtMTktd2l0aC1ob29rcy9ibG9iL2FjYTE3NzQ2OGVjYjQyMjBhMzM2ZDBkOGY5MWUzNmY5YmRkNzBiOTcvc3JjL0FwcC5qcw==" title="https://github.com/tuture-dev/covid-19-with-hooks/blob/aca177468ecb4220a336d0d8f91e36f9bdd70b97/src/App.js">æŸ¥çœ‹å®Œæ•´ä»£ç <i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="keyword">import</span> GlobalStats <span class="keyword">from</span> <span class="string">"./components/GlobalStats"</span>;</span><br><span class="line">[tuture-add]<span class="keyword">import</span> CountriesChart <span class="keyword">from</span> <span class="string">"./components/CountriesChart"</span>;</span><br><span class="line">[tuture-add]<span class="keyword">import</span> SelectDataKey <span class="keyword">from</span> <span class="string">"./components/SelectDataKey"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> BASE_URL = <span class="string">"https://corona.lmao.ninja/v2"</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> [globalStats, setGlobalStats] = useState(&#123;&#125;);</span><br><span class="line">[tuture-add]  <span class="keyword">const</span> [countries, setCountries] = useState([]);</span><br><span class="line">[tuture-add]  <span class="keyword">const</span> [key, setKey] = useState(<span class="string">"cases"</span>);</span><br><span class="line"></span><br><span class="line">  useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">[tuture-add]  useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">[tuture-add]    <span class="keyword">const</span> fetchCountries = <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">[tuture-add]      <span class="keyword">const</span> response = <span class="keyword">await</span> fetch(<span class="string">`<span class="subst">$&#123;BASE_URL&#125;</span>/countries?sort=<span class="subst">$&#123;key&#125;</span>`</span>);</span><br><span class="line">[tuture-add]      <span class="keyword">const</span> data = <span class="keyword">await</span> response.json();</span><br><span class="line">[tuture-add]      setCountries(data.slice(<span class="number">0</span>, <span class="number">10</span>));</span><br><span class="line">[tuture-add]    &#125;;</span><br><span class="line">[tuture-add] </span><br><span class="line">[tuture-add]    fetchCountries();</span><br><span class="line">[tuture-add]  &#125;, [key]);</span><br><span class="line">[tuture-add] </span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div className=<span class="string">'App'</span>&gt;</span><br><span class="line">      &lt;h1&gt;COVID<span class="number">-19</span>&lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">      &lt;GlobalStats stats=&#123;globalStats&#125; /</span>&gt;</span><br><span class="line">[tuture-add]      &lt;SelectDataKey onChange=&#123;(e) =&gt; setKey(e.target.value)&#125; /&gt;</span><br><span class="line">[tuture-add]      &lt;CountriesChart data=&#123;countries&#125; dataKey=&#123;key&#125; /&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default App;</span></span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°ï¼š</p>
<ol>
<li>æˆ‘ä»¬åˆ›å»ºäº†ä¸¤ä¸ªæ–°çš„çŠ¶æ€ <code>countries</code> ï¼ˆæ‰€æœ‰å›½å®¶çš„æ•°æ®ï¼‰å’Œ <code>key</code> ï¼ˆæ•°æ®æ’åºçš„æŒ‡æ ‡ï¼Œå°±æ˜¯ä¸Šé¢çš„äº”ä¸ªï¼‰ï¼›</li>
<li>æˆ‘ä»¬åˆé€šè¿‡ä¸€ä¸ª <code>useEffect</code> é’©å­è¿›è¡Œæ•°æ®è·å–ï¼Œå’Œä¹‹å‰è·å–å…¨çƒæ•°æ®ç±»ä¼¼ï¼Œåªä¸è¿‡æ³¨æ„æˆ‘ä»¬è¿™è¾¹ç¬¬äºŒä¸ªå‚æ•°ï¼ˆä¾èµ–æ•°ç»„ï¼‰æ˜¯ <code>[key]</code> ï¼Œä¹Ÿå°±æ˜¯åªæœ‰å½“ <code>key</code> çŠ¶æ€æ”¹å˜çš„æ—¶å€™ï¼Œæ‰ä¼šè°ƒç”¨ <code>useEffect</code> é‡Œé¢çš„å‡½æ•°ã€‚</li>
<li>æœ€åä½¿ç”¨ä¹‹å‰åˆ›å»ºçš„ä¸¤ä¸ªå­ç»„ä»¶ï¼Œä¼ å…¥ç›¸åº”çš„æ•°æ®å’Œå›è°ƒå‡½æ•°ã€‚</li>
</ol>
<p>æŠŠé¡¹ç›®è·‘èµ·æ¥ï¼Œå¯ä»¥çœ‹åˆ°ç›´æ–¹å›¾æ˜¾ç¤ºäº†å‰åä¸ªå›½å®¶çš„æ•°æ®ï¼Œå¹¶ä¸”å¯ä»¥ä¿®æ”¹æ’åºçš„æŒ‡æ ‡ï¼ˆæ¯”å¦‚å¯ä»¥ä»é»˜è®¤çš„ç´¯ç§¯ç¡®è¯Š <code>cases</code> åˆ‡æ¢æˆæ­»äº¡äººæ•° <code>deaths</code> ï¼‰ï¼š</p>
<p><img alt data-src="https://static.powerformer.com/c/870a7b7/171786607417628c.gif"></p>
<p>çœ‹ä¸Šå»æŒºä¸é”™çš„ï¼</p>
<p>åˆ°è¿™é‡Œï¼Œæœ¬ç³»åˆ—ç¬¬ä¸€ç¯‡ä¹Ÿå°±è®²å®Œå•¦ï¼Œå¸Œæœ›ä½ çœŸæ­£ç†è§£äº† <code>useState</code> å’Œ <code>useEffect</code> â€”â€”æœ€æœ€æœ€å¸¸ç”¨çš„ä¸¤ä¸ª Hookã€‚åœ¨ä¸‹ä¸€ç¯‡æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†ç»§ç»­è®²è§£è‡ªå®šä¹‰ Hook å’Œ <code>useCallback</code> ï¼Œæ•¬è¯·æœŸå¾…ã€‚</p>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9yZWFjdGpzLm9yZy8=" title="https://reactjs.org/">React å®˜æ–¹æ–‡æ¡£<i class="fa fa-external-link"></i></span></li>
<li>Robin Wieruchï¼š<span class="exturl" data-url="aHR0cHM6Ly93d3cucm9iaW53aWVydWNoLmRlL3JlYWN0LWhvb2tzLWZldGNoLWRhdGE=" title="https://www.robinwieruch.de/react-hooks-fetch-data">How to fetch data with React Hooks?<i class="fa fa-external-link"></i></span></li>
<li>Dan Abramovï¼š<span class="exturl" data-url="aHR0cHM6Ly9vdmVycmVhY3RlZC5pby9hLWNvbXBsZXRlLWd1aWRlLXRvLXVzZWVmZmVjdC8=" title="https://overreacted.io/a-complete-guide-to-useeffect/">A Complete Guide to useEffect<i class="fa fa-external-link"></i></span></li>
<li>Dan Abramovï¼š<span class="exturl" data-url="aHR0cHM6Ly9vdmVycmVhY3RlZC5pby9ob3ctYXJlLWZ1bmN0aW9uLWNvbXBvbmVudHMtZGlmZmVyZW50LWZyb20tY2xhc3Nlcy8=" title="https://overreacted.io/how-are-function-components-different-from-classes/">How Are Function Components Different from Classes?<i class="fa fa-external-link"></i></span></li>
<li>Rudi Yardleyï¼š<span class="exturl" data-url="aHR0cHM6Ly9tZWRpdW0uY29tL0ByeWFyZGxleS9yZWFjdC1ob29rcy1ub3QtbWFnaWMtanVzdC1hcnJheXMtY2Q0ZjE4NTcyMzZl" title="https://medium.com/@ryardley/react-hooks-not-magic-just-arrays-cd4f1857236e">React hooks: not magic, just arrays<i class="fa fa-external-link"></i></span></li>
<li>Eytan Manorï¼š<span class="exturl" data-url="aHR0cHM6Ly9tZWRpdW0uY29tL3RoZS1ndWlsZC91bmRlci10aGUtaG9vZC1vZi1yZWFjdHMtaG9va3Mtc3lzdGVtLWViNTk2MzhjOWRiYQ==" title="https://medium.com/the-guild/under-the-hood-of-reacts-hooks-system-eb59638c9dba">Under the hood of Reactâ€™s hooks system<i class="fa fa-external-link"></i></span></li>
<li>è¡è‰¯ï¼š<span class="exturl" data-url="aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC85MjIxMTUzMw==" title="https://zhuanlan.zhihu.com/p/92211533">React Hooks å®Œå…¨ä¸Šæ‰‹æŒ‡å—<i class="fa fa-external-link"></i></span></li>
<li>å¼ ç«‹ç†ï¼š<span class="exturl" data-url="aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC80ODI2NDcxMw==" title="https://zhuanlan.zhihu.com/p/48264713">å¯¹ React Hooks çš„ä¸€äº›æ€è€ƒ<i class="fa fa-external-link"></i></span></li>
</ul>

    </div>

    
    
    
      

        <div id="qrcode_subscriber-container">
  <div></div>

  <div id="qrocde-qr">
        
      
      <div style="display: inline-block">
        <img src="/uploads/wechat-qcode.png" alt="å›¾é›€ç¤¾åŒº å¾®ä¿¡å…¬ä¼—å·">
        <p>æ‰«ä¸€æ‰«å…³æ³¨ä¸Šæ–¹å…¬ä¼—å·ï¼Œæ‹‰å­¦ä¹ ç¾¤å’Œç­”ç–‘è§£æƒ‘</p>
      </div>

  </div>
</div>

      
        
      
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>æœ¬æ–‡ä½œè€…ï¼š </strong>å›¾é›€ç¤¾åŒº</li>
  <li class="post-copyright-link">
    <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong>
    <a href="https://tuture.co/2020/04/08/870a7b7/" title="ç”¨åŠ¨ç”»å’Œå®æˆ˜æ‰“å¼€ React Hooksï¼ˆä¸€ï¼‰ï¼šuseState å’Œ useEffect">https://tuture.co/2020/04/08/870a7b7/</a>
  </li>
  <li class="post-copyright-license">
    <strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC8="><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</span> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</li>
</ul>
</div>

      

      <footer class="post-footer">
          
            
          
          <div class="post-tags">
            
              <a href="/tags/React/" rel="tag"><i class="fa fa-tag"></i> React</a>
            
              <a href="/tags/React-Hooks/" rel="tag"><i class="fa fa-tag"></i> React Hooks</a>
            
          </div>
        

        

          <div class="post-nav">
            <div class="post-nav-next post-nav-item">
              
                <a href="/2020/04/06/H2r1tpF/" rel="next" title="ç±»å‹å³æ­£ä¹‰ï¼šTypeScript ä»å…¥é—¨åˆ°å®è·µï¼ˆäºŒï¼‰">
                  <i class="fa fa-chevron-left"></i> ç±»å‹å³æ­£ä¹‰ï¼šTypeScript ä»å…¥é—¨åˆ°å®è·µï¼ˆäºŒï¼‰
                </a>
              
            </div>

            <span class="post-nav-divider"></span>

            <div class="post-nav-prev post-nav-item">
              
                <a href="/2020/04/14/xocgOEM/" rel="prev" title="ç”¨åŠ¨ç”»å’Œå®æˆ˜æ‰“å¼€ React Hooksï¼ˆäºŒï¼‰ï¼šè‡ªå®šä¹‰ Hook å’Œ useCallback">
                  ç”¨åŠ¨ç”»å’Œå®æˆ˜æ‰“å¼€ React Hooksï¼ˆäºŒï¼‰ï¼šè‡ªå®šä¹‰ Hook å’Œ useCallback <i class="fa fa-chevron-right"></i>
                </a>
              
            </div>
          </div>
        
      </footer>
    
  </div>
  
  
  
  </article>

  </div>


          </div>
          
    
    <div class="comments" id="gitalk-container"></div>
  

        </div>
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">
      <div>
          
          
          
          
        

        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc">
            æ–‡ç« ç›®å½•
          </li>
          <li class="sidebar-nav-overview">
            ç«™ç‚¹æ¦‚è§ˆ
          </li>
        </ul>

        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#èµ·æ­¥"><span class="nav-number">1.</span> <span class="nav-text">èµ·æ­¥</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#å‰ææ¡ä»¶"><span class="nav-number">1.1.</span> <span class="nav-text">å‰ææ¡ä»¶</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ä¸ºä»€ä¹ˆä¼šæœ‰-Hooksï¼Ÿ"><span class="nav-number">1.2.</span> <span class="nav-text">ä¸ºä»€ä¹ˆä¼šæœ‰ Hooksï¼Ÿ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ä¸ºä»€ä¹ˆè¦å†™è¿™ä¸€ç³»åˆ—-Hooks-æ•™ç¨‹ï¼Ÿ"><span class="nav-number">1.3.</span> <span class="nav-text">ä¸ºä»€ä¹ˆè¦å†™è¿™ä¸€ç³»åˆ— Hooks æ•™ç¨‹ï¼Ÿ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#åˆå§‹åŒ–é¡¹ç›®"><span class="nav-number">1.4.</span> <span class="nav-text">åˆå§‹åŒ–é¡¹ç›®</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#useState-useEffectï¼šåˆæ¥ä¹åˆ°"><span class="nav-number">2.</span> <span class="nav-text">useState + useEffectï¼šåˆæ¥ä¹åˆ°</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ç†è§£å‡½æ•°å¼ç»„ä»¶çš„è¿è¡Œè¿‡ç¨‹"><span class="nav-number">2.1.</span> <span class="nav-text">ç†è§£å‡½æ•°å¼ç»„ä»¶çš„è¿è¡Œè¿‡ç¨‹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#useState-ä½¿ç”¨æµ…æ"><span class="nav-number">2.2.</span> <span class="nav-text">useState ä½¿ç”¨æµ…æ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#useEffect-ä½¿ç”¨æµ…æ"><span class="nav-number">2.3.</span> <span class="nav-text">useEffect ä½¿ç”¨æµ…æ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å®æˆ˜ç¯èŠ‚"><span class="nav-number">2.4.</span> <span class="nav-text">å®æˆ˜ç¯èŠ‚</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#useState-useEffectï¼šæ¸å…¥ä½³å¢ƒ"><span class="nav-number">3.</span> <span class="nav-text">useState + useEffectï¼šæ¸å…¥ä½³å¢ƒ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#æ·±å…¥-useState-çš„æœ¬è´¨"><span class="nav-number">3.1.</span> <span class="nav-text">æ·±å…¥ useState çš„æœ¬è´¨</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æ·±å…¥-useEffect-çš„æœ¬è´¨"><span class="nav-number">3.2.</span> <span class="nav-text">æ·±å…¥ useEffect çš„æœ¬è´¨</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ä¸è¦æ’’è°ï¼šå…³äº-deps-çš„é‚£äº›äº‹"><span class="nav-number">3.3.</span> <span class="nav-text">ä¸è¦æ’’è°ï¼šå…³äº deps çš„é‚£äº›äº‹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å®æˆ˜ç¯èŠ‚-1"><span class="nav-number">3.4.</span> <span class="nav-text">å®æˆ˜ç¯èŠ‚</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å‚è€ƒèµ„æ–™"><span class="nav-number">4.</span> <span class="nav-text">å‚è€ƒèµ„æ–™</span></a></li></ol></div>
          
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" src="/images/avatar.png" alt="å›¾é›€ç¤¾åŒº">
  <p class="site-author-name" itemprop="name">å›¾é›€ç¤¾åŒº</p>
  <div class="site-description" itemprop="description">ç”± <a href="https://github.com/tuture-dev/tuture" target="_blank" rel="external nofollow noopener noreferrer">Tuture</a> å·¥å…·å†™æˆï¼Œè¿™é‡Œæ±‡é›†äº†èƒ½å¤Ÿè®©ä½ ä»å¤´æ•²åˆ°å°¾å¹¶åšå‡ºå¯è¿è¡Œé¡¹ç›®çš„ç²¾å½©çš„å…è´¹æŠ€æœ¯æ•™ç¨‹</div>
</div>
  <div class="feed-link motion-element">
    <a href="/atom.xml" rel="alternate">
      <i class="fa fa-rss"></i>RSS
    </a>
  </div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <span class="exturl" data-url="aHR0cHM6Ly9qdWVqaW4uaW0vdXNlci81YjMzNDE0MzUxODgyNTc0Yjk2OTRkMjg="><i class="fa fa-fw fa-custom juejin"></i>æ˜é‡‘</span>
      </span>
    
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <a href="/images/social/wechat.png"><i class="fa fa-fw fa-custom wechat"></i>å¾®ä¿¡</a>
      </span>
    
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <span class="exturl" data-url="aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vdHV0dXJl"><i class="fa fa-fw fa-custom zhihu"></i>çŸ¥ä¹</span>
      </span>
    
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXY="><i class="fa fa-fw fa-github"></i>GitHub</span>
      </span>
    
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright"><span class="exturl" data-url="aHR0cDovL3d3dy5iZWlhbi5taWl0Lmdvdi5jbg==">æ²ªICPå¤‡19039313å· </span><span><img src="/images/gongan-url.png" style="display:inline-block;">
  
  <span class="exturl" data-url="aHR0cDovL3d3dy5iZWlhbi5nb3YuY24vcG9ydGFsL3JlZ2lzdGVyU3lzdGVtSW5mbz9yZWNvcmRjb2RlPTMxMDExNzAyMDA3MTMw">æ²ªå…¬ç½‘å®‰å¤‡ 31011702007130å· </span>&copy; <span itemprop="copyrightYear">2021</span>
  <span class="with-love" id="animate">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">å›¾é›€ç¤¾åŒº</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    <span title="ç«™ç‚¹æ€»å­—æ•°">891k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">13:30</span>
</span></div>
  <div class="powered-by">ç”± <span class="exturl theme-link" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> å¼ºåŠ›é©±åŠ¨ v4.2.1</div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">ä¸»é¢˜ â€“ <span class="exturl theme-link" data-url="aHR0cHM6Ly90aGVtZS1uZXh0Lm9yZw==">NexT.Pisces</span> v7.4.0</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
</div>












        
      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js?v=3.1.0"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js"></script>

<script src="/js/utils.js?v=7.4.0.js"></script>


<script src="/js/schemes/pisces.js?v=7.4.0.js"></script>


<script src="/js/next-boot.js?v=7.4.0.js"></script>

<script src="/js/bookmark.js?v=7.4.0.js"></script>




  
  <script>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      bp.src = (curProtocol === 'https') ? 'https://zz.bdstatic.com/linksubmit/push.js' : 'http://push.zhanzhang.baidu.com/push.js';
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>








  
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/instantsearch.js@2/dist/instantsearch.min.css">
<script src="//cdn.jsdelivr.net/npm/instantsearch.js@2/dist/instantsearch.min.js"></script>
<script src="/js/algolia-search.js?v=7.4.0.js"></script>
















  

  

  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID: '6310753ce4e95163d2b0',
      clientSecret: '4fd6839b697f9d50e01eebbb9566d8bdf3bd75b4',
      repo: 'comments',
      owner: 'tuture-dev',
      admin: 'pftom,mRcfps,tuture-dev'.split(','),
      id: '74f97df1b4614e688d14b9653fdfc2b8',
        language: 'zh-CN',
      
      distractionFreeMode: 'true'
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
</script>


  <script>
    const line = document.getElementsByClassName('line');
    const arrLine = Array.from(line);

    const delRegex = /\[.*tuture.*-.*del.*?\]/;
    const addRegex = /\[.*tuture.*-.*add.*?\]/;
    const omitRegex = /\[.*tuture.*-.*omit.*?\]/;

    const delSpaceRegex = /^\s*\[.*tuture.*-.*del.*?\]\s*$/;
    const addSpaceRegex = /^\s*\[.*tuture.*-.*add.*?\]\s*$/;
    const omitSpaceRegex = /^\s*\[.*tuture.*-.*omit.*?\]\s*$/;

    arrLine.map(item => {
      if (item.innerText.startsWith('[tuture-add]')) {
        if (addSpaceRegex.test(item.innerText)) {
          item.innerHTML = item.innerHTML.replace(addRegex, ' ');
        } else {
          item.innerHTML = item.innerHTML.replace(addRegex, '');
        }

          item.className = item.className + ' tuture-add';
      } else if (item.innerText.startsWith('[tuture-del]')) {
          if (delSpaceRegex.test(item.innerText)) {
            item.innerHTML = item.innerHTML.replace(delRegex, ' ');
          } else {
            item.innerHTML = item.innerHTML.replace(delRegex, '');
          }

          item.className = item.className + ' tuture-del';
      } else if (item.innerText.startsWith('[tuture-omit]')) {
        item.innerHTML = item.innerHTML.replace(omitRegex, '...');
        item.className = item.className + ' tuture-omit';
      }
    })
  </script>
</body>
</html>
