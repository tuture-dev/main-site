<!DOCTYPE html>





<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <meta name="keywords" content="å›¾é›€ç¤¾åŒº,Tuture,Vue.jså®æˆ˜æ•™ç¨‹,å¾®ä¿¡å°ç¨‹åº,Kotlin,React Native,Webpack,MVVM,React.js,Node.js,Redux,Django,MongoDB,Docker,JavaScript,Java,Go,Kubernetes,Nuxt,vue-router,react-router,å°ç¨‹åº,è·¨ç«¯å¼€å‘,Taro,react hooks,redux-saga,learn by doing,Web å‰ç«¯å®æˆ˜æ•™ç¨‹,åç«¯å®æˆ˜æ•™ç¨‹,å°ç¨‹åºå®æˆ˜æ•™ç¨‹,ç§»åŠ¨ç«¯å®æˆ˜æ•™ç¨‹">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png?v=7.4.0">
  <link rel="mask-icon" href="/images/logo.svg?v=7.4.0" color="#222">
  <link rel="manifest" href="/images/manifest.json">
  <meta name="msapplication-config" content="/images/browserconfig.xml">
  <link rel="alternate" href="/atom.xml" title="å›¾é›€ç¤¾åŒº" type="application/atom+xml">
  <meta name="google-site-verification" content="uDCHIeBD5phhUIjsHM8GYeoNBYWJuQIJBjgchamUcAI">
  <meta name="yandex-verification" content="90341ba6c811f41d">

<link rel="stylesheet" href="/css/main.css?v=7.4.0">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '7.4.0',
    exturl: true,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":true,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":true},
    bookmark: {"enable":true,"color":"#222","save":"auto"},
    fancybox: true,
    mediumzoom: false,
    lazyload: true,
    pangu: true,
    algolia: {
      appID: '73BSUE4RKU',
      apiKey: '0b7cce26a4734cb760080065b3c4a4a1',
      indexName: 'Tuture',
      hits: {"per_page":10},
      labels: {"input_placeholder":"æœç´¢æ•™ç¨‹","hits_empty":"æˆ‘ä»¬æ‰¾ä¸åˆ°ä½ æœç´¢çš„æ•™ç¨‹: ${query}","hits_stats":"åœ¨ ${time} ms å†…æ‰¾åˆ° ${hits} æ¡ç»“æœ"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: 'å¤åˆ¶',
      copy_success: 'å¤åˆ¶æˆåŠŸ',
      copy_failure: 'å¤åˆ¶å¤±è´¥'
    },
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="ä¸ºäº†è®©æˆ‘ä»¬çš„åšå®¢çœ‹èµ·æ¥æ›´åŠ ä¸“ä¸šï¼Œæˆ‘ä»¬æ‰“ç®—ç»™å®ƒä¹ŸåŠ ä¸Šæ•´ä¸Šä¸€ä¸ªä¸“ä¸šçš„ç”¨æˆ·ç³»ç»Ÿï¼Œæœ‰äº†æœ€ä¸ºæ ¸å¿ƒçš„ç”¨æˆ·ç³»ç»Ÿåœ¨ï¼Œæˆ‘ä»¬åšå®¢ä¹‹åçš„æ‰©å±•éƒ½å¯ä»¥æ¸¸åˆƒæœ‰ä½™ï¼Œä½†æ˜¯æ®ç»Ÿè®¡ï¼Œä¸€ä¸ªåº”ç”¨è¦æƒ³æ‰“é€ ä¸€ä¸ªæ¯”è¾ƒä¸“ä¸šçš„ç”¨æˆ·ç³»ç»Ÿï¼Œè‡³å°‘éœ€è¦èŠ±è´¹å‡ ä¸ªæœˆæ—¶é—´ï¼Œè¿˜éœ€è¦èŠ±å¤§é‡çš„ç²¾åŠ›å»ç»´æŠ¤æ‰“é€ å‡ºæ¥çš„ç”¨æˆ·ç³»ç»Ÿï¼Œæ‰€åœ¨åœ¨åšäº†ä¸€ç•ªè°ƒç ”ä¹‹åï¼Œæˆ‘ä»¬å°†ç›®æ ‡æ”¾åœ¨äº†ä¸€ä¸ªå«åš Authing çš„é€šç”¨äº‘èº«ä»½å¹³å°ï¼Œå®ƒæä¾›çš„æœåŠ¡å°±æ˜¯å¸®åº”ç”¨å¿«é€Ÿé›†æˆä¸€ä¸ªé«˜æ•ˆã€å®‰å…¨çš„ç”¨æˆ·ç³»ç»Ÿï¼Œè€Œæˆ‘ä»¬">
<meta property="og:type" content="article">
<meta property="og:title" content="Taro å°ç¨‹åºå¼€å‘å¤§å‹å®æˆ˜ï¼ˆä¸ƒï¼‰ï¼šä½¿ç”¨ Authing æ‰“é€ å®Œæ•´ä¸”å¼ºå¤§çš„ç”¨æˆ·ç³»ç»Ÿ">
<meta property="og:url" content="https://tuture.co/2020/05/17/2b5a9f1/index.html">
<meta property="og:site_name" content="å›¾é›€ç¤¾åŒº">
<meta property="og:description" content="ä¸ºäº†è®©æˆ‘ä»¬çš„åšå®¢çœ‹èµ·æ¥æ›´åŠ ä¸“ä¸šï¼Œæˆ‘ä»¬æ‰“ç®—ç»™å®ƒä¹ŸåŠ ä¸Šæ•´ä¸Šä¸€ä¸ªä¸“ä¸šçš„ç”¨æˆ·ç³»ç»Ÿï¼Œæœ‰äº†æœ€ä¸ºæ ¸å¿ƒçš„ç”¨æˆ·ç³»ç»Ÿåœ¨ï¼Œæˆ‘ä»¬åšå®¢ä¹‹åçš„æ‰©å±•éƒ½å¯ä»¥æ¸¸åˆƒæœ‰ä½™ï¼Œä½†æ˜¯æ®ç»Ÿè®¡ï¼Œä¸€ä¸ªåº”ç”¨è¦æƒ³æ‰“é€ ä¸€ä¸ªæ¯”è¾ƒä¸“ä¸šçš„ç”¨æˆ·ç³»ç»Ÿï¼Œè‡³å°‘éœ€è¦èŠ±è´¹å‡ ä¸ªæœˆæ—¶é—´ï¼Œè¿˜éœ€è¦èŠ±å¤§é‡çš„ç²¾åŠ›å»ç»´æŠ¤æ‰“é€ å‡ºæ¥çš„ç”¨æˆ·ç³»ç»Ÿï¼Œæ‰€åœ¨åœ¨åšäº†ä¸€ç•ªè°ƒç ”ä¹‹åï¼Œæˆ‘ä»¬å°†ç›®æ ‡æ”¾åœ¨äº†ä¸€ä¸ªå«åš Authing çš„é€šç”¨äº‘èº«ä»½å¹³å°ï¼Œå®ƒæä¾›çš„æœåŠ¡å°±æ˜¯å¸®åº”ç”¨å¿«é€Ÿé›†æˆä¸€ä¸ªé«˜æ•ˆã€å®‰å…¨çš„ç”¨æˆ·ç³»ç»Ÿï¼Œè€Œæˆ‘ä»¬">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://static.powerformer.com/c/34a473b/taro-cover-9.jpg">
<meta property="article:published_time" content="2020-05-16T17:37:06.464Z">
<meta property="article:modified_time" content="2021-08-08T15:06:45.318Z">
<meta property="article:author" content="å›¾é›€ç¤¾åŒº">
<meta property="article:tag" content="Taro">
<meta property="article:tag" content="ç”¨æˆ·ç³»ç»Ÿ">
<meta property="article:tag" content="é‰´æƒ">
<meta property="article:tag" content="è®¤è¯">
<meta property="article:tag" content="OAuth">
<meta property="article:tag" content="å¾®ä¿¡ç™»å½•">
<meta property="article:tag" content="QQç™»å½•">
<meta property="article:tag" content="Githubç™»å½•">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://static.powerformer.com/c/34a473b/taro-cover-9.jpg">
  <link rel="canonical" href="https://tuture.co/2020/05/17/2b5a9f1/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>Taro å°ç¨‹åºå¼€å‘å¤§å‹å®æˆ˜ï¼ˆä¸ƒï¼‰ï¼šä½¿ç”¨ Authing æ‰“é€ å®Œæ•´ä¸”å¼ºå¤§çš„ç”¨æˆ·ç³»ç»Ÿ | å›¾é›€ç¤¾åŒº</title>
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-124499211-1"></script>
  <script>
    var host = window.location.hostname;
    if (host !== "localhost" || !true) {
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-124499211-1');
    }
  </script>








  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

  <style>
    span.line.tuture-add {
      font-weight: bold;
    }

    span.line.tuture-del {
      opacity: 0.3;
    }

    .profileBox {
      display: flex;
      flex-direction: row;
      justify-content: center;
      align-items: center;
      flex-wrap: wrap;
    }

    .profileBox i {
      display: none;
    }

    .profileBox p {
      margin: 0;
      padding: 0;
    }

    .avatarBox {
      min-width: 60px;
    }

    .avatarBox .avatar {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      margin: 0;
    }

    .avatarBox .avatar:hover {
      cursor: pointer;
    }

    .avatarBox {
      margin-right: 20px;
    }

    .rightBox {
      display:flex;
      flex-direction: row;
      justify-content: flex-start;
      align-items: center;
    }

    .infoBox {
      min-width: 100px;
    }

    .infoBox p {
      padding: 0;
      margin: 0;
    }

    .infoBox .nickName {
      font-weight: bold;
      font-size: 20px;
      color: #979797;
      text-decoration: none;
    }

    .infoBox .nickName:hover {
      cursor: pointer;
    }

    .infoBox .motto {
      font-size: 16px;
      color: #979797;
    }

    .codeBox {
      margin-left: 49px;
      min-width: 100px;
    }

    .codeBox a {
      text-decoration: none;
    }

    .codeBox .exturl {
      border: none;
    }

    .codeBox span.codeText {
      display: inline-block;
      width: 100px;
      height: 40px;
      border-radius: 4px;
      border: 1px solid #979797;
      color: #979797;
      text-align: center;
      line-height: 40px;
      text-decoration: none;;
      transition: all 0.2s ease-in-out;
    }

    .codeBox .codeText:hover {
      cursor: pointer;
      background-color: #979797;
      color: #ffffff;
    }

    @media screen and (max-width:652px) {
      .profileBox {
        align-items: center;
        flex-direction: column;
      }

      .infoBox {
        margin-bottom: 20px;
      }

      .infoBox .nickName {
        text-align: center;
      }

      .rightBox {
        flex-direction: column;
        align-items: flex-start;
      }

      .codeBox {
        margin-left: 0;
      }

      .avatarBox {
        margin-right: 0;
      }
    }

    @media screen and (max-width:500px) {
      .rightBox {
        align-items: center;
      }

      .infoBox {
        margin-bottom: 20px;
      }

      .infoBox .nickName {
        text-align: center;
      }

      .infoBox .motto {
        text-align: center;
      }
    }

    .vsys {
      display:none !important;
      }

      figcaption .exturl {
        float: right;
      }
  </style>
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.15.10/build/styles/default.min.css">
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">
  <div class="container">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">å›¾é›€ç¤¾åŒº</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <h1 class="site-subtitle" itemprop="description">æ±‡é›†ç²¾å½©çš„å®æˆ˜æŠ€æœ¯æ•™ç¨‹</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
      
      
      
        
        <li class="menu-item menu-item-home">
      
    
      
      
        
      
        
      
        
      
        
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>é¦–é¡µ</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-tags">
      
    
      
      
        
      
        
      
        
          
        
      
        
      
    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>æ ‡ç­¾<span class="badge">45</span></a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-categories">
      
    
      
      
        
      
        
          
        
      
        
      
        
      
    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>åˆ†ç±»<span class="badge">22</span></a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-archives">
      
    
      
      
        
          
        
      
        
      
        
      
        
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>å½’æ¡£<span class="badge">58</span></a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-æ—©æŠ¥">
      
    
      
      
        
      
        
      
        
      
        
      
    

    <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvZGFpbHk="><i class="menu-item-icon fa fa-fw fa-calendar"></i> <br>æ—©æŠ¥</span>

  </li>
      
      
      
        
        <li class="menu-item menu-item-about">
      
    
      
      
        
      
        
      
        
      
        
      
    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>å…³äº</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-æ–‡æ¡£">
      
    
      
      
        
      
        
      
        
      
        
      
    

    <span class="exturl" data-url="aHR0cHM6Ly93d3cueXVxdWUuY29tL3R1dHVyZS9wcm9kdWN0LW1hbnVhbHM="><i class="menu-item-icon fa fa-fw fa-book"></i> <br>æ–‡æ¡£</span>

  </li>
      
      
      
        
        <li class="menu-item menu-item-faq">
      
    
      
      
        
      
        
      
        
      
        
      
    

    <a href="/FAQ" rel="section"><i class="menu-item-icon fa fa-fw fa-question"></i> <br>FAQ</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger">
        
          <i class="menu-item-icon fa fa-search fa-fw"></i> <br>æœç´¢</a>
      </li>
    
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input" id="search-input"></div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="algolia-results">
  <div id="algolia-stats"></div>
  <div id="algolia-hits"></div>
  <div id="algolia-pagination" class="algolia-pagination"></div>
</div>

  
</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <span class="exturl github-corner" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZXByb2plY3QvaHVi" title="Follow me on GitHub" aria-label="Follow me on GitHub"><svg width="80" height="80" viewbox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></span>


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
            

          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
      <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block post">
    <link itemprop="mainEntityOfPage" href="https://tuture.co/2020/05/17/2b5a9f1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="å›¾é›€ç¤¾åŒº">
      <meta itemprop="description" content="å›¾é›€ç¤¾åŒºæ˜¯ä¸€ä¸ªä¾›å¤§å®¶åˆ†äº«ç”¨ Tuture å†™ä½œå·¥å…·å®Œæˆçš„æ•™ç¨‹çš„ä¸€ä¸ªå¹³å°ã€‚åœ¨è¿™é‡Œï¼Œè¯»è€…ä»¬å¯ä»¥å°½æƒ…äº«å—é«˜è´¨é‡ä¸”å…è´¹çš„å®æˆ˜æ•™ç¨‹ï¼Œå¹¶èƒ½ä¸ä½œè€…å’Œå…¶ä»–è¯»è€…äº’åŠ¨å’Œè®¨è®ºï¼›è€Œä½œè€…ä»¬ä¹Ÿå¯ä»¥å€Ÿæ­¤ä¼ æ’­ä»–ä»¬çš„æŠ€æœ¯çŸ¥è¯†ï¼Œå®£ä¼ ä»–ä»¬çš„å¼€æºé¡¹ç›®ï¼Œæ‰¾åˆ°è‡ªå·±è¾“å‡ºå†…å®¹çš„å—ä¼—ï¼ŒåŠ é€ŸæŠ€æœ¯çš„ä¼ æ’­ã€‚">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="å›¾é›€ç¤¾åŒº">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">Taro å°ç¨‹åºå¼€å‘å¤§å‹å®æˆ˜ï¼ˆä¸ƒï¼‰ï¼šä½¿ç”¨ Authing æ‰“é€ å®Œæ•´ä¸”å¼ºå¤§çš„ç”¨æˆ·ç³»ç»Ÿ

          
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              
                
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-05-17 01:37:06" itemprop="dateCreated datePublished" datetime="2020-05-17T01:37:06+08:00">2020-05-17</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-08-08 23:06:45" itemprop="dateModified" datetime="2021-08-08T23:06:45+08:00">2021-08-08</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E5%B0%8F%E7%A8%8B%E5%BA%8F/" itemprop="url" rel="index"><span itemprop="name">å°ç¨‹åº</span></a></span>

                
                
                  ï¼Œ
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E5%B0%8F%E7%A8%8B%E5%BA%8F/Taro/" itemprop="url" rel="index"><span itemprop="name">Taro</span></a></span>

                
                
                  ï¼Œ
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E5%B0%8F%E7%A8%8B%E5%BA%8F/Taro/%E8%BF%9B%E9%98%B6/" itemprop="url" rel="index"><span itemprop="name">è¿›é˜¶</span></a></span>

                
                
              
            </span>
          

          
            <span class="post-meta-item" title="é˜…è¯»æ¬¡æ•°" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
          
          <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
              
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              
              <span>33k</span>
            </span>
          
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
              
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              
              <span>30 åˆ†é’Ÿ</span>
            </span>
          
            <div class="post-description">ä¸ºäº†è®©æˆ‘ä»¬çš„åšå®¢çœ‹èµ·æ¥æ›´åŠ ä¸“ä¸šï¼Œæˆ‘ä»¬æ‰“ç®—ç»™å®ƒä¹ŸåŠ ä¸Šæ•´ä¸Šä¸€ä¸ªä¸“ä¸šçš„ç”¨æˆ·ç³»ç»Ÿï¼Œæœ‰äº†æœ€ä¸ºæ ¸å¿ƒçš„ç”¨æˆ·ç³»ç»Ÿåœ¨ï¼Œæˆ‘ä»¬åšå®¢ä¹‹åçš„æ‰©å±•éƒ½å¯ä»¥æ¸¸åˆƒæœ‰ä½™ï¼Œä½†æ˜¯æ®ç»Ÿè®¡ï¼Œä¸€ä¸ªåº”ç”¨è¦æƒ³æ‰“é€ ä¸€ä¸ªæ¯”è¾ƒä¸“ä¸šçš„ç”¨æˆ·ç³»ç»Ÿï¼Œè‡³å°‘éœ€è¦èŠ±è´¹å‡ ä¸ªæœˆæ—¶é—´ï¼Œè¿˜éœ€è¦èŠ±å¤§é‡çš„ç²¾åŠ›å»ç»´æŠ¤æ‰“é€ å‡ºæ¥çš„ç”¨æˆ·ç³»ç»Ÿï¼Œæ‰€åœ¨åœ¨åšäº†ä¸€ç•ªè°ƒç ”ä¹‹åï¼Œæˆ‘ä»¬å°†ç›®æ ‡æ”¾åœ¨äº†ä¸€ä¸ªå«åš Authing çš„é€šç”¨äº‘èº«ä»½å¹³å°ï¼Œå®ƒæä¾›çš„æœåŠ¡å°±æ˜¯å¸®åº”ç”¨å¿«é€Ÿé›†æˆä¸€ä¸ªé«˜æ•ˆã€å®‰å…¨çš„ç”¨æˆ·ç³»ç»Ÿï¼Œè€Œæˆ‘ä»¬è¿™ç¯‡æ•™ç¨‹å°†ä¼šè®²è§£å¦‚ä½•å€ŸåŠ© Authing æ¥ç»™æˆ‘ä»¬çš„ä¹‹å‰çš„å°ç¨‹åºåšå®¢æ­¦è£…ä¸€ä¸ªä¸“ä¸šçš„ç”¨æˆ·ç³»ç»Ÿã€‚</div>
          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <div class="post-gallery" itemscope itemtype="http://schema.org/ImageGallery">
            <div class="post-gallery-row">
              <img src="https://static.powerformer.com/c/34a473b/taro-cover-9.jpg" itemprop="contentUrl">
            
          

          </div>
        </div>
        <div class="profileBox">
  <div class="avatarBox">
    <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXY=" title="https://github.com/tuture-dev"><img alt class="avatar" data-src="/images/avatars/tuture-dev.jpg"><i class="fa fa-external-link"></i></span>
  </div>
  <div class="rightBox">
    <div class="infoBox">
    <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXY=" title="https://github.com/tuture-dev"><p class="nickName">@tuture-dev</p><i class="fa fa-external-link"></i></span>
  </div>
  <div class="codeBox">
    <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvdWx0cmEtY2x1Yg==" title="https://github.com/tuture-dev/ultra-club"><span class="codeText">æŸ¥çœ‹ä»£ç </span><i class="fa fa-external-link"></i></span>
  </div>
  </div>
</div><a id="more"></a>

<h2 id="å‡†å¤‡æ–°ç‰ˆç™»å½•é€»è¾‘"><a href="#å‡†å¤‡æ–°ç‰ˆç™»å½•é€»è¾‘" class="headerlink" title="å‡†å¤‡æ–°ç‰ˆç™»å½•é€»è¾‘"></a>å‡†å¤‡æ–°ç‰ˆç™»å½•é€»è¾‘</h2><p>ä¹‹å‰æˆ‘ä»¬çš„å°ç¨‹åºå…·æœ‰äº†ä¸€ä¸ªç®€å•åšå®¢å¿…å¤‡çš„ä¸€äº›åŠŸèƒ½ï¼š</p>
<ul>
<li>æƒé™ç®¡ç†ï¼šå‘å¸–ä¹‹å‰éœ€è¦ç™»å½•</li>
<li>ç™»å½•ï¼šæ™®é€šç™»å½•å’Œå¾®ä¿¡ç™»å½•ç­‰</li>
<li>å‘å¸–ï¼šå¸–å­ä¼šè‡ªåŠ¨å¸¦ä¸Šç”¨æˆ·ä¿¡æ¯</li>
<li>è·å–æ‰€æœ‰å¸–å­å’Œå•ä¸ªå¸–å­</li>
</ul>
<p>ä¹ä¸€çœ‹è¿™ä¸ªåšå®¢æœ‰ç‚¹å°å®Œæ•´äº†ï¼Œä½†æ˜¯ä¸€è·¯è·Ÿä¸‹æ¥çš„åŒå­¦åº”è¯¥çŸ¥é“ï¼Œæˆ‘ä»¬ä¹‹å‰çš„ç™»å½•éƒ½æ˜¯é€šè¿‡ä¼ å…¥ç”¨æˆ·çš„ <code>nickName</code> å’Œ <code>photo</code> æ¥ç™»å½•çš„ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸€èˆ¬åœ¨ç”Ÿæ´»ä¸­çœ‹åˆ°çš„ä¸€äº›æ¯”è¾ƒæ­£è§„çš„ç½‘ç«™æˆ–è€…å°ç¨‹åºï¼Œå®ƒä»¬çš„ç™»å½•ä¸€èˆ¬éƒ½æœ‰ç±»ä¼¼æ‰‹æœº+éªŒè¯ç ç™»å½•ï¼Œå¹¶ä¸”åœ¨ä¸€ä¸ªæ ‡å‡†çš„åšå®¢é‡Œé¢ï¼Œå¯èƒ½è¿˜ä¼šæ¶‰åŠåˆ°è¯¸å¦‚ç”¨æˆ·æƒé™ç®¡ç†ï¼Œç”¨æˆ·ç™»å½•çŠ¶æ€æŸ¥è¯¢ç­‰ï¼Œåˆšåˆšæˆ‘æåˆ°çš„ç§ç§å…³äºç”¨æˆ·çš„åœºæ™¯ä¸€èˆ¬ä¼šè¢«æŠ½è±¡ä¸ºä¸€ä¸ªåº”ç”¨é‡Œçš„ä¸€ä¸ªæ ¸å¿ƒæ¨¡å— â€“ ç”¨æˆ·ç³»ç»Ÿï¼Œå³æ‰€æœ‰å’Œç”¨æˆ·æ³¨å†Œ/ç™»å½•ã€ä¿¡æ¯æ›´æ–°ã€æƒé™ç®¡ç†ã€é‰´æƒç­‰ç›¸å…³çš„å†…å®¹ã€‚</p>
<p>ä¸ºäº†è®©æˆ‘ä»¬çš„åšå®¢çœ‹èµ·æ¥æ›´åŠ ä¸“ä¸šï¼Œæˆ‘ä»¬æ‰“ç®—ç»™å®ƒä¹ŸåŠ ä¸Šæ•´ä¸Šä¸€ä¸ªä¸“ä¸šçš„ç”¨æˆ·ç³»ç»Ÿï¼Œæœ‰äº†æœ€ä¸ºæ ¸å¿ƒçš„ç”¨æˆ·ç³»ç»Ÿåœ¨ï¼Œæˆ‘ä»¬åšå®¢ä¹‹åçš„æ‰©å±•éƒ½å¯ä»¥æ¸¸åˆƒæœ‰ä½™ï¼Œä½†æ˜¯æ®ç»Ÿè®¡ï¼Œä¸€ä¸ªåº”ç”¨è¦æƒ³æ‰“é€ ä¸€ä¸ªæ¯”è¾ƒä¸“ä¸šçš„ç”¨æˆ·ç³»ç»Ÿï¼Œè‡³å°‘éœ€è¦èŠ±è´¹å‡ ä¸ªæœˆæ—¶é—´ï¼Œè¿˜éœ€è¦èŠ±å¤§é‡çš„ç²¾åŠ›å»ç»´æŠ¤æ‰“é€ å‡ºæ¥çš„ç”¨æˆ·ç³»ç»Ÿï¼Œæ‰€åœ¨åœ¨åšäº†ä¸€ç•ªè°ƒç ”ä¹‹åï¼Œæˆ‘ä»¬å°†ç›®æ ‡æ”¾åœ¨äº†ä¸€ä¸ªå«åš Authing çš„é€šç”¨äº‘èº«ä»½å¹³å°ï¼Œå®ƒæä¾›çš„æœåŠ¡å°±æ˜¯å¸®åº”ç”¨å¿«é€Ÿé›†æˆä¸€ä¸ªé«˜æ•ˆã€å®‰å…¨çš„ç”¨æˆ·ç³»ç»Ÿï¼Œè€Œæˆ‘ä»¬è¿™ç¯‡æ•™ç¨‹å°†ä¼šè®²è§£å¦‚ä½•å€ŸåŠ© Authing æ¥ç»™æˆ‘ä»¬çš„ä¹‹å‰çš„å°ç¨‹åºåšå®¢æ­¦è£…ä¸€ä¸ªä¸“ä¸šçš„ç”¨æˆ·ç³»ç»Ÿã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€çœ‹å®Œæˆçš„æ•ˆæœï¼š</p>
<p><img alt data-src="https://static.powerformer.com/c/34a473b/172281ab2f4dfe98.gif"></p>
<p><img alt data-src="https://cdn.nlark.com/yuque/0/2020/gif/123790/1588231679722-a000569d-8acf-4e8c-be6d-e7288dadacb2.gif"></p>
<p>å¦‚æœä½ å¸Œæœ›ç›´æ¥ä»è¿™ç¯‡å¼€å§‹ï¼Œé‚£ä¹ˆå¯ä»¥ Clone æˆ‘ä»¬ä¸ºä½ å‡†å¤‡çš„ä»£ç ï¼Œç„¶åè·Ÿç€æ•™ç¨‹è¡¥å……å‰©ä¸‹çš„éƒ¨åˆ†ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git clone -b authing-start https:&#x2F;&#x2F;github.com&#x2F;tuture-dev&#x2F;ultra-club.git</span><br><span class="line"></span><br><span class="line"># æˆ–è€…ä¸‹è½½ Gitee ä¸Šçš„ä»“åº“</span><br><span class="line">git clone -b authing-start https:&#x2F;&#x2F;gitee.com&#x2F;tuture&#x2F;ultra-club.git</span><br></pre></td></tr></table></figure>

<h3 id="æ”¹è¿›æ™®é€šç™»å½•"><a href="#æ”¹è¿›æ™®é€šç™»å½•" class="headerlink" title="æ”¹è¿›æ™®é€šç™»å½•"></a>æ”¹è¿›æ™®é€šç™»å½•</h3><p>é¦–å…ˆæˆ‘ä»¬æ¥å°†ä¹‹å‰æ™®é€šç™»å½•çš„ä¸“ä¸šæ€§æå‡ä¸€ä¸ªæ¡£æ¬¡ï¼Œä¹‹å‰æˆ‘ä»¬æ˜¯è®©ç”¨æˆ·è¾“å…¥æ˜µç§°å’Œä¸Šä¼ å¤´åƒç„¶åè¿›è¡Œç™»å½•ï¼Œç°åœ¨æˆ‘ä»¬æ‰“ç®—åˆ‡æ¢åˆ°æ‰‹æœºå·+éªŒè¯ç çš„å½¢å¼ï¼Œç«‹é©¬ç°ä»£åŒ–ã€‚</p>
<p>æ‰“å¼€ <code>src/components/LoginForm/index.jsx</code> æ–‡ä»¶ï¼Œå¯¹å…¶ä¸­çš„å†…å®¹ä½œå‡ºå¯¹åº”çš„ä¿®æ”¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight jsx"><figcaption><span>src/components/LoginForm/index.jsx</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvdWx0cmEtY2x1Yi9ibG9iLzRhODVjZDAwNWQ4YmU2MTNkMDhjMThjMjVlYTE2MzM3MDNlMzBlYmEvc3JjL2NvbXBvbmVudHMvTG9naW5Gb3JtL2luZGV4LmpzeA==" title="https://github.com/tuture-dev/ultra-club/blob/4a85cd005d8be613d08c18c25ea1633703e30eba/src/components/LoginForm/index.jsx">æŸ¥çœ‹å®Œæ•´ä»£ç <i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line">[tuture-del]<span class="keyword">import</span> Taro, &#123; useState &#125; <span class="keyword">from</span> <span class="string">'@tarojs/taro'</span></span><br><span class="line">[tuture-add]<span class="keyword">import</span> Taro, &#123; useState, useRef, useEffect &#125; <span class="keyword">from</span> <span class="string">'@tarojs/taro'</span></span><br><span class="line"><span class="keyword">import</span> &#123; View, Form &#125; <span class="keyword">from</span> <span class="string">'@tarojs/components'</span></span><br><span class="line"><span class="keyword">import</span> &#123; AtButton, AtImagePicker &#125; <span class="keyword">from</span> <span class="string">'taro-ui'</span></span><br><span class="line"><span class="keyword">import</span> &#123; useDispatch &#125; <span class="keyword">from</span> <span class="string">'@tarojs/redux'</span></span><br><span class="line"></span><br><span class="line">[tuture-del]<span class="keyword">import</span> &#123; LOGIN &#125; <span class="keyword">from</span> <span class="string">'../../constants'</span></span><br><span class="line">[tuture-add]<span class="keyword">import</span> &#123; SET_IS_OPENED, SET_LOGIN_INFO &#125; <span class="keyword">from</span> <span class="string">'../../constants'</span></span><br><span class="line">[tuture-add]<span class="keyword">import</span> CountDownButton <span class="keyword">from</span> <span class="string">'../CountDownButton'</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'./index.scss'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">LoginForm</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// Login Form ç™»å½•æ•°æ®</span></span><br><span class="line">[tuture-del]  <span class="keyword">const</span> [formNickName, setFormNickName] = useState(<span class="string">''</span>)</span><br><span class="line">[tuture-del]  <span class="keyword">const</span> [files, setFiles] = useState([])</span><br><span class="line">[tuture-del]  <span class="keyword">const</span> [showAddBtn, setShowAddBtn] = useState(<span class="literal">true</span>)</span><br><span class="line">[tuture-add]  <span class="keyword">const</span> [phone, setPhone] = useState(<span class="string">''</span>)</span><br><span class="line">[tuture-add]  <span class="keyword">const</span> [phoneCode, setPhoneCode] = useState(<span class="string">''</span>)</span><br><span class="line">[tuture-add]  <span class="keyword">const</span> countDownButtonRef = useRef(<span class="literal">null</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> dispatch = useDispatch()</span><br><span class="line"></span><br><span class="line">[tuture-del]  <span class="function"><span class="keyword">function</span> <span class="title">onChange</span>(<span class="params">files</span>) </span>&#123;</span><br><span class="line">[tuture-del]    <span class="keyword">if</span> (files.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">[tuture-del]      setShowAddBtn(<span class="literal">false</span>)</span><br><span class="line">[tuture-del]    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">[tuture-del]      setShowAddBtn(<span class="literal">true</span>)</span><br><span class="line">[tuture-add]  <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">countDownButtonPressed</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">[tuture-add]    <span class="keyword">if</span> (!phone) &#123;</span><br><span class="line">[tuture-add]      Taro.atMessage(&#123;</span><br><span class="line">[tuture-add]        type: <span class="string">'error'</span>,</span><br><span class="line">[tuture-add]        message: <span class="string">'æ‚¨è¿˜æ²¡æœ‰å¡«å†™æ‰‹æœº!'</span>,</span><br><span class="line">[tuture-add]      &#125;)</span><br><span class="line">[tuture-add] </span><br><span class="line">[tuture-add]      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">[tuture-del]    setFiles(files)</span><br><span class="line">[tuture-del]  &#125;</span><br><span class="line">[tuture-add]    countDownButtonRef.current.startCountDown()</span><br><span class="line"></span><br><span class="line">[tuture-del]  <span class="function"><span class="keyword">function</span> <span class="title">onImageClick</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">[tuture-del]    Taro.previewImage(&#123;</span><br><span class="line">[tuture-del]      urls: [props.files[<span class="number">0</span>].url],</span><br><span class="line">[tuture-del]    &#125;)</span><br><span class="line">[tuture-add]    <span class="comment">// å¤„ç†å‘é€éªŒè¯ç äº‹ä»¶</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">handleSubmit</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    e.preventDefault()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é‰´æƒæ•°æ®</span></span><br><span class="line">[tuture-del]    <span class="keyword">if</span> (!formNickName || !files.length) &#123;</span><br><span class="line">[tuture-add]    <span class="keyword">if</span> (!phone || !phoneCode) &#123;</span><br><span class="line">      Taro.atMessage(&#123;</span><br><span class="line">        type: <span class="string">'error'</span>,</span><br><span class="line">        message: <span class="string">'æ‚¨è¿˜æœ‰å†…å®¹æ²¡æœ‰å¡«å†™ï¼'</span>,</span><br><span class="line">      &#125;)</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">[tuture-del]    setShowAddBtn(<span class="literal">true</span>)</span><br><span class="line">[tuture-del] </span><br><span class="line">[tuture-del]    <span class="comment">// æç¤ºç™»å½•æˆåŠŸ</span></span><br><span class="line">[tuture-del]    Taro.atMessage(&#123;</span><br><span class="line">[tuture-del]      type: <span class="string">'success'</span>,</span><br><span class="line">[tuture-del]      message: <span class="string">'æ­å–œæ‚¨ï¼Œç™»å½•æˆåŠŸï¼'</span>,</span><br><span class="line">[tuture-del]    &#125;)</span><br><span class="line">[tuture-del] </span><br><span class="line">[tuture-del]    <span class="comment">// ç¼“å­˜åœ¨ storage é‡Œé¢</span></span><br><span class="line">[tuture-del]    <span class="keyword">const</span> userInfo = &#123; <span class="attr">avatar</span>: files[<span class="number">0</span>].url, <span class="attr">nickName</span>: formNickName &#125;</span><br><span class="line">[tuture-del] </span><br><span class="line">[tuture-del]    <span class="comment">// æ¸…ç©ºè¡¨å•çŠ¶æ€</span></span><br><span class="line">[tuture-del]    setFiles([])</span><br><span class="line">[tuture-del]    setFormNickName(<span class="string">''</span>)</span><br><span class="line">[tuture-del] </span><br><span class="line">[tuture-del]    <span class="comment">// å‘åç«¯å‘èµ·ç™»å½•è¯·æ±‚</span></span><br><span class="line">[tuture-del]    dispatch(&#123; <span class="attr">type</span>: LOGIN, <span class="attr">payload</span>: &#123; <span class="attr">userInfo</span>: userInfo &#125; &#125;)</span><br><span class="line">[tuture-add]    <span class="comment">// å¤„ç†ç™»å½•å’Œæ³¨å†Œ</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;View className=<span class="string">"post-form"</span>&gt;</span><br><span class="line">      &lt;Form onSubmit=&#123;handleSubmit&#125;&gt;</span><br><span class="line">        &lt;View className=<span class="string">"login-box"</span>&gt;</span><br><span class="line">[tuture-del]          &lt;View className=<span class="string">"avatar-selector"</span>&gt;</span><br><span class="line">[tuture-del]            &lt;AtImagePicker</span><br><span class="line">[tuture-del]              length=&#123;<span class="number">1</span>&#125;</span><br><span class="line">[tuture-del]              mode=<span class="string">"scaleToFill"</span></span><br><span class="line">[tuture-del]              count=&#123;<span class="number">1</span>&#125;</span><br><span class="line">[tuture-del]              files=&#123;files&#125;</span><br><span class="line">[tuture-del]              showAddBtn=&#123;showAddBtn&#125;</span><br><span class="line">[tuture-del]              onImageClick=&#123;onImageClick&#125;</span><br><span class="line">[tuture-del]              onChange=&#123;onChange&#125;</span><br><span class="line">[tuture-del]            /&gt;</span><br><span class="line">[tuture-del]          &lt;<span class="regexp">/View&gt;</span></span><br><span class="line"><span class="regexp">          &lt;Input</span></span><br><span class="line"><span class="regexp">[tuture-del]            className="input-nickName"</span></span><br><span class="line"><span class="regexp">[tuture-add]            className="input-phone input-item"</span></span><br><span class="line"><span class="regexp">            type="text"</span></span><br><span class="line"><span class="regexp">[tuture-del]            placeholder="ç‚¹å‡»è¾“å…¥æ˜µç§°"</span></span><br><span class="line"><span class="regexp">[tuture-del]            value=&#123;formNickName&#125;</span></span><br><span class="line"><span class="regexp">[tuture-del]            onInput=&#123;e =&gt; setFormNickName(e.target.value)&#125;</span></span><br><span class="line"><span class="regexp">[tuture-add]            placeholder="è¾“å…¥æ‰‹æœºå·"</span></span><br><span class="line"><span class="regexp">[tuture-add]            value=&#123;phone&#125;</span></span><br><span class="line"><span class="regexp">[tuture-add]            onInput=&#123;e =&gt; setPhone(e.target.value)&#125;</span></span><br><span class="line"><span class="regexp">          /</span>&gt;</span><br><span class="line">[tuture-add]          &lt;View className=<span class="string">"verify-code-box"</span>&gt;</span><br><span class="line">[tuture-add]            &lt;Input</span><br><span class="line">[tuture-add]              className=<span class="string">"input-nickName input-item"</span></span><br><span class="line">[tuture-add]              type=<span class="string">"text"</span></span><br><span class="line">[tuture-add]              placeholder=<span class="string">"å››ä½éªŒè¯ç "</span></span><br><span class="line">[tuture-add]              value=&#123;phoneCode&#125;</span><br><span class="line">[tuture-add]              onInput=&#123;e =&gt; setPhoneCode(e.target.value)&#125;</span><br><span class="line">[tuture-add]            /&gt;</span><br><span class="line">[tuture-add]            &lt;CountDownButton</span><br><span class="line">[tuture-add]              onClick=&#123;countDownButtonPressed&#125;</span><br><span class="line">[tuture-add]              ref=&#123;countDownButtonRef&#125;</span><br><span class="line">[tuture-add]            /&gt;</span><br><span class="line">[tuture-add]          &lt;<span class="regexp">/View&gt;</span></span><br><span class="line"><span class="regexp">          &lt;AtButton formType="submit" type="primary"&gt;</span></span><br><span class="line"><span class="regexp">            ç™»å½•</span></span><br><span class="line"><span class="regexp">          &lt;/</span>AtButton&gt;</span><br><span class="line">[tuture-add]          &lt;View className=<span class="string">"at-article__info"</span>&gt;</span><br><span class="line">[tuture-add]            é€šè¿‡æ‰‹æœºå’ŒéªŒè¯ç æ¥ç™»å½•ï¼Œå¦‚æœæ²¡æœ‰è´¦å·ï¼Œæˆ‘ä»¬å°†è‡ªåŠ¨åˆ›å»º</span><br><span class="line">[tuture-add]          &lt;<span class="regexp">/View&gt;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>View&gt;</span><br><span class="line">      &lt;<span class="regexp">/Form&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>View&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°ï¼Œä¸Šé¢çš„ä»£ç ä¸»è¦æœ‰å¦‚ä¸‹å‡ å¤„æ›´æ”¹ï¼š</p>
<ul>
<li>åˆ é™¤äº†å¤„ç† <code>avatar</code> å’Œ <code>nickName</code> çš„ <code>useState</code> é€»è¾‘</li>
<li>åˆ é™¤äº†ä¹‹å‰ç”¨äºå¤„ç†ä¸Šä¼ å¤´åƒçš„ <code>onImageClick</code> å’Œ <code>onChange</code> å‡½æ•°ï¼Œä»¥åŠ <code>AtImagePicker</code> ç»„ä»¶</li>
<li>æ”¹è¿›å’Œå¢åŠ äº†ä¸¤ä¸ªè¾“å…¥æ¡†ï¼Œä¸€ä¸ªç”¨äºè¾“å…¥æ‰‹æœºå·ï¼Œä¸€ä¸ªç”¨äºè¾“å…¥éªŒè¯ç ï¼ŒåŒæ˜¯å¢åŠ äº† <code>phone</code> å’Œ <code>phoneCode</code> çš„ <code>useState</code> é€»è¾‘</li>
<li>æ”¹è¿› <code>handleSubmit</code> ï¼Œåˆ é™¤äº†åŸå¤„ç† <code>nickName</code> å’Œ <code>files</code> çš„é€»è¾‘ï¼Œä»¥åŠåˆ é™¤äº†ä¹‹å‰å‘èµ·ç™»å½•çš„ <code>dispatch</code> é€»è¾‘</li>
<li>æ¥ç€æˆ‘ä»¬å¢åŠ äº†ä¸€ä¸ªç”¨äºå€’è®¡æ—¶çš„ <code>CountDownButton</code> ç»„ä»¶ï¼Œä»¥åŠè·å– <code>ref</code> çš„ <code>countDownButtonRef</code> å’Œå¤„ç†æŒ‰é’®ç‚¹å‡»äº‹ä»¶çš„ <code>countDownButtonPressed</code> å‡½æ•°ï¼Œåœ¨å‡½æ•°é‡Œé¢æˆ‘ä»¬ä¼šåšæ•°æ®éªŒè¯ï¼Œå¦‚æœç”¨æˆ·å¡«å†™äº†æ‰‹æœºå·ï¼Œæ‰å…è®¸æ‰§è¡Œå€’è®¡æ—¶é€»è¾‘ï¼Œåœ¨æ¥ä¸‹æ¥æˆ‘ä»¬å°†åœ¨è¿™ä¸ªå‡½æ•°é‡Œé¢å¤„ç†æ‰‹æœºéªŒè¯ç å‘é€é€»è¾‘ã€‚</li>
<li>æœ€åæˆ‘ä»¬æ·»åŠ äº†æç¤ºç”¨æˆ·ä½¿ç”¨æ‰‹æœºå’ŒéªŒè¯ç ç™»å½•çš„æ–‡æ¡ˆã€‚</li>
</ul>
<div class="note info">
            <p><strong>æç¤º</strong></p><p>è¿™é‡Œçš„ CountDownButton æ˜¯ Taro å®˜æ–¹ç‰©æ–™å¸‚åœºæä¾›çš„ç‰©æ–™ï¼Œå¯ä»¥è®¿é—® <a href>è¿™ä¸ªåœ°å€</a>ï¼Œä¸‹è½½ç‰©æ–™ï¼Œç„¶åå°† CountDownButton çš„æ–‡ä»¶å¤¹æ”¾åˆ° <code>src/compontents</code> æ–‡ä»¶å¤¹ä¸‹é¢ã€‚æˆ‘ä»¬è¿˜éœ€è¦å¯¹è¿™ä¸ªç»„ä»¶çš„æ ·å¼åšä¸€ç‚¹ä¿®æ”¹ï¼Œä»¥é€‚åº”æˆ‘ä»¬ç°åœ¨çš„ UI é£æ ¼ï¼Œæˆ‘ä»¬å°†é©¬ä¸Šæ¥è®²è§£å¦‚ä½•ä¿®æ”¹ï¼Œè¯»è€…å…ˆå¯ä»¥ä¸‹è½½è¿™ä¸ªç‰©æ–™ï¼Œç„¶åæ”¾ç½®åˆ°åˆšåˆšæåˆ°çš„é¡¹ç›®ç›®å½•ä¸‹ã€‚</p>
          </div>

<h3 id="æ ·å¼æ”¹è¿›"><a href="#æ ·å¼æ”¹è¿›" class="headerlink" title="æ ·å¼æ”¹è¿›"></a>æ ·å¼æ”¹è¿›</h3><p>ä¸Šé¢æˆ‘ä»¬æ”¹è¿›äº†ç»„ä»¶ï¼Œä¸ºäº†è®©æˆ‘ä»¬çš„æ–°ç‰ˆç™»å½•æ ·å­çœ‹èµ·æ¥æ›´åŠ ä¸“ä¸šã€ç»Ÿä¸€ï¼Œæˆ‘ä»¬åŠ ç‚¹æ ·å¼ï¼Œæ‰“å¼€ <code>src/components/LoginForm/index.scss</code> æ–‡ä»¶ï¼Œå¯¹å…¶ä¸­çš„å†…å®¹ä½œå‡ºå¯¹åº”çš„ä¿®æ”¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight scss"><figcaption><span>src/components/LoginForm/index.scss</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvdWx0cmEtY2x1Yi9ibG9iLzRhODVjZDAwNWQ4YmU2MTNkMDhjMThjMjVlYTE2MzM3MDNlMzBlYmEvc3JjL2NvbXBvbmVudHMvTG9naW5Gb3JtL2luZGV4LnNjc3M=" title="https://github.com/tuture-dev/ultra-club/blob/4a85cd005d8be613d08c18c25ea1633703e30eba/src/components/LoginForm/index.scss">æŸ¥çœ‹å®Œæ•´ä»£ç <i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.post-form</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">30px</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">30px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[tuture-del]</span><span class="selector-class">.input-nickName</span> &#123;</span><br><span class="line"><span class="selector-attr">[tuture-add]</span><span class="selector-class">.input-item</span> &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#eee</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: medium;</span><br><span class="line"><span class="selector-attr">[tuture-del]</span>  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">40px</span>;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">40px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[tuture-add]</span><span class="selector-class">.input-phone</span> &#123;</span><br><span class="line"><span class="selector-attr">[tuture-add]</span>  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line"><span class="selector-attr">[tuture-add]</span>&#125;</span><br><span class="line"><span class="selector-attr">[tuture-add]</span> </span><br><span class="line"><span class="selector-attr">[tuture-add]</span><span class="selector-class">.input-nickName</span> &#123;</span><br><span class="line"><span class="selector-attr">[tuture-add]</span>  <span class="attribute">width</span>: calc(<span class="number">100%</span> - <span class="number">200px</span>);</span><br><span class="line"><span class="selector-attr">[tuture-add]</span>&#125;</span><br><span class="line"><span class="selector-attr">[tuture-add]</span> </span><br><span class="line"><span class="selector-attr">[tuture-add]</span><span class="selector-class">.verify-code-box</span> &#123;</span><br><span class="line"><span class="selector-attr">[tuture-add]</span>  <span class="attribute">display</span>: flex;</span><br><span class="line"><span class="selector-attr">[tuture-add]</span>  <span class="attribute">flex-direction</span>: row;</span><br><span class="line"><span class="selector-attr">[tuture-add]</span>  <span class="attribute">align-items</span>: center;</span><br><span class="line"><span class="selector-attr">[tuture-add]</span>  <span class="attribute">justify-content</span>: space-between;</span><br><span class="line"><span class="selector-attr">[tuture-add]</span>&#125;</span><br><span class="line"><span class="selector-attr">[tuture-add]</span> </span><br><span class="line"><span class="selector-class">.avatar-selector</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ä½¿ç”¨-Taro-ç‰©æ–™"><a href="#ä½¿ç”¨-Taro-ç‰©æ–™" class="headerlink" title="ä½¿ç”¨ Taro ç‰©æ–™"></a>ä½¿ç”¨ Taro ç‰©æ–™</h3><p>æˆ‘ä»¬ä¸Šé¢ç”¨åˆ°çš„ <code>CountDownButton</code> ç»„ä»¶ï¼Œå°±æ˜¯ Taro ç‰©æ–™å¸‚åœºçš„ä¸€ä¸ªç‰©æ–™, ç®€å•çš„è¯´ç‰©æ–™å°±æ˜¯ä¸€ä¸ªèƒ½æŸæ–¹é¢åŠŸèƒ½å®Œå–„çš„åŒ…æˆ–ç»„ä»¶,å¸®åŠ©å¼€å‘è€…å¿«é€Ÿå®ŒæˆæŸä¸ªé€»è¾‘è€Œä¸éœ€è¦é‡å¤é€ è½®å­,æ­£å¦‚ Taro ç‰©æ–™å¸‚åœºå®˜æ–¹çš„æ ‡è¯­ï¼š</p>
<blockquote>
<p>è®©æ¯ä¸€ä¸ªè®©æ¯ä¸€ä¸ªè½®å­äº§ç”Ÿä»·å€¼</p>
</blockquote>
<p>æˆ‘ä»¬é€šè¿‡ä¹‹å‰çš„æ­¥éª¤ï¼Œåº”è¯¥å·²ç»ä¸‹è½½å¥½äº†ç‰©æ–™ï¼Œå¹¶æ”¾åœ¨äº† <code>src/components</code> æ–‡ä»¶å¤¹ä¸‹é¢äº†ï¼Œå¯ä»¥çœ‹åˆ°ç»„ä»¶ä¸­ä¸»è¦å°±æ˜¯ä¸¤ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ªé€»è¾‘æ–‡ä»¶ <code>src/components/CountDownButton/index.js</code> ï¼Œè¿˜æœ‰ä¸€ä¸ªæ ·å¼æ–‡ä»¶ <code>src/components/CountDownButton/index.css</code>æ˜¯ï¼Œè¿™é‡Œæˆ‘ä»¬è¦åšä¸ªå°ä¿®æ”¹å°±æ˜¯é€»è¾‘æ–‡ä»¶é‡Œé¢å¼•ç”¨çš„æ˜¯ <code>index.scss</code> æ–‡ä»¶ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸‹è¿™ä¸ªæ ·å¼æ–‡ä»¶çš„åç¼€ä¸º <code>index.scss</code> ã€‚</p>
<p>æ¥ç€ä¸ºäº†å’Œæˆ‘ä»¬çš„ç°æœ‰çš„ UI ç»Ÿä¸€ï¼Œæˆ‘ä»¬è¿˜æ”¹äº† <code>src/components/CountDownButton/index.scss</code>æ–‡ä»¶çš„ <code>activeButtonStyle</code> å’Œ <code>buttonCommonStyle</code> æ ·å¼ï¼Œæœ€åçš„æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight scss"><figcaption><span>src/components/CountDownButton/index.scss</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvdWx0cmEtY2x1Yi9ibG9iLzRhODVjZDAwNWQ4YmU2MTNkMDhjMThjMjVlYTE2MzM3MDNlMzBlYmEvc3JjL2NvbXBvbmVudHMvQ291bnREb3duQnV0dG9uL2luZGV4LnNjc3M=" title="https://github.com/tuture-dev/ultra-club/blob/4a85cd005d8be613d08c18c25ea1633703e30eba/src/components/CountDownButton/index.scss">æŸ¥çœ‹å®Œæ•´ä»£ç <i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="comment">/* æŒ‰é’®é»˜è®¤å±•ç°æ ·å¼ */</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.buttonCommonStyle</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">160px</span>;</span><br><span class="line">  <span class="attribute">height</span>: calc(<span class="number">1.4rem</span> + <span class="number">20px</span>);</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">justify-content</span>: center;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">4px</span>;</span><br><span class="line">  <span class="attribute">border</span>: none;</span><br><span class="line">  <span class="attribute">outline</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* ç¦ç”¨æ—¶å€™çš„TouchableOpacityæ ·å¼ */</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.disableButtonStyle</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#f6f6f6</span> <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* å¯ä»¥ç‚¹å‡»æ—¶å€™çš„TouchableOpacityæ ·å¼ */</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.activeButtonStyle</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#02b875</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* æ–‡æœ¬é»˜è®¤æ ·å¼ */</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.txtCommonStyle</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* ç¦ç”¨æ—¶Textæ ·å¼ */</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.disableTxtStyle</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#999</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* å¯ä»¥ç‚¹å‡»æ—¶å€™çš„Textæ ·å¼ */</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.activeTxtStyle</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¤§åŠŸå‘Šæˆï¼ğŸ¥³ï¼Œæˆ‘ä»¬æˆåŠŸçš„å®Œæˆäº†æ–°ç‰ˆæ™®é€šç™»å½•çš„ç•Œé¢ï¼Œå½“ä½ ä¿å­˜ä»£ç ï¼Œå¹¶åœ¨æ ¹ç›®å½•ä¸‹é€šè¿‡ <code>npm run dev:weapp</code> å¼€å¯å¾®ä¿¡å°ç¨‹åºï¼Œå¹¶ä½¿ç”¨å¼€å‘è€…å·¥å…·æ‰“å¼€æˆ‘ä»¬çš„é¡¹ç›®æ—¶ï¼Œå®ƒçš„æ•ˆæœåº”è¯¥ç±»å‹ä¸‹é¢è¿™æ ·ï¼š</p>
<p><img alt data-src="https://static.powerformer.com/c/34a473b/172281ab2f71d1d2.png"></p>
<p>æ€ä¹ˆæ ·ï¼Œæ˜¯ä¸æ˜¯å’Œä½ ä¹‹å‰ä½“éªŒçš„å„ç§ä¸“ä¸š App æˆ–è€…ç½‘ç«™ã€å°ç¨‹åºçš„ç™»å½•æ³¨å†Œç•Œé¢å’Œé€»è¾‘ç±»ä¼¼äº†å‘¢ï¼ŸğŸ˜†ï¼Œæœ‰äº†è¿™æ ·ä¸€ä¸ªä¸“ä¸šçš„ç™»å½•ç•Œé¢ä¹‹åï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥å°†è¦æŠŠå®ƒæ•´ä¸ªä»å‰ç«¯åˆ°åç«¯çš„é€»è¾‘è·‘é€šï¼Œä¸‹ä¸€æ­¥æˆ‘ä»¬å°†è·‘é€šè¿™ä¸ªç™»å½•å’Œæ³¨å†Œé€»è¾‘ã€‚</p>
<div class="note info">
            <p><strong>æç¤º</strong></p><p>è¿™é‡Œæˆ‘ä»¬å°†ç™»å½•å’Œæ³¨å†Œé¡µé¢æ•´åˆåœ¨äº†ä¸€èµ·ï¼Œé€šè¿‡åœ¨ç™»å½•æŒ‰é’®ä¸‹æ–¹çš„å°æ–‡å­—æç¤ºï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰è´¦å·ï¼Œé‚£ä¹ˆé€šè¿‡æ‰‹æœºå·å’ŒéªŒè¯ç ç™»å½•ä¹‹åï¼Œæˆ‘ä»¬ä¼šä¸ºç”¨æˆ·ç›´æ¥æ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œè€Œç®€åŒ–ç•Œé¢é€»è¾‘çš„èƒŒåé€šå¸¸éœ€è¦åœ¨ä»£ç é€»è¾‘ä¸Šåšå‡ºå¤§é‡çš„æ”¹è¿›ã€ä¼˜åŒ–ç­‰ï¼Œç„¶è€Œæˆ‘ä»¬åœ¨ä¸‹ä¸€æ­¥å³å°†æ¥å…¥çš„é€šç”¨çš„èº«ä»½äº‘å¹³å° â€“ Authing åˆ™å°†è¿™ä¸€é€»è¾‘ç®€åŒ–åˆ°äº†å‡ è¡Œä»£ç ã€‚</p>
          </div>

<h2 id="ä½¿ç”¨-Authing-æ¥å…¥å®Œæ•´çš„ç”¨æˆ·ç³»ç»Ÿ"><a href="#ä½¿ç”¨-Authing-æ¥å…¥å®Œæ•´çš„ç”¨æˆ·ç³»ç»Ÿ" class="headerlink" title="ä½¿ç”¨ Authing æ¥å…¥å®Œæ•´çš„ç”¨æˆ·ç³»ç»Ÿ"></a>ä½¿ç”¨ Authing æ¥å…¥å®Œæ•´çš„ç”¨æˆ·ç³»ç»Ÿ</h2><p>åœ¨æ–‡ç« å¼€å¤´å’Œä¸Šä¸€å°ç»“æœ«å°¾ä¹°äº†é‚£ä¹ˆå¤šå…³å­ï¼Œè¯´ Authing å¦‚ä½•ç®€åŒ–æˆ‘ä»¬çš„å¼€å‘æˆæœ¬ï¼Œæœ‰äº›è¯»è€…ä¼°è®¡éƒ½æœ‰ç‚¹æ€¥ä¸å¯è€äº†ï¼Œè¿™ä¸ª Authing æœ‰è¿™ä¹ˆæ–¹ä¾¿å˜›ï¼Ÿï¼Œæˆ‘ä»¬è¿™ä¸€èŠ‚å°±æ¥å¼€å§‹æ·±å…¥ä½¿ç”¨å®ƒã€‚</p>
<p>ä¸ºäº†å°† Authing æ¥å…¥æˆ‘ä»¬çš„åšå®¢å°ç¨‹åºï¼Œæˆ‘ä»¬éœ€è¦åšä»¥ä¸‹å‡ ç‚¹å‡†å¤‡ï¼š</p>
<ul>
<li>æ³¨å†Œ Authing è´¦å·å¹¶åˆ›å»ºä¸€ä¸ª â€œå°ç¨‹åºâ€ ç±»å‹çš„ç”¨æˆ·æ± </li>
<li>é€šè¿‡å®˜æ–¹æ–‡æ¡£ï¼Œæ‰¾åˆ°å°ç¨‹åº SDKï¼Œå¹¶ä¸‹è½½å¯¹äºçš„æ–‡ä»¶æ”¾ç½®åˆ°é¡¹ç›®ç›®å½•ä¸‹</li>
<li>åœ¨é¡¹ç›®ä»£ç ä¸­å¯¼å…¥ Authing å°ç¨‹åº SDKï¼Œå¹¶å¼€å§‹ä½¿ç”¨</li>
</ul>
<h3 id="æ³¨å†Œ-Authing-è´¦å·"><a href="#æ³¨å†Œ-Authing-è´¦å·" class="headerlink" title="æ³¨å†Œ Authing è´¦å·"></a>æ³¨å†Œ Authing è´¦å·</h3><p>æ‰“å¼€<span class="exturl" data-url="aHR0cHM6Ly9hdXRoaW5nLmNuLz91dG1fc291cmNlPXR1dHVyZQ==" title="https://authing.cn/?utm_source=tuture"> Authing å®˜ç½‘<i class="fa fa-external-link"></i></span>ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°å¦‚ä¸‹ç•Œé¢ï¼š</p>
<p><img alt data-src="https://static.powerformer.com/c/34a473b/172281ab2faef61e.png"></p>
<p>æˆ‘ä»¬ç‚¹å‡»å³ä¸Šè§’çš„ç™»å½•ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œå®ƒä¼šå¼¹å‡ºå¦‚ä¸‹ç•Œé¢ï¼š</p>
<p><img alt data-src="https://static.powerformer.com/c/34a473b/172281ab31cb9682.png"></p>
<p>æˆ‘ä»¬è¿™æ—¶å€™å¯ä»¥æ…¢ä¸‹è„šæ­¥ï¼Œå¥½å¥½çœ‹ä¸€ä¸‹æä¾›é€šç”¨èº«ä»½äº‘å¹³å°çš„å…¬å¸ï¼Œä»–ä»¬çš„ç™»å½•ç•Œé¢æ˜¯æ€ä¹ˆæ ·çš„å‘¢ï¼Ÿå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬ç†Ÿæ‚‰çš„å¾®ä¿¡ç™»å½•ã€é‚®ç®±+å¯†ç ç™»å½•ã€æ‰‹æœºå·+éªŒè¯ç ç™»å½•ã€è¿˜æœ‰æŠ€æœ¯å¼€å‘è€…å¸¸ç”¨çš„ Github ç™»å½•ï¼Œç”šè‡³è¿˜æœ‰ä¸€ä¸ªæ¯”è¾ƒç‰¹æ®Šçš„å°ç¨‹åºæ‰«ç ç™»å½•ï¼ŒåŸºæœ¬å°†äº’è”ç½‘ä¸Šæˆ‘ä»¬å¯èƒ½ç”¨åˆ°çš„æœ€é«˜æ•ˆç‡çš„ç”¨æˆ·ç™»å½•ã€æ³¨å†ŒåŠŸèƒ½é€»è¾‘éƒ½é›†æˆè¿›äº†ä¸€ä¸ªå°å°çš„è¡¨å•é‡Œé¢ã€‚</p>
<p>è¯»è€…å¯ä»¥è‡ªè¡Œé€‰æ‹©è‡ªå·±å–œæ¬¢çš„ç™»å½•æ–¹å¼ğŸ˜‹ï¼Œè¿™é‡Œå›¾é›€é…±é€‰æ‹©äº†å¾®ä¿¡ç™»å½•ï¼Œç„¶ååœ¨å¼¹å‡ºçš„æ‰«ç ç•Œé¢ï¼Œä½¿ç”¨å¾®ä¿¡æ‰«ç äºŒç»´ç ç™»å½•ã€‚ç™»å½•ä¹‹åï¼Œä¼šå¼¹å‡ºä¸€ä¸ªç•Œé¢è®©ä½ ç»‘å®šæ‰‹æœºå·ï¼Œè¯»è€…è¿™é‡Œå¯ä»¥è‡ªè¡Œé€‰æ‹©æ˜¯å¦ç»‘å®šã€‚å½“å®Œæˆäº†è¿™ä¸€æ­¥æ“ä½œä¹‹åï¼Œç•Œé¢ä¼šå¯¼èˆªå¸¦ä½ æ¥åˆ°ä¸€ä¸ªåˆ›å»ºåº”ç”¨çš„ç•Œé¢ï¼Œæˆ‘ä»¬é€‰æ‹©å°ç¨‹åºï¼Œç„¶åç‚¹å‡»ä¸‹ä¸€æ­¥ï¼š</p>
<p><img alt data-src="https://static.powerformer.com/c/34a473b/172281ab328a8600.png"></p>
<p>æ¥ç€ï¼Œä¼šé—®ä½ çš„åº”ç”¨æ˜¯å¹²ä»€ä¹ˆçš„ï¼Œæˆ‘ä»¬å¡«å…¥ï¼šâ€œå›¾é›€ç¤¾åŒºåšå®¢å°ç¨‹åºâ€ï¼ˆè¯»è€…è¿™é‡Œå¯ä»¥è‡ªè¡Œè„‘è¡¥ï¼‰ï¼Œç„¶åæˆ‘ä»¬ç‚¹å‡»ä¸‹ä¸€æ­¥ï¼š</p>
<p><img alt data-src="https://static.powerformer.com/c/34a473b/172281ab6a4f7cf8.png"></p>
<p>æ¥ç€ä¼šè®©ä½ è®¾ç½®ä¸€ä¸ªäºŒçº§åŸŸåï¼Œæˆ‘ä»¬è¾“å…¥ tuture-blog-miniprogramï¼Œç„¶åæˆ‘ä»¬ç‚¹å‡»å®Œæˆï¼š</p>
<p><img alt data-src="https://static.powerformer.com/c/34a473b/172281ab5e1312d8.png"></p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å›æ¥åˆ°ä¸€ä¸ªå¿«é€Ÿä½“éªŒ Authing åŠŸèƒ½çš„ç•Œé¢ï¼Œç³»ç»Ÿä¸ºä½ é»˜è®¤åˆ›å»ºäº†ä¸€ä¸ªè´¦å·ï¼š</p>
<ul>
<li>è´¦å·ï¼š<code>test@test.com</code> </li>
<li>å¯†ç ï¼š<code>123456a!</code> </li>
</ul>
<p>ä½ å¯ä»¥åœ¨å³è¾¹çš„ç•Œé¢é‡Œé¢ä½“éªŒæ˜¯å¦å¯ä»¥ç™»å½•ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥æ³¨å†Œä¸€ä¸ªç”¨æˆ·ï¼Œæ³¨å†Œçš„ç”¨æˆ·ç¨åæˆ‘ä»¬å¯ä»¥åœ¨æ§åˆ¶å°æˆ‘ä»¬åˆ›å»ºçš„ â€œå›¾é›€ç¤¾åŒºåšå®¢å°ç¨‹åºâ€ ç”¨æˆ·æ± é‡Œé¢çœ‹åˆ°è¿™ä¸ªæ³¨å†Œçš„ç”¨æˆ·ï¼š</p>
<p><img alt data-src="https://static.powerformer.com/c/34a473b/172281ab6fdfbb33.png"></p>
<p>å¹¶ä¸”ä¸Šé¢çš„ç•Œé¢è¿˜è®²è§£äº†å¦‚ä½•å¿«é€Ÿé›†æˆ  Authing çš„ç™»å½•åŠŸèƒ½å’Œæ£€æŸ¥ç™»å½•çŠ¶æ€ï¼Œå¹¶ç»™å‡ºäº† JS å®ç°ä»£ç ï¼Œä»¥åŠå·¦ä¸‹è§’çš„ Guard ï¼Œè¿™ä¸ª Guard ç®€å•æ¥è¯´å°±æ˜¯ä¸€ä¸ªé›†åˆäº†æˆ‘ä»¬ä¹‹å‰çœ‹åˆ°çš„ Authing é‚£ä¸ªæ³¨å†Œã€ç™»å½•è¡¨å•çš„åŠŸèƒ½ï¼Œå¹¶ä¸”æä¾›ä¸€ä¸ªä¸“ä¸šçš„ç•Œé¢ç»™ä½ ï¼Œä½¿å¾—ä½ å¯ä»¥å‡ è¡Œä»£ç å°±å®ç°ä¸€ä¸ªç±»ä¼¼ Authing å®˜æ–¹æ³¨å†Œç™»å½•çš„é‚£ä¸ªæ ·å­ã€‚ä¹Ÿå°±æ˜¯æˆ‘ä»¬åˆšåˆšçœ‹åˆ°çš„è¿™ä¸ªç•Œé¢ï¼š</p>
<p><img alt data-src="https://static.powerformer.com/c/34a473b/172281ab31cb9682.png"></p>
<div class="note info">
            <p><strong>æç¤º</strong></p><p>æˆ‘ä»¬åœ¨å›¾é›€ç¤¾åŒºçš„å…¨æ ˆç”µå•†ç³»åˆ—æ–‡ç« çš„ç•ªå¤–ç¯‡é‡Œé¢é›†æˆç”¨æˆ·ç³»ç»Ÿæœ‰è®²åˆ°å¦‚ä½•ä½¿ç”¨ï¼Œæ„Ÿå…´è¶£çš„è¯»è€…å¯ä»¥é˜…è¯»æ­¤ç¯‡æ–‡ç« ã€‚</p>
          </div>

<p>å¥½çš„ï¼Œæˆ‘ä»¬ç‚¹å‡»å·¦ä¸‹è§’çš„ â€œçŸ¥é“äº†ï¼Œè¿›å…¥æ§åˆ¶å°â€ï¼Œå¼€å§‹è¿›å…¥æˆ‘ä»¬çš„ Authing ç”¨æˆ·æ± ç®¡ç†æ§åˆ¶å°ï¼Œåœ¨æ­¤ä¹‹å‰è¿˜ä¼šè®©ä½ å¡«å†™ä¸€ä¸ªå›è°ƒåœ°å€ï¼Œè¿™ä¸ªæˆ‘ä»¬æš‚æ—¶ç”¨ä¸åˆ°ï¼Œä½ å¯ä»¥è·³è¿‡ï¼Œæˆ–è€…å¯ä»¥éšä¾¿å¡«å†™ä¸€ä¸ªï¼Œæ¯”å¦‚ <code>http://localhost:3000</code>ã€‚</p>
<p>æœ€åï¼Œæˆ‘ä»¬æ¥åˆ°äº†è¿™æ ·ä¸€ä¸ªç•Œé¢ï¼š</p>
<p><img alt data-src="https://static.powerformer.com/c/34a473b/172281ab67e5569b.png"></p>
<p>å¯ä»¥çœ‹åˆ°è¿™ä¸ªç•Œé¢å·¦ä¾§å°±æ˜¯æˆ‘ä»¬ä¹‹å‰ä¸€ç›´æåˆ°çš„ â€œç”¨æˆ·æ± â€ ç®¡ç†ç•Œé¢ï¼Œé»˜è®¤é€‰ä¸­äº†æˆ‘ä»¬åˆšåˆšåˆ›å»ºçš„ â€œå›¾é›€ç¤¾åŒºåšå®¢å°ç¨‹åºâ€ï¼Œä¸€ä¸ªç”¨æˆ·æ± å°±æ˜¯ä¸€æ•´å¥—ç”¨æˆ·ä»¥åŠå’Œç”¨æˆ·ç™»å½•ã€æ³¨å†Œã€é‰´æƒã€ç™»å½•çŠ¶æ€ã€æ´»è·ƒã€æƒé™ç­‰æœ‰å…³çš„é€»è¾‘ã€‚</p>
<p>ä¸­é—´å°±æ˜¯å•ä¸ªç”¨æˆ·æ± é‡Œé¢çš„ä¸€äº›ä»‹ç»ï¼Œæ¯”å¦‚æˆ‘ä»¬ç°åœ¨çœ‹åˆ°çš„æ˜¯ä¸€ä¸ªç±»ä¼¼ Github é‚£ä¸ªçƒ­åŠ›å›¾ä¸€æ ·çš„ç”¨æˆ·ç™»å½•çƒ­åŠ›å›¾ï¼Œä½ å¯ä»¥æ–¹ä¾¿çš„çœ‹åˆ°é‚£å¤©æœ‰å¤šå°‘æ¬¡ç”¨æˆ·ç™»å½•ï¼Œå¾€ä¸‹æ»‘å¯ä»¥çœ‹åˆ°æ›´å¤šç”¨æˆ·æ•°æ®åˆ†ææ–¹é¢çš„å›¾è¡¨å’Œå†…å®¹ã€‚</p>
<h3 id="ä¸‹è½½å’Œé…ç½®-SDK"><a href="#ä¸‹è½½å’Œé…ç½®-SDK" class="headerlink" title="ä¸‹è½½å’Œé…ç½® SDK"></a>ä¸‹è½½å’Œé…ç½® SDK</h3><p>æ³¨å†Œå®Œè´¦å·ã€å»ºç«‹äº†ç”¨æˆ·æ± ï¼Œæˆ‘ä»¬éœ€è¦ä¸‹è½½ Authing ä¸ºæˆ‘ä»¬æä¾›çš„å¾®ä¿¡å°ç¨‹åº SDK æ¥é›†æˆç”¨æˆ·ç³»ç»Ÿï¼Œç‚¹å‡»<span class="exturl" data-url="aHR0cHM6Ly9kb2NzLmF1dGhpbmcuY24vYXV0aGluZy9zZGsvYXV0aGluZy1zZGstZm9yLXd4YXBwP3V0bV9zb3VyY2U9dHV0dXJl" title="https://docs.authing.cn/authing/sdk/authing-sdk-for-wxapp?utm_source=tuture">è¿™ä¸ªé“¾æ¥<i class="fa fa-external-link"></i></span>å»å¾€å°ç¨‹åºå¼€å‘æ–‡æ¡£ã€‚</p>
<p>æ ¹æ®æ–‡æ¡£ï¼Œæˆ‘ä»¬éœ€è¦åœ¨å¾®ä¿¡å°ç¨‹åºåå°é…ç½®ä¸¤ä¸ªåŸŸåç™½åå•ï¼š</p>
<ul>
<li><code>https://oauth.authing.cn</code> å’Œ <code>https://users.authing.cn</code> </li>
</ul>
<p>ç„¶åå°†å¾®ä¿¡å°ç¨‹åºçš„ <code>AppId</code> å’Œ <code>AppSecret</code> å¡«å…¥ Authing å¯¹åº”çš„åœ°å€ï¼š</p>
<p><img alt data-src="https://static.powerformer.com/c/34a473b/172281ab696b133d.png"></p>
<p>è¿™ä¸ªç•Œé¢ï¼Œç„¶åæ»‘åŠ¨åˆ°åº•éƒ¨ï¼Œé€‰æ‹©å°ç¨‹åºå†…ç™»é™†ï¼š</p>
<p><img alt data-src="https://static.powerformer.com/c/34a473b/172281ab9666de85.png"></p>
<p>åœ¨å¼¹å‡ºçš„æ¡†é‡Œé¢å¡«å…¥å¯¹åº”çš„å¾®ä¿¡å°ç¨‹åºçš„ <code>AppId</code> å’Œ <code>AppSecret</code> ï¼š</p>
<p><img alt data-src="https://static.powerformer.com/c/34a473b/172281ab9903fdd9.png"></p>
<p>é…ç½®å¥½ä¹‹åï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥å¯ä»¥å°† SDK ä»£ç ä¸‹è½½ï¼Œå¹¶æ”¾è¿›æˆ‘ä»¬çš„é¡¹ç›®é‡Œï¼Œæ‰¾ä¸€ä¸ªåœ°æ–¹ï¼ˆéç°æœ‰é¡¹ç›®ä¸­ï¼‰ï¼Œè¿è¡Œå¦‚ä¸‹è„šæœ¬ï¼ŒClone å°ç¨‹åº SDKï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git <span class="built_in">clone</span> https://github.com/Authing/authing-wxapp-sdk</span><br></pre></td></tr></table></figure>

<p>ç„¶åæ‰“å¼€æ­¤é¡¹ç›®ï¼Œå°†å…¶ä¸­çš„ <code>authing</code> æ–‡ä»¶å¤¹æ‹·è´è¿›æˆ‘ä»¬ <code>ultra-club</code> å°ç¨‹åºçš„ <code>src/utils</code> ç›®å½•ä¸‹ï¼Œæœ€åçš„ç›®å½•ç»“æ„çœ‹èµ·æ¥åº”è¯¥æ˜¯è¿™æ ·ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">src</span><br><span class="line">â”œâ”€â”€ store</span><br><span class="line">â”‚   â””â”€â”€ index.js</span><br><span class="line">â””â”€â”€ utils</span><br><span class="line">    â””â”€â”€ authing</span><br><span class="line">        â”œâ”€â”€ authing.js</span><br><span class="line">        â”œâ”€â”€ configs.js</span><br><span class="line">        â”œâ”€â”€ graphql</span><br><span class="line">        â”‚   â””â”€â”€ wxgql.js</span><br><span class="line">        â””â”€â”€ utils</span><br><span class="line">            â”œâ”€â”€ qiniuUploader.js</span><br><span class="line">            â”œâ”€â”€ util.js</span><br><span class="line">            â””â”€â”€ wxapp_rsa.min.js</span><br></pre></td></tr></table></figure>

<p>SDK å¼€å‘ç¯å¢ƒå‡†å¤‡å°±ç»ªâœŒï¸ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥é©¬ä¸Šæ¥é›†æˆæ‰‹æœºå·+éªŒè¯ç ç™»å½•çš„èº«ä»½é€»è¾‘ï¼</p>
<h3 id="å¼€å§‹é›†æˆ"><a href="#å¼€å§‹é›†æˆ" class="headerlink" title="å¼€å§‹é›†æˆ"></a>å¼€å§‹é›†æˆ</h3><p>æ‰“å¼€ <code>src/components/LoginForm/index.jsx</code> æ–‡ä»¶ï¼Œå¯¹å…¶ä¸­çš„å†…å®¹ä½œå‡ºå¯¹åº”çš„ä¿®æ”¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight jsx"><figcaption><span>src/components/LoginForm/index.jsx</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvdWx0cmEtY2x1Yi9ibG9iL2RmZWE4MmIwYjZlMTFkMWE1NzVkOTllOTUzMzdmNzJjOGE0ZWI2Zjkvc3JjL2NvbXBvbmVudHMvTG9naW5Gb3JtL2luZGV4LmpzeA==" title="https://github.com/tuture-dev/ultra-club/blob/dfea82b0b6e11d1a575d99e95337f72c8a4eb6f9/src/components/LoginForm/index.jsx">æŸ¥çœ‹å®Œæ•´ä»£ç <i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Taro, &#123; useState, useRef, useEffect &#125; <span class="keyword">from</span> <span class="string">'@tarojs/taro'</span></span><br><span class="line"><span class="keyword">import</span> &#123; View, Form &#125; <span class="keyword">from</span> <span class="string">'@tarojs/components'</span></span><br><span class="line"><span class="keyword">import</span> &#123; AtButton, AtImagePicker &#125; <span class="keyword">from</span> <span class="string">'taro-ui'</span></span><br><span class="line"><span class="keyword">import</span> &#123; useDispatch &#125; <span class="keyword">from</span> <span class="string">'@tarojs/redux'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; SET_IS_OPENED, SET_LOGIN_INFO &#125; <span class="keyword">from</span> <span class="string">'../../constants'</span></span><br><span class="line"><span class="keyword">import</span> CountDownButton <span class="keyword">from</span> <span class="string">'../CountDownButton'</span></span><br><span class="line">[tuture-add]<span class="keyword">import</span> Authing <span class="keyword">from</span> <span class="string">'../../utils/authing/authing'</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'./index.scss'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">LoginForm</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// Login Form ç™»å½•æ•°æ®</span></span><br><span class="line">  <span class="keyword">const</span> [phone, setPhone] = useState(<span class="string">''</span>)</span><br><span class="line">  <span class="keyword">const</span> [phoneCode, setPhoneCode] = useState(<span class="string">''</span>)</span><br><span class="line">  <span class="keyword">const</span> countDownButtonRef = useRef(<span class="literal">null</span>)</span><br><span class="line">[tuture-add]  <span class="keyword">let</span> userPoolId = <span class="string">''</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> dispatch = useDispatch()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">countDownButtonPressed</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!phone) &#123;</span><br><span class="line">      Taro.atMessage(&#123;</span><br><span class="line">        type: <span class="string">'error'</span>,</span><br><span class="line">        message: <span class="string">'æ‚¨è¿˜æ²¡æœ‰å¡«å†™æ‰‹æœº!'</span>,</span><br><span class="line">      &#125;)</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    countDownButtonRef.current.startCountDown()</span><br><span class="line"></span><br><span class="line">[tuture-del]    <span class="comment">// å¤„ç†å‘é€éªŒè¯ç äº‹ä»¶</span></span><br><span class="line">[tuture-add]    <span class="keyword">try</span> &#123;</span><br><span class="line">[tuture-add]      <span class="keyword">const</span> authing = <span class="keyword">new</span> Authing(&#123;</span><br><span class="line">[tuture-add]        userPoolId,</span><br><span class="line">[tuture-add]      &#125;)</span><br><span class="line">[tuture-add]      <span class="keyword">const</span> res = <span class="keyword">await</span> authing.getVerificationCode(phone)</span><br><span class="line">[tuture-add] </span><br><span class="line">[tuture-add]      <span class="keyword">if</span> (res.code === <span class="number">200</span>) &#123;</span><br><span class="line">[tuture-add]        Taro.atMessage(&#123;</span><br><span class="line">[tuture-add]          type: <span class="string">'success'</span>,</span><br><span class="line">[tuture-add]          message: <span class="string">'æ‰‹æœºéªŒè¯ç å·²ç»å‘é€æˆåŠŸï¼Œæ³¨æ„æŸ¥æ”¶'</span>,</span><br><span class="line">[tuture-add]        &#125;)</span><br><span class="line">[tuture-add]      &#125;</span><br><span class="line">[tuture-add]    &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">[tuture-add]      Taro.atMessage(&#123;</span><br><span class="line">[tuture-add]        type: <span class="string">'error'</span>,</span><br><span class="line">[tuture-add]        message: <span class="string">'éªŒè¯ç å‘é€å¤±è´¥ï¼Œè¯·ç¨åå°è¯• !'</span>,</span><br><span class="line">[tuture-add]      &#125;)</span><br><span class="line">[tuture-add]      <span class="built_in">console</span>.log(<span class="string">'err'</span>, err)</span><br><span class="line">[tuture-add]    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">handleSubmit</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    e.preventDefault()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é‰´æƒæ•°æ®</span></span><br><span class="line">    <span class="keyword">if</span> (!phone || !phoneCode) &#123;</span><br><span class="line">      Taro.atMessage(&#123;</span><br><span class="line">        type: <span class="string">'error'</span>,</span><br><span class="line">        message: <span class="string">'æ‚¨è¿˜æœ‰å†…å®¹æ²¡æœ‰å¡«å†™ï¼'</span>,</span><br><span class="line">      &#125;)</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">[tuture-del]    <span class="comment">// å¤„ç†ç™»å½•å’Œæ³¨å†Œ</span></span><br><span class="line">[tuture-add]    <span class="keyword">try</span> &#123;</span><br><span class="line">[tuture-add]      <span class="keyword">const</span> authing = <span class="keyword">new</span> Authing(&#123;</span><br><span class="line">[tuture-add]        userPoolId,</span><br><span class="line">[tuture-add]      &#125;)</span><br><span class="line">[tuture-add] </span><br><span class="line">[tuture-add]      <span class="keyword">const</span> userInfo = <span class="keyword">await</span> authing.loginByPhoneCode(&#123;</span><br><span class="line">[tuture-add]        phone,</span><br><span class="line">[tuture-add]        phoneCode,</span><br><span class="line">[tuture-add]      &#125;)</span><br><span class="line">[tuture-add] </span><br><span class="line">[tuture-add]      <span class="comment">// æç¤ºç™»å½•æˆåŠŸ</span></span><br><span class="line">[tuture-add]      Taro.atMessage(&#123;</span><br><span class="line">[tuture-add]        type: <span class="string">'success'</span>,</span><br><span class="line">[tuture-add]        message: <span class="string">'æ­å–œæ‚¨ï¼Œç™»å½•æˆåŠŸï¼'</span>,</span><br><span class="line">[tuture-add]      &#125;)</span><br><span class="line">[tuture-add] </span><br><span class="line">[tuture-add]      <span class="keyword">const</span> &#123; nickname, photo, _id &#125; = userInfo</span><br><span class="line">[tuture-add] </span><br><span class="line">[tuture-add]      <span class="comment">// å‘åç«¯å‘èµ·ç™»å½•è¯·æ±‚</span></span><br><span class="line">[tuture-add]      <span class="keyword">await</span> Taro.setStorage(&#123;</span><br><span class="line">[tuture-add]        key: <span class="string">'userInfo'</span>,</span><br><span class="line">[tuture-add]        data: &#123;</span><br><span class="line">[tuture-add]          nickName: nickname,</span><br><span class="line">[tuture-add]          avatar: photo,</span><br><span class="line">[tuture-add]          _id,</span><br><span class="line">[tuture-add]        &#125;,</span><br><span class="line">[tuture-add]      &#125;)</span><br><span class="line">[tuture-add] </span><br><span class="line">[tuture-add]      <span class="keyword">await</span> Taro.setStorage(&#123;</span><br><span class="line">[tuture-add]        key: <span class="string">'token'</span>,</span><br><span class="line">[tuture-add]        data: userInfo.token,</span><br><span class="line">[tuture-add]      &#125;)</span><br><span class="line">[tuture-add] </span><br><span class="line">[tuture-add]      dispatch(&#123;</span><br><span class="line">[tuture-add]        type: SET_LOGIN_INFO,</span><br><span class="line">[tuture-add]        payload: &#123; <span class="attr">nickName</span>: nickname, <span class="attr">avatar</span>: photo, <span class="attr">userId</span>: _id &#125;,</span><br><span class="line">[tuture-add]      &#125;)</span><br><span class="line">[tuture-add] </span><br><span class="line">[tuture-add]      dispatch(&#123; <span class="attr">type</span>: SET_IS_OPENED, <span class="attr">payload</span>: &#123; <span class="attr">isOpened</span>: <span class="literal">false</span> &#125; &#125;)</span><br><span class="line">[tuture-add]    &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">[tuture-add]      Taro.atMessage(&#123;</span><br><span class="line">[tuture-add]        type: <span class="string">'error'</span>,</span><br><span class="line">[tuture-add]        message: <span class="string">'ç™»å½•å¤±è´¥'</span>,</span><br><span class="line">[tuture-add]      &#125;)</span><br><span class="line">[tuture-add]    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;View className=<span class="string">"post-form"</span>&gt;</span><br><span class="line">      &lt;Form onSubmit=&#123;handleSubmit&#125;&gt;</span><br><span class="line">        &lt;View className=<span class="string">"login-box"</span>&gt;</span><br><span class="line">          &lt;Input</span><br><span class="line">            className=<span class="string">"input-phone input-item"</span></span><br><span class="line">            type=<span class="string">"text"</span></span><br><span class="line">            placeholder=<span class="string">"è¾“å…¥æ‰‹æœºå·"</span></span><br><span class="line">            value=&#123;phone&#125;</span><br><span class="line">            onInput=&#123;e =&gt; setPhone(e.target.value)&#125;</span><br><span class="line">          /&gt;</span><br><span class="line">          &lt;View className=<span class="string">"verify-code-box"</span>&gt;</span><br><span class="line">            &lt;Input</span><br><span class="line">              className=<span class="string">"input-nickName input-item"</span></span><br><span class="line">              type=<span class="string">"text"</span></span><br><span class="line">              placeholder=<span class="string">"å››ä½éªŒè¯ç "</span></span><br><span class="line">              value=&#123;phoneCode&#125;</span><br><span class="line">              onInput=&#123;e =&gt; setPhoneCode(e.target.value)&#125;</span><br><span class="line">            /&gt;</span><br><span class="line">            &lt;CountDownButton</span><br><span class="line">              onClick=&#123;countDownButtonPressed&#125;</span><br><span class="line">              ref=&#123;countDownButtonRef&#125;</span><br><span class="line">            /&gt;</span><br><span class="line">          &lt;<span class="regexp">/View&gt;</span></span><br><span class="line"><span class="regexp">          &lt;AtButton formType="submit" type="primary"&gt;</span></span><br><span class="line"><span class="regexp">            ç™»å½•</span></span><br><span class="line"><span class="regexp">          &lt;/</span>AtButton&gt;</span><br><span class="line">          &lt;View className=<span class="string">"at-article__info"</span>&gt;</span><br><span class="line">            é€šè¿‡æ‰‹æœºå’ŒéªŒè¯ç æ¥ç™»å½•ï¼Œå¦‚æœæ²¡æœ‰è´¦å·ï¼Œæˆ‘ä»¬å°†è‡ªåŠ¨åˆ›å»º</span><br><span class="line">          &lt;<span class="regexp">/View&gt;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>View&gt;</span><br><span class="line">      &lt;<span class="regexp">/Form&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>View&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°ï¼Œä¸Šé¢çš„å†…å®¹ä¸»è¦æœ‰å¦‚ä¸‹å‡ å¤„ä¿®æ”¹ï¼š</p>
<ul>
<li>æˆ‘ä»¬é¦–å…ˆå¼•å…¥äº†ä¸Šä¸€æ­¥é‡Œé¢ä¸‹è½½çš„ Authing  SDK</li>
<li>æ¥ç€æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ª <code>userPoolId</code> ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬å‰é¢åˆ›å»º â€œå›¾é›€ç¤¾åŒºåšå®¢å°ç¨‹åºâ€ ç”¨æˆ·æ± çš„æ ‡å¿— IDï¼Œè¿™é‡Œè¯»è€…éœ€è¦å‰å¾€ Authing æ§åˆ¶å°ç•Œé¢ï¼Œè·å–ç”¨æˆ·æ±  IDï¼Œå¹¶æ›¿æ¢ä¸Šé¢çš„ç©ºå­—ç¬¦ä¸²ï¼š</li>
</ul>
<p><img alt data-src="https://static.powerformer.com/c/34a473b/172281ab9d8b1772.png"></p>
<ul>
<li>æ¥ç€æˆ‘ä»¬åœ¨ <code>countDownButtonPressed</code> å‡½æ•°å†…è¿›è¡Œå‘èµ·æ‰‹æœºéªŒè¯ç æ“ä½œï¼Œæˆ‘ä»¬é¦–å…ˆä½¿ç”¨ <code>new Authing</code> ä¼ å…¥ç”¨æˆ·æ±  ID <code>userPoolId</code> åˆå§‹åŒ–ä¸€ä¸ªä¸€ä¸ªå®ä¾‹å¹¶å‘½åä¸º <code>authing</code> ï¼Œè¿™ä¸€æ­¥ä»£è¡¨æˆ‘ä»¬æ‹¿åˆ°äº†æ­¤é¡µç”¨æˆ·æ± çš„æ“ä½œæƒï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œç”¨æˆ·æœ‰å…³çš„æ“ä½œäº†ã€‚</li>
<li>æ¥ç€æˆ‘ä»¬ä½¿ç”¨ <code>authing.getVerificationCode</code> æ–¹æ³•ï¼Œä¼ å…¥å¡«å†™çš„æ‰‹æœºå· <code>phone</code> ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¼‚æ­¥ Promise å¯¹è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨ <code>await</code> å…³é”®å­—è·å–å…¶ç»“æœï¼Œå½“ç»“æœ <code>res.code</code> ä¸º 200ï¼Œä»£è¡¨å‘é€éªŒè¯ç æˆåŠŸï¼Œæˆ‘ä»¬æç¤ºç”¨æˆ·å‘é€éªŒè¯ç æˆåŠŸï¼Œå¦åˆ™æé†’å‘é€éªŒè¯ç å¤±è´¥ï¼Œå½“ç¼–å†™äº†ä¸Šé¢çš„ä»£ç å¹¶ä¿å­˜ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥æ‰“å¼€å°ç¨‹åºå°è¯•ä¸€ä¸‹æ•ˆæœï¼Œè¾“å…¥æ‰‹æœºå·ï¼Œå¹¶ç‚¹å‡»å‘é€éªŒè¯ç ï¼š</li>
</ul>
<p><img alt data-src="https://static.powerformer.com/c/34a473b/172281aba373023a.gif"></p>
<p>å½“ç„¶ä¸Šé¢çš„æ‰‹æœºå·æˆ‘çè¾“å…¥çš„ï¼Œè¯»è€…è¯·è‡ªè¡Œè¾“å…¥è‡ªå·±çš„æ‰‹æœºå·å°è¯•ï¼Œæ¥ç€åº”è¯¥å¯ä»¥åœ¨æ‰‹æœºä¸Šæ”¶åˆ°éªŒè¯ç çŸ­ä¿¡ï¼š</p>
<p><img alt data-src="https://static.powerformer.com/c/34a473b/172281aba386117a.jpeg"></p>
<p>BoomğŸ’¥ï¼å¯ä»¥çœ‹åˆ°ç®€å•å‡ è¡Œä»£ç ï¼Œæˆ‘ä»¬å°±æå®šäº†æ‰‹æœºéªŒè¯ç çš„å‘é€ã€‚</p>
<ul>
<li>æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦å®Œå–„ä¸€ä¸‹ä½¿ç”¨æ‰‹æœº+éªŒè¯ç ç™»å½•çš„é€»è¾‘ï¼Œæˆ‘ä»¬åœ¨ <code>handleSubmit</code> é‡Œé¢ç¼–å†™äº†ä¸€ä¸ª <code>try/catch</code> è¯­å¥ï¼Œç„¶ååˆå§‹åŒ– Authing å¯¹è±¡ï¼Œå¹¶è°ƒç”¨æ–¹æ³• <code>authing.loginByPhoneCode</code> ä¼ å…¥æˆ‘ä»¬çš„æ‰‹æœºå·ï¼ˆ<code>phone</code> ï¼‰å’ŒéªŒè¯ç  <code>phoneCode</code> ï¼Œè¿›è¡Œè°ƒç”¨ä¹‹åï¼Œæˆ‘ä»¬å°±å®Œæˆäº†æ‰‹æœºå·+éªŒè¯ç ç™»å½•ï¼Œè¿™ä¸ªæ–¹æ³•é»˜è®¤ä¼šå¯¹æœªç™»å½•ç”¨æˆ·è¿›è¡Œåˆ›å»ºè´¦å·æ“ä½œï¼Œä¸éœ€è¦ç”¨æˆ·é¢å¤–å¤„ç†å…¶ä»–é€»è¾‘ã€‚</li>
<li>æ¥ç€ï¼Œæˆ‘ä»¬é€šè¿‡ç™»å½•æˆåŠŸè¿”å›çš„ <code>userInfo</code> æ‹¿åˆ°å†…å®¹ï¼Œåšå‡ºä¿®æ”¹å¹¶è®¾ç½®åˆ° <code>storage</code> é‡Œï¼Œä»¥åŠå­˜åœ¨  Redux Store é‡Œé¢ï¼Œå¹¶æç¤ºç”¨æˆ·ç™»å½•æˆåŠŸã€‚å½“ç„¶å¦‚æœç™»å½•å¤±è´¥ï¼Œæˆ‘ä»¬è¿˜ä¼šæç¤ºç”¨æˆ·ç™»å½•å¤±è´¥ã€‚</li>
</ul>
<div class="note info">
            <p><strong>æç¤º</strong></p><ol><li>è¿™é‡Œæˆ‘ä»¬åšäº†æ•°æ®æ ¼å¼çš„é€‚åº”ï¼Œå¦‚å°† Authing ç™»å½•è¿”å›çš„ç”¨æˆ·ä¿¡æ¯ <code>userInfo.nickname</code> é€‚åº”æˆ <code>nickName</code> ï¼Œæ˜¯ä¸ºäº†åŒ¹é…ä¹‹å‰çš„å°ç¨‹åºç³»ç»Ÿçš„æ•°æ®æ ¼å¼ã€‚</li><li>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬é¢å¤–å­˜äº†ä¸€ä¸ª <code>userInfo.token</code> åˆ° <code>storage</code> é‡Œé¢ï¼Œè¿™ä¸ª <code>token</code> å°±æ˜¯æˆ‘ä»¬ç”¨æˆ·ç³»ç»Ÿé‡Œé¢ç”¨äºç”¨æˆ·é‰´æƒçš„æ ‡å¿—ï¼Œä¹‹åæˆ‘ä»¬å°†ç”¨è¿™ä¸ª token æ¥æ£€æŸ¥ç”¨æˆ·çš„ç™»å½•çŠ¶æ€å¹¶è¿›è¡Œç”¨æˆ·ç™»å½•æ€çš„ä¿æŒã€‚</li></ol>
          </div>

<p>ä¸€åˆ‡å‡†å¤‡å°±ç»ªï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å¡«å…¥æ‰‹æœºå·ï¼Œç‚¹å‡»è·å–éªŒè¯ç ï¼Œå¹¶å°†éªŒè¯ç å¡«å…¥å°ç¨‹åºçš„è¾“å…¥æ¡†ï¼Œç‚¹å‡»ç™»å½•åº”è¯¥å°±å¯ä»¥ç™»å½•æˆåŠŸï¼š</p>
<p><img alt data-src="https://static.powerformer.com/c/34a473b/172281abae530ec7.png"></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬æ”¶è·äº†ä¸€ä¸ªé»˜è®¤çš„ â€œé…·é…·çš„å¤´åƒâ€ï¼Œå¹¶ä¸”æç¤ºäº†ç™»å½•æˆåŠŸã€‚å¤§åŠŸå‘Šæˆï¼Œä¸€ä¸ªä¸“ä¸šçš„åªéœ€è¦æ‰‹æœºå·+éªŒè¯ç çš„ç™»å½•ç•Œé¢+é€»è¾‘æˆ‘ä»¬å°±å®Œæ•´å®ç°äº†ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬ä¸»è¦åœ¨ç•Œé¢çš„è°ƒæ•´å’Œ SDKçš„å¼•å…¥ä¸ŠåºŸäº†ä¸€ç‚¹åŠŸå¤«ï¼Œå®é™…ä¸Šå®ç°æ•´ä¸ªé€»è¾‘ï¼ŒçœŸçš„åªéœ€è¦å‡ è¡Œä»£ç ï¼å› ä¸º Authing åœ¨èƒŒååšäº†å¤§é‡çš„å·¥ä½œæ¥ç¡®ä¿ä¸Šå±‚é€»è¾‘çš„ç®€å•ã€‚</p>
<h2 id="å¤„ç†ç™»å‡ºé€»è¾‘"><a href="#å¤„ç†ç™»å‡ºé€»è¾‘" class="headerlink" title="å¤„ç†ç™»å‡ºé€»è¾‘"></a>å¤„ç†ç™»å‡ºé€»è¾‘</h2><p>åœ¨ä¸Šä¸€å°èŠ‚ä¸­ï¼Œæˆ‘ä»¬æˆåŠŸå°†ç™»å½•é€»è¾‘è¿ç§»åˆ°äº†æ‰‹æœºå·+éªŒè¯ç çš„æ–¹å¼ï¼Œå¹¶ä¸”é€šè¿‡ç®€å•å‡ è¡Œä»£ç å®ç°äº†éªŒè¯ç çš„å‘é€ï¼Œä»¥åŠç™»å½•ã€‚</p>
<p>å› ä¸ºæˆ‘ä»¬çš„ç™»å½•é€»è¾‘ç›¸æ¯”ä¹‹å‰æœ‰äº†ä¸€äº›å˜åŒ–ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦é€‚å½“çš„è°ƒæ•´æˆ‘ä»¬çš„ç™»å‡ºé€»è¾‘ï¼Œä»¥é€‚åº”è¿™äº›å˜åŒ–ã€‚</p>
<h3 id="æ”¹è¿›ç™»å‡ºç»„ä»¶"><a href="#æ”¹è¿›ç™»å‡ºç»„ä»¶" class="headerlink" title="æ”¹è¿›ç™»å‡ºç»„ä»¶"></a>æ”¹è¿›ç™»å‡ºç»„ä»¶</h3><p>æ‰“å¼€ <code>src/components/Logout/index.js</code> æ–‡ä»¶ï¼Œå¯¹å…¶ä¸­çš„å†…å®¹åšå‡ºå¯¹åº”çš„ä¿®æ”¹ï¼š</p>
<figure class="highlight js"><figcaption><span>src/components/Logout/index.js</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvdWx0cmEtY2x1Yi9ibG9iL2EyMzcyNmE2YjI4ZGM3ODMzMGM3OTQ1NjNlZTQ5Yjc5ODAzMDMyNjYvc3JjL2NvbXBvbmVudHMvTG9nb3V0L2luZGV4Lmpz" title="https://github.com/tuture-dev/ultra-club/blob/a23726a6b28dc78330c794563ee49b7980303266/src/components/Logout/index.js">æŸ¥çœ‹å®Œæ•´ä»£ç <i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Taro, &#123; useState &#125; <span class="keyword">from</span> <span class="string">'@tarojs/taro'</span></span><br><span class="line"><span class="keyword">import</span> &#123; AtButton &#125; <span class="keyword">from</span> <span class="string">'taro-ui'</span></span><br><span class="line">[tuture-del]<span class="keyword">import</span> &#123; useDispatch &#125; <span class="keyword">from</span> <span class="string">'@tarojs/redux'</span></span><br><span class="line">[tuture-add]<span class="keyword">import</span> &#123; useDispatch, useSelector &#125; <span class="keyword">from</span> <span class="string">'@tarojs/redux'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; SET_LOGIN_INFO &#125; <span class="keyword">from</span> <span class="string">'../../constants'</span></span><br><span class="line">[tuture-add]<span class="keyword">import</span> Authing <span class="keyword">from</span> <span class="string">'../../utils/authing/authing'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">LoginButton</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> [isLogout, setIsLogout] = useState(<span class="literal">false</span>)</span><br><span class="line">  <span class="keyword">const</span> dispatch = useDispatch()</span><br><span class="line">[tuture-add]  <span class="keyword">const</span> userId = useSelector(<span class="function"><span class="params">state</span> =&gt;</span> state.user.userId)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">handleLogout</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    setIsLogout(<span class="literal">true</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">await</span> Taro.removeStorage(&#123; <span class="attr">key</span>: <span class="string">'userInfo'</span> &#125;)</span><br><span class="line">[tuture-add]      <span class="keyword">await</span> Taro.removeStorage(&#123; <span class="attr">key</span>: <span class="string">'token'</span> &#125;)</span><br><span class="line">[tuture-add] </span><br><span class="line">[tuture-add]      <span class="keyword">const</span> userPoolId = <span class="string">''</span></span><br><span class="line">[tuture-add]      <span class="keyword">const</span> authing = <span class="keyword">new</span> Authing(&#123;</span><br><span class="line">[tuture-add]        userPoolId,</span><br><span class="line">[tuture-add]      &#125;)</span><br><span class="line">[tuture-add] </span><br><span class="line">[tuture-add]      <span class="keyword">await</span> authing.logout(userId)</span><br><span class="line"></span><br><span class="line">      dispatch(&#123;</span><br><span class="line">        type: SET_LOGIN_INFO,</span><br><span class="line">        payload: &#123;</span><br><span class="line">          avatar: <span class="string">''</span>,</span><br><span class="line">          nickName: <span class="string">''</span>,</span><br><span class="line">          userId: <span class="string">''</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'removeStorage ERR: '</span>, err)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    setIsLogout(<span class="literal">false</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;AtButton type=<span class="string">"secondary"</span> full loading=&#123;isLogout&#125; onClick=&#123;handleLogout&#125;&gt;</span><br><span class="line">      é€€å‡ºç™»å½•</span><br><span class="line">    &lt;<span class="regexp">/AtButton&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°ï¼Œä¸Šé¢çš„å†…å®¹ä¸»è¦æœ‰å¦‚ä¸‹å‡ å¤„ä¿®æ”¹ï¼š</p>
<ul>
<li>æˆ‘ä»¬åœ¨ <code>handleLogout</code> å‡½æ•°é‡Œå¤„ç†ç™»å‡ºé€»è¾‘çš„æ—¶å€™ï¼Œé¦–å…ˆåˆå§‹åŒ–äº†ä¸€ä¸ª <code>authing</code> å®ä¾‹ï¼Œä¸»è¦è¿™é‡Œçš„ <code>userPoolId</code> ä¹Ÿéœ€è¦è¯»è€…æ›¿æ¢æˆä½ è‡ªå·±çš„ï¼Œå¯ä»¥åœ¨ Authing æ§åˆ¶å°è·å–ï¼Œæ¥ç€è°ƒç”¨ <code>authing.logout</code> ä¼ å…¥ç”¨æˆ·çš„ <code>userId</code> æ¥ç™»å‡ºæ­¤ç”¨æˆ·ï¼Œè¿™æ ·ä¹‹åå°±ä¸èƒ½æ“ä½œ Authing ä¸Šåˆ›å»ºçš„ç”¨æˆ·æ± äº†</li>
<li>å…³äº <code>userId</code> çš„è·å–ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† <code>react-redux</code> é’©å­ <code>useSelector</code> ä» Redux Store é‡Œé¢è·å–ã€‚</li>
<li>æœ€åæˆ‘ä»¬è¿˜è¦åˆ é™¤ <code>storage</code> é‡Œé¢å­˜å‚¨çš„ <code>token</code> ã€‚</li>
</ul>
<h3 id="æ¸…ç†å…¶ä»–ç™»å‡ºé€»è¾‘"><a href="#æ¸…ç†å…¶ä»–ç™»å‡ºé€»è¾‘" class="headerlink" title="æ¸…ç†å…¶ä»–ç™»å‡ºé€»è¾‘"></a>æ¸…ç†å…¶ä»–ç™»å‡ºé€»è¾‘</h3><p>å› ä¸ºç›®å‰æˆ‘ä»¬çš„ç™»é™†ä¸æ˜¯ä¹‹å‰çš„ä½¿ç”¨ <code>nickName</code> å’Œ <code>avatar</code> ï¼Œè€Œæ˜¯ä½¿ç”¨æ‰‹æœºå·+éªŒè¯ç ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸€ç™»å½•ä¹‹åé»˜è®¤çš„ <code>nickName</code> ä¸ºç©ºï¼Œè€Œæˆ‘ä»¬ä¹‹å‰çš„åˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç™»å½•çš„ç»„ä»¶é€»è¾‘éƒ½æ˜¯åˆ¤æ–­ <code>nickName</code> æ˜¯å¦å­˜åœ¨ï¼Œè¿™é‡Œå°±æœ‰é—®é¢˜äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¿®æ”¹ä¸€ä¸‹ã€‚</p>
<p>æ‰“å¼€ <code>src/components/Footer/index.js</code> æ–‡ä»¶ï¼Œå¯¹å…¶ä¸­çš„å†…å®¹ä½œå‡ºå¯¹åº”çš„ä¿®æ”¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><figcaption><span>src/components/Footer/index.js</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvdWx0cmEtY2x1Yi9ibG9iL2EyMzcyNmE2YjI4ZGM3ODMzMGM3OTQ1NjNlZTQ5Yjc5ODAzMDMyNjYvc3JjL2NvbXBvbmVudHMvRm9vdGVyL2luZGV4Lmpz" title="https://github.com/tuture-dev/ultra-club/blob/a23726a6b28dc78330c794563ee49b7980303266/src/components/Footer/index.js">æŸ¥çœ‹å®Œæ•´ä»£ç <i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Taro <span class="keyword">from</span> <span class="string">'@tarojs/taro'</span></span><br><span class="line"><span class="keyword">import</span> &#123; View &#125; <span class="keyword">from</span> <span class="string">'@tarojs/components'</span></span><br><span class="line"><span class="keyword">import</span> &#123; AtFloatLayout &#125; <span class="keyword">from</span> <span class="string">'taro-ui'</span></span><br><span class="line"><span class="keyword">import</span> &#123; useSelector, useDispatch &#125; <span class="keyword">from</span> <span class="string">'@tarojs/redux'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> Logout <span class="keyword">from</span> <span class="string">'../Logout'</span></span><br><span class="line"><span class="keyword">import</span> LoginForm <span class="keyword">from</span> <span class="string">'../LoginForm'</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'./index.scss'</span></span><br><span class="line"><span class="keyword">import</span> &#123; SET_IS_OPENED &#125; <span class="keyword">from</span> <span class="string">'../../constants'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">Footer</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">[tuture-del]  <span class="keyword">const</span> nickName = useSelector(<span class="function"><span class="params">state</span> =&gt;</span> state.user.nickName)</span><br><span class="line">[tuture-add]  <span class="keyword">const</span> userId = useSelector(<span class="function"><span class="params">state</span> =&gt;</span> state.user.userId)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> dispatch = useDispatch()</span><br><span class="line"></span><br><span class="line">  <span class="comment">// åŒå–åæ¥æ„é€ å­—ç¬¦ä¸²å¯¹åº”çš„å¸ƒå°”å€¼ï¼Œç”¨äºæ ‡å¿—æ­¤æ—¶æ˜¯å¦ç”¨æˆ·å·²ç»ç™»å½•</span></span><br><span class="line">[tuture-del]  <span class="keyword">const</span> isLogged = !!nickName</span><br><span class="line">[tuture-add]  <span class="keyword">const</span> isLogged = !!userId</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ä½¿ç”¨ useSelector Hooks è·å– Redux Store æ•°æ®</span></span><br><span class="line">  <span class="keyword">const</span> isOpened = useSelector(<span class="function"><span class="params">state</span> =&gt;</span> state.user.isOpened)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;View className=<span class="string">"mine-footer"</span>&gt;</span><br><span class="line">      &#123;isLogged &amp;&amp; <span class="xml"><span class="tag">&lt;<span class="name">Logout</span> /&gt;</span></span>&#125;</span><br><span class="line">      &lt;View className=<span class="string">"tuture-motto"</span>&gt;</span><br><span class="line">        &#123;isLogged ? <span class="string">'From å›¾é›€ç¤¾åŒº with Love â¤'</span> : <span class="string">'æ‚¨è¿˜æœªç™»å½•'</span>&#125;</span><br><span class="line">      &lt;<span class="regexp">/View&gt;</span></span><br><span class="line"><span class="regexp">      &lt;AtFloatLayout</span></span><br><span class="line"><span class="regexp">        isOpened=&#123;isOpened&#125;</span></span><br><span class="line"><span class="regexp">        title="ç™»å½•"</span></span><br><span class="line"><span class="regexp">        onClose=&#123;() =&gt;</span></span><br><span class="line"><span class="regexp">          dispatch(&#123; type: SET_IS_OPENED, payload: &#123; isOpened: false &#125; &#125;)</span></span><br><span class="line"><span class="regexp">        &#125;</span></span><br><span class="line"><span class="regexp">      &gt;</span></span><br><span class="line"><span class="regexp">        &lt;LoginForm /</span>&gt;</span><br><span class="line">      &lt;<span class="regexp">/AtFloatLayout&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>View&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°ï¼Œä¸Šé¢çš„å†…å®¹ä¸»è¦å°±æ˜¯å°† <code>nickName</code> æ›¿æ¢æˆäº† <code>userId</code> ï¼Œå¹¶ç”¨ <code>userId</code> åˆ¤æ–­æ˜¯å¦å¤„äºç™»å½•çŠ¶æ€ã€‚</p>
<p>åŒæ ·çš„ï¼Œ<code>src/components/Header/index.js</code> ä¹Ÿè¦ä½œå‡ºç±»ä¼¼çš„ä¿®æ”¹ï¼š</p>
<figure class="highlight js"><figcaption><span>src/components/Header/index.js</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvdWx0cmEtY2x1Yi9ibG9iL2EyMzcyNmE2YjI4ZGM3ODMzMGM3OTQ1NjNlZTQ5Yjc5ODAzMDMyNjYvc3JjL2NvbXBvbmVudHMvSGVhZGVyL2luZGV4Lmpz" title="https://github.com/tuture-dev/ultra-club/blob/a23726a6b28dc78330c794563ee49b7980303266/src/components/Header/index.js">æŸ¥çœ‹å®Œæ•´ä»£ç <i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Taro <span class="keyword">from</span> <span class="string">'@tarojs/taro'</span></span><br><span class="line"><span class="keyword">import</span> &#123; View &#125; <span class="keyword">from</span> <span class="string">'@tarojs/components'</span></span><br><span class="line"><span class="keyword">import</span> &#123; AtMessage &#125; <span class="keyword">from</span> <span class="string">'taro-ui'</span></span><br><span class="line"><span class="keyword">import</span> &#123; useSelector &#125; <span class="keyword">from</span> <span class="string">'@tarojs/redux'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> LoggedMine <span class="keyword">from</span> <span class="string">'../LoggedMine'</span></span><br><span class="line"><span class="keyword">import</span> LoginButton <span class="keyword">from</span> <span class="string">'../LoginButton'</span></span><br><span class="line"><span class="keyword">import</span> WeappLoginButton <span class="keyword">from</span> <span class="string">'../WeappLoginButton'</span></span><br><span class="line"><span class="keyword">import</span> AlipayLoginButton <span class="keyword">from</span> <span class="string">'../AlipayLoginButton'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">'./index.scss'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">Header</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">[tuture-del]  <span class="keyword">const</span> nickName = useSelector(<span class="function"><span class="params">state</span> =&gt;</span> state.user.nickName)</span><br><span class="line">[tuture-add]  <span class="keyword">const</span> userId = useSelector(<span class="function"><span class="params">state</span> =&gt;</span> state.user.userId)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// åŒå–åæ¥æ„é€ å­—ç¬¦ä¸²å¯¹åº”çš„å¸ƒå°”å€¼ï¼Œç”¨äºæ ‡å¿—æ­¤æ—¶æ˜¯å¦ç”¨æˆ·å·²ç»ç™»å½•</span></span><br><span class="line">[tuture-del]  <span class="keyword">const</span> isLogged = !!nickName</span><br><span class="line">[tuture-add]  <span class="keyword">const</span> isLogged = !!userId</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> isWeapp = Taro.getEnv() === Taro.ENV_TYPE.WEAPP</span><br><span class="line">  <span class="keyword">const</span> isAlipay = Taro.getEnv() === Taro.ENV_TYPE.ALIPAY</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;View className=<span class="string">"user-box"</span>&gt;</span><br><span class="line">      &lt;AtMessage /&gt;</span><br><span class="line">      &lt;LoggedMine /&gt;</span><br><span class="line">      &#123;!isLogged &amp;&amp; (</span><br><span class="line">        &lt;View className=<span class="string">"login-button-box"</span>&gt;</span><br><span class="line">          &lt;LoginButton /&gt;</span><br><span class="line">          &#123;isWeapp &amp;&amp; <span class="xml"><span class="tag">&lt;<span class="name">WeappLoginButton</span> /&gt;</span></span>&#125;</span><br><span class="line">          &#123;isAlipay &amp;&amp; <span class="xml"><span class="tag">&lt;<span class="name">AlipayLoginButton</span> /&gt;</span></span>&#125;</span><br><span class="line">        &lt;<span class="regexp">/View&gt;</span></span><br><span class="line"><span class="regexp">      )&#125;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>View&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿˜æœ‰æˆ‘ä»¬çš„ â€œæˆ‘çš„â€ é¡µé¢ï¼Œ<code>src/pages/mine/mine.jsx</code> æ–‡ä»¶ï¼š</p>
<figure class="highlight jsx"><figcaption><span>src/pages/mine/mine.jsx</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvdWx0cmEtY2x1Yi9ibG9iL2EyMzcyNmE2YjI4ZGM3ODMzMGM3OTQ1NjNlZTQ5Yjc5ODAzMDMyNjYvc3JjL3BhZ2VzL21pbmUvbWluZS5qc3g=" title="https://github.com/tuture-dev/ultra-club/blob/a23726a6b28dc78330c794563ee49b7980303266/src/pages/mine/mine.jsx">æŸ¥çœ‹å®Œæ•´ä»£ç <i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Taro, &#123; useEffect &#125; <span class="keyword">from</span> <span class="string">'@tarojs/taro'</span></span><br><span class="line"><span class="keyword">import</span> &#123; View &#125; <span class="keyword">from</span> <span class="string">'@tarojs/components'</span></span><br><span class="line"><span class="keyword">import</span> &#123; useDispatch, useSelector &#125; <span class="keyword">from</span> <span class="string">'@tarojs/redux'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; Header, Footer &#125; <span class="keyword">from</span> <span class="string">'../../components'</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'./mine.scss'</span></span><br><span class="line"><span class="keyword">import</span> &#123; SET_LOGIN_INFO &#125; <span class="keyword">from</span> <span class="string">'../../constants'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">Mine</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> dispatch = useDispatch()</span><br><span class="line">[tuture-del]  <span class="keyword">const</span> nickName = useSelector(<span class="function"><span class="params">state</span> =&gt;</span> state.user.nickName)</span><br><span class="line">[tuture-add]  <span class="keyword">const</span> userId = useSelector(<span class="function"><span class="params">state</span> =&gt;</span> state.user.userId)</span><br><span class="line"></span><br><span class="line">[tuture-del]  <span class="keyword">const</span> isLogged = !!nickName</span><br><span class="line">[tuture-add]  <span class="keyword">const</span> isLogged = !!userId</span><br><span class="line"></span><br><span class="line">  useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">getStorage</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; data &#125; = <span class="keyword">await</span> Taro.getStorage(&#123; <span class="attr">key</span>: <span class="string">'userInfo'</span> &#125;)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> &#123; nickName, avatar, _id &#125; = data</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ›´æ–° Redux Store æ•°æ®</span></span><br><span class="line">        dispatch(&#123;</span><br><span class="line">          type: SET_LOGIN_INFO,</span><br><span class="line">          payload: &#123; nickName, avatar, <span class="attr">userId</span>: _id &#125;,</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'getStorage ERR: '</span>, err)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!isLogged) &#123;</span><br><span class="line">      getStorage()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;View className=<span class="string">"mine"</span>&gt;</span><br><span class="line">      &lt;Header /&gt;</span><br><span class="line">      &lt;Footer /&gt;</span><br><span class="line">    &lt;<span class="regexp">/View&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">Mine.config = &#123;</span></span><br><span class="line"><span class="regexp">  navigationBarTitleText: 'æˆ‘çš„',</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>

<p>æœ€åï¼Œæˆ‘ä»¬ä¿®æ”¹é¦–é¡µçš„ <code>src/pages/index/index.jsx</code> ï¼š</p>
<figure class="highlight jsx"><figcaption><span>src/pages/index/index.jsx</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvdWx0cmEtY2x1Yi9ibG9iL2EyMzcyNmE2YjI4ZGM3ODMzMGM3OTQ1NjNlZTQ5Yjc5ODAzMDMyNjYvc3JjL3BhZ2VzL2luZGV4L2luZGV4LmpzeA==" title="https://github.com/tuture-dev/ultra-club/blob/a23726a6b28dc78330c794563ee49b7980303266/src/pages/index/index.jsx">æŸ¥çœ‹å®Œæ•´ä»£ç <i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Taro, &#123; useEffect &#125; <span class="keyword">from</span> <span class="string">'@tarojs/taro'</span></span><br><span class="line"><span class="keyword">import</span> &#123; View, Text &#125; <span class="keyword">from</span> <span class="string">'@tarojs/components'</span></span><br><span class="line"><span class="keyword">import</span> &#123; AtFab, AtFloatLayout, AtMessage &#125; <span class="keyword">from</span> <span class="string">'taro-ui'</span></span><br><span class="line"><span class="keyword">import</span> &#123; useSelector, useDispatch &#125; <span class="keyword">from</span> <span class="string">'@tarojs/redux'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; PostCard, PostForm &#125; <span class="keyword">from</span> <span class="string">'../../components'</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'./index.scss'</span></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  SET_POST_FORM_IS_OPENED,</span><br><span class="line">  SET_LOGIN_INFO,</span><br><span class="line">  GET_POSTS,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">'../../constants'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">Index</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> posts = useSelector(<span class="function"><span class="params">state</span> =&gt;</span> state.post.posts) || []</span><br><span class="line">  <span class="keyword">const</span> isOpened = useSelector(<span class="function"><span class="params">state</span> =&gt;</span> state.post.isOpened)</span><br><span class="line">[tuture-del]  <span class="keyword">const</span> nickName = useSelector(<span class="function"><span class="params">state</span> =&gt;</span> state.user.nickName)</span><br><span class="line">[tuture-add]  <span class="keyword">const</span> userId = useSelector(<span class="function"><span class="params">state</span> =&gt;</span> state.user.userId)</span><br><span class="line"></span><br><span class="line">[tuture-del]  <span class="keyword">const</span> isLogged = !!nickName</span><br><span class="line">[tuture-add]  <span class="keyword">const</span> isLogged = !!userId</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> dispatch = useDispatch()</span><br><span class="line"></span><br><span class="line">  useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> WeappEnv = Taro.getEnv() === Taro.ENV_TYPE.WEAPP</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (WeappEnv) &#123;</span><br><span class="line">      Taro.cloud.init()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">getStorage</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; data &#125; = <span class="keyword">await</span> Taro.getStorage(&#123; <span class="attr">key</span>: <span class="string">'userInfo'</span> &#125;)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> &#123; nickName, avatar, _id &#125; = data</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ›´æ–° Redux Store æ•°æ®</span></span><br><span class="line">        dispatch(&#123;</span><br><span class="line">          type: SET_LOGIN_INFO,</span><br><span class="line">          payload: &#123; nickName, avatar, <span class="attr">userId</span>: _id &#125;,</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'getStorage ERR: '</span>, err)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!isLogged) &#123;</span><br><span class="line">      getStorage()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">getPosts</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// æ›´æ–° Redux Store æ•°æ®</span></span><br><span class="line">        dispatch(&#123;</span><br><span class="line">          type: GET_POSTS,</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'getPosts ERR: '</span>, err)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!posts.length) &#123;</span><br><span class="line">      getPosts()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">setIsOpened</span>(<span class="params">isOpened</span>) </span>&#123;</span><br><span class="line">    dispatch(&#123; <span class="attr">type</span>: SET_POST_FORM_IS_OPENED, <span class="attr">payload</span>: &#123; isOpened &#125; &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">handleClickEdit</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!isLogged) &#123;</span><br><span class="line">      Taro.atMessage(&#123;</span><br><span class="line">        type: <span class="string">'warning'</span>,</span><br><span class="line">        message: <span class="string">'æ‚¨è¿˜æœªç™»å½•å“¦ï¼'</span>,</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      setIsOpened(<span class="literal">true</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'posts'</span>, posts)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;View className=<span class="string">"index"</span>&gt;</span><br><span class="line">      &lt;AtMessage /&gt;</span><br><span class="line">      &#123;posts.map(<span class="function"><span class="params">post</span> =&gt;</span> (</span><br><span class="line">        &lt;PostCard key=&#123;post._id&#125; postId=&#123;post._id&#125; post=&#123;post&#125; isList /&gt;</span><br><span class="line">      ))&#125;</span><br><span class="line">      &lt;AtFloatLayout</span><br><span class="line">        isOpened=&#123;isOpened&#125;</span><br><span class="line">        title=<span class="string">"å‘è¡¨æ–°æ–‡ç« "</span></span><br><span class="line">        onClose=&#123;() =&gt; setIsOpened(<span class="literal">false</span>)&#125;</span><br><span class="line">      &gt;</span><br><span class="line">        &lt;PostForm /&gt;</span><br><span class="line">      &lt;<span class="regexp">/AtFloatLayout&gt;</span></span><br><span class="line"><span class="regexp">      &lt;View className="post-button"&gt;</span></span><br><span class="line"><span class="regexp">        &lt;AtFab onClick=&#123;handleClickEdit&#125;&gt;</span></span><br><span class="line"><span class="regexp">          &lt;Text className="at-fab__icon at-icon at-icon-edit"&gt;&lt;/</span>Text&gt;</span><br><span class="line">        &lt;<span class="regexp">/AtFab&gt;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>View&gt;</span><br><span class="line">    &lt;<span class="regexp">/View&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">Index.config = &#123;</span></span><br><span class="line"><span class="regexp">  navigationBarTitleText: 'é¦–é¡µ',</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹äº†å¦‚ä¸Šä»£ç å¹¶ä¿å­˜ä¹‹åï¼Œæ‰“å¼€åº”ç”¨ï¼Œæˆ‘ä»¬ç‚¹å‡»ç™»å‡ºï¼Œåº”è¯¥é¡ºåˆ©çœ‹åˆ°å¦‚ä¸‹æ•ˆæœï¼š</p>
<p><img alt data-src="https://static.powerformer.com/c/34a473b/172281abc7d4f9b3.gif"></p>
<h3 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>åœ¨è¿™ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å‘¼åº”ä½¿ç”¨ Authing ç™»å½•çš„é€»è¾‘ï¼Œå¯¹åº”ä¿®æ”¹äº†ç™»å‡ºé€»è¾‘ï¼Œå¹¶ä¸”ä½¿ç”¨ <code>userId</code> æ›¿æ¢ <code>nickName</code> ä½œä¸ºæ˜¯å¦ç™»å½•çš„åˆ¤æ–­æ ‡å‡†ã€‚</p>
<h2 id="é›†æˆå¾®ä¿¡æˆæƒç™»å½•"><a href="#é›†æˆå¾®ä¿¡æˆæƒç™»å½•" class="headerlink" title="é›†æˆå¾®ä¿¡æˆæƒç™»å½•"></a>é›†æˆå¾®ä¿¡æˆæƒç™»å½•</h2><p>åœ¨å‰ä¸¤å°èŠ‚ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ Authing é›†æˆäº†æ‰‹æœºå·+éªŒè¯ç çš„ç™»å½•é€»è¾‘ï¼Œç„¶åå¤„ç†äº†ç™»å‡ºé€»è¾‘ï¼Œæœ‰åŒå­¦å¯èƒ½ä¼šé—®äº†ï¼Œæˆ‘ä»¬ä¹‹å‰æ˜¯å–ä»£äº†æ™®é€šç™»å½•ï¼Œè¿˜æœ‰ä¸€ä¸ªå¾®ä¿¡ç™»å½•ï¼Œæˆ‘ä»¬æ˜¯ä¸æ˜¯ä¹Ÿå¯ä»¥ç”¨ Authing æ¥è¿›è¡Œæ›¿æ¢å‘¢ï¼Ÿæ¯•ç«Ÿé›†æˆç”¨æˆ·ç³»ç»Ÿè‚¯å®šè¦å…¨é¢é›†æˆï¼Œç­”æ¡ˆæ˜¯å¯ä»¥ï¼</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å°†ä½¿ç”¨ Authing ä¸ºæˆ‘ä»¬æä¾›çš„ <code>loginWithWxapp</code> ï¼Œå¿«æ·çš„å°†å¾®ä¿¡æˆæƒç™»å½•é›†æˆå¥½ï¼Œæ‰“å¼€ <code>src/components/WeappLoginButton/index.js</code> æ–‡ä»¶ï¼Œå¯¹å…¶ä¸­çš„å†…å®¹ä½œå‡ºå¯¹åº”çš„ä¿®æ”¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><figcaption><span>src/components/WeappLoginButton/index.js</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvdWx0cmEtY2x1Yi9ibG9iLzI5Y2UwNWJkYjc0ZGQ1M2Y2ZDgzYjgyNTkxMTg2ZDJkMWQxMDgzNWIvc3JjL2NvbXBvbmVudHMvV2VhcHBMb2dpbkJ1dHRvbi9pbmRleC5qcw==" title="https://github.com/tuture-dev/ultra-club/blob/29ce05bdb74dd53f6d83b82591186d2d1d10835b/src/components/WeappLoginButton/index.js">æŸ¥çœ‹å®Œæ•´ä»£ç <i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line">[tuture-del]<span class="keyword">import</span> Taro, &#123; useState &#125; <span class="keyword">from</span> <span class="string">'@tarojs/taro'</span></span><br><span class="line">[tuture-add]<span class="keyword">import</span> Taro, &#123; useState, useEffect &#125; <span class="keyword">from</span> <span class="string">'@tarojs/taro'</span></span><br><span class="line"><span class="keyword">import</span> &#123; Button &#125; <span class="keyword">from</span> <span class="string">'@tarojs/components'</span></span><br><span class="line"><span class="keyword">import</span> &#123; useDispatch &#125; <span class="keyword">from</span> <span class="string">'@tarojs/redux'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">'./index.scss'</span></span><br><span class="line">[tuture-del]<span class="keyword">import</span> &#123; LOGIN &#125; <span class="keyword">from</span> <span class="string">'../../constants'</span></span><br><span class="line">[tuture-add]<span class="keyword">import</span> &#123; SET_LOGIN_INFO &#125; <span class="keyword">from</span> <span class="string">'../../constants'</span></span><br><span class="line">[tuture-add]<span class="keyword">import</span> Authing <span class="keyword">from</span> <span class="string">'../../utils/authing/authing'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">WeappLoginButton</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> [isLogin, setIsLogin] = useState(<span class="literal">false</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> dispatch = useDispatch()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">onGetUserInfo</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    setIsLogin(<span class="literal">true</span>)</span><br><span class="line"></span><br><span class="line">[tuture-del]    <span class="keyword">const</span> &#123; avatarUrl, nickName &#125; = e.detail.userInfo</span><br><span class="line">[tuture-del]    <span class="keyword">const</span> userInfo = &#123; <span class="attr">avatar</span>: avatarUrl, nickName &#125;</span><br><span class="line">[tuture-del] </span><br><span class="line">[tuture-del]    dispatch(&#123;</span><br><span class="line">[tuture-del]      type: LOGIN,</span><br><span class="line">[tuture-del]      payload: &#123;</span><br><span class="line">[tuture-del]        userInfo: userInfo,</span><br><span class="line">[tuture-del]      &#125;,</span><br><span class="line">[tuture-add]    <span class="keyword">const</span> userPoolId = <span class="string">'5ea4ffa72b3a80b6eff60b65'</span></span><br><span class="line">[tuture-add]    <span class="keyword">const</span> authing = <span class="keyword">new</span> Authing(&#123;</span><br><span class="line">[tuture-add]      userPoolId,</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">[tuture-add]    <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">loginWithAuthing</span>(<span class="params">code, detail</span>) </span>&#123;</span><br><span class="line">[tuture-add]      <span class="keyword">try</span> &#123;</span><br><span class="line">[tuture-add]        <span class="keyword">const</span> userInfo = <span class="keyword">await</span> authing.loginWithWxapp(&#123;</span><br><span class="line">[tuture-add]          code,</span><br><span class="line">[tuture-add]          detail,</span><br><span class="line">[tuture-add]        &#125;)</span><br><span class="line">[tuture-add] </span><br><span class="line">[tuture-add]        <span class="comment">// æç¤ºç™»å½•æˆåŠŸ</span></span><br><span class="line">[tuture-add]        Taro.atMessage(&#123;</span><br><span class="line">[tuture-add]          type: <span class="string">'success'</span>,</span><br><span class="line">[tuture-add]          message: <span class="string">'æ­å–œæ‚¨ï¼Œç™»å½•æˆåŠŸï¼'</span>,</span><br><span class="line">[tuture-add]        &#125;)</span><br><span class="line">[tuture-add] </span><br><span class="line">[tuture-add]        <span class="keyword">const</span> &#123; nickname, photo, _id &#125; = userInfo</span><br><span class="line">[tuture-add] </span><br><span class="line">[tuture-add]        dispatch(&#123;</span><br><span class="line">[tuture-add]          type: SET_LOGIN_INFO,</span><br><span class="line">[tuture-add]          payload: &#123; <span class="attr">nickName</span>: nickname, <span class="attr">avatar</span>: photo, <span class="attr">userId</span>: _id &#125;,</span><br><span class="line">[tuture-add]        &#125;)</span><br><span class="line">[tuture-add] </span><br><span class="line">[tuture-add]        <span class="comment">// å‘åç«¯å‘èµ·ç™»å½•è¯·æ±‚</span></span><br><span class="line">[tuture-add]        <span class="keyword">await</span> Taro.setStorage(&#123;</span><br><span class="line">[tuture-add]          key: <span class="string">'userInfo'</span>,</span><br><span class="line">[tuture-add]          data: &#123;</span><br><span class="line">[tuture-add]            nickName: nickname,</span><br><span class="line">[tuture-add]            avatar: photo,</span><br><span class="line">[tuture-add]            _id,</span><br><span class="line">[tuture-add]          &#125;,</span><br><span class="line">[tuture-add]        &#125;)</span><br><span class="line">[tuture-add] </span><br><span class="line">[tuture-add]        <span class="keyword">await</span> Taro.setStorage(&#123;</span><br><span class="line">[tuture-add]          key: <span class="string">'token'</span>,</span><br><span class="line">[tuture-add]          data: userInfo.token,</span><br><span class="line">[tuture-add]        &#125;)</span><br><span class="line">[tuture-add] </span><br><span class="line">[tuture-add]        <span class="comment">// å½“ code ç”¨äºç™»å½•ä¹‹åï¼Œä¼šå¤±æ•ˆï¼Œæ‰€ä»¥è¿™é‡Œé‡æ–°è·å– code</span></span><br><span class="line">[tuture-add]        Taro.login(&#123;</span><br><span class="line">[tuture-add]          success(res) &#123;</span><br><span class="line">[tuture-add]            <span class="keyword">const</span> code = res.code</span><br><span class="line">[tuture-add]            Taro.setStorageSync(<span class="string">'code'</span>, code)</span><br><span class="line">[tuture-add]          &#125;,</span><br><span class="line">[tuture-add]        &#125;)</span><br><span class="line">[tuture-add]      &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">[tuture-add]        <span class="built_in">console</span>.log(<span class="string">'err'</span>, err)</span><br><span class="line">[tuture-add]        Taro.atMessage(&#123;</span><br><span class="line">[tuture-add]          type: <span class="string">'success'</span>,</span><br><span class="line">[tuture-add]          message: <span class="string">'æ­å–œæ‚¨ï¼Œç™»å½•æˆåŠŸï¼'</span>,</span><br><span class="line">[tuture-add]        &#125;)</span><br><span class="line">[tuture-add]      &#125;</span><br><span class="line">[tuture-add]    &#125;</span><br><span class="line">[tuture-add] </span><br><span class="line">[tuture-add]    <span class="keyword">try</span> &#123;</span><br><span class="line">[tuture-add]      <span class="keyword">const</span> code = Taro.getStorageSync(<span class="string">'code'</span>)</span><br><span class="line">[tuture-add]      Taro.login(&#123;</span><br><span class="line">[tuture-add]        success(res) &#123;</span><br><span class="line">[tuture-add]          <span class="keyword">const</span> code = res.code</span><br><span class="line">[tuture-add]          loginWithAuthing(code, e.detail)</span><br><span class="line">[tuture-add]        &#125;,</span><br><span class="line">[tuture-add]      &#125;)</span><br><span class="line">[tuture-add]    &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">[tuture-add]      <span class="built_in">console</span>.log(<span class="string">'err'</span>, err)</span><br><span class="line">[tuture-add]    &#125;</span><br><span class="line">[tuture-add] </span><br><span class="line">    setIsLogin(<span class="literal">false</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;Button</span><br><span class="line">      openType=<span class="string">"getUserInfo"</span></span><br><span class="line">      onGetUserInfo=&#123;onGetUserInfo&#125;</span><br><span class="line">      type=<span class="string">"primary"</span></span><br><span class="line">      className=<span class="string">"login-button"</span></span><br><span class="line">      loading=&#123;isLogin&#125;</span><br><span class="line">    &gt;</span><br><span class="line">      å¾®ä¿¡ç™»å½•</span><br><span class="line">    &lt;<span class="regexp">/Button&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°ä¸Šé¢çš„å†…å®¹ä¸»è¦æœ‰å¦‚ä¸‹å‡ å¤„ä¿®æ”¹ï¼š</p>
<ul>
<li>æˆ‘ä»¬åˆ é™¤äº†ä¹‹å‰ç®€å•ç²—æš´è·å–åˆ° <code>userInfo</code> é‡Œé¢çš„ <code>nickName</code> å’Œ <code>avatarUrl</code> å°±å‘èµ·ç™»å½•çš„ä»£ç é€»è¾‘ã€‚</li>
<li>æˆ‘ä»¬åœ¨ <code>onGetUserInfo</code> é‡Œé¢åˆå§‹åŒ–äº†ä¸€ä¸ª <code>authing</code> å®ä¾‹ï¼Œç„¶åå®šä¹‰äº†ä¸€ä¸ª <code>loginWithAuthing</code> æ–¹æ³•ï¼Œå…·ä½“ç»†èŠ‚æˆ‘ä»¬é©¬ä¸Šè®²è§£ï¼Œç„¶åæˆ‘ä»¬ä½¿ç”¨ <code>Taro.login</code> è°ƒç”¨å¾®ä¿¡æˆæƒç™»å½• APIï¼Œè·å–å¯¹åº”çš„ <code>code</code> ï¼Œå¹¶è¿åŒæŠŠ <code>onGetUserInfo</code> ä¼ è¿›æ¥çš„ <code>e.detail</code> ä¸€èµ·ä¼ ç»™ <code>loginWithAuthing</code> ã€‚</li>
<li>åœ¨ <code>loginWithAuthing</code> å‡½æ•°é‡Œé¢ï¼Œå“¦ä»¬é¦–å…ˆè°ƒç”¨ <code>authing.loginWithWxapp</code> ï¼Œå¹¶ä¼ å…¥å¯¹åº”çš„ <code>code</code> å’Œ <code>detail</code> ï¼Œè¿›è¡Œç™»å½•ï¼Œç„¶åå°†ç™»å½•è·å–çš„ä¿¡æ¯å­˜åœ¨ <code>storage</code> é‡Œé¢ä»¥åŠä¿å­˜åœ¨ Redux Store ä¸­ï¼Œå¹¶æç¤ºç”¨æˆ·ç™»å½•æˆåŠŸã€‚</li>
</ul>
<p>ä¿å­˜ä¸Šé¢çš„ä»£ç ï¼Œå¹¶è¿è¡Œæˆ‘ä»¬çš„åº”ç”¨ï¼Œä½ åº”è¯¥å¯ä»¥è‡ªç”±çš„æ“ä½œå¾®ä¿¡ç™»å½•äº†ï¼š</p>
<p><img alt data-src="https://static.powerformer.com/c/34a473b/172281abd1c93268.gif"></p>
<p>å°±è¿™æ ·ï¼Œæˆ‘ä»¬å°±æˆåŠŸå°†å¾®ä¿¡æˆæƒç™»å½•ä½¿ç”¨ Authing é›†æˆå¥½äº†ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬åªéœ€è¦ä¸€ä¸ª <code>loginWithWxapp</code> å°±æŠŠé€»è¾‘é›†æˆå¥½äº†ï¼Œå®Œå…¨ä¸éœ€è¦ä¹‹å‰ <code>dispatch</code> ä¸€ä¸ª <code>LOGIN</code> è¯·æ±‚ï¼Œè¿˜è¦å»å¤„ç†ä¸€å † <code>sagas</code> é€»è¾‘ï¼Œå¹¶ä¸”è¿˜è¦ç¼–å†™å°ç¨‹åºäº‘å‡½æ•°é€»è¾‘ï¼Œæ‰‹åŠ¨å¤„ç†è¿™äº›é€»è¾‘ä¸ä»…ç¹çï¼Œè¿˜å®¹æ˜“å‡ºé”™ï¼Œå¹¶ä¸”ä¹Ÿä¸å¤Ÿçµæ´»ï¼Œè€Œ Authing æä¾›çš„ SDK å¯ä»¥å¾ˆå¥½çš„è§£å†³è¿™ä¸€ç‚¹ï¼Œèµ‹èƒ½ä¸šåŠ¡æˆåŠŸã€‚</p>
<h2 id="æ–°ç‰ˆç”¨æˆ·ç³»ç»Ÿæ•´åˆè¿›ç°æœ‰åç«¯"><a href="#æ–°ç‰ˆç”¨æˆ·ç³»ç»Ÿæ•´åˆè¿›ç°æœ‰åç«¯" class="headerlink" title="æ–°ç‰ˆç”¨æˆ·ç³»ç»Ÿæ•´åˆè¿›ç°æœ‰åç«¯"></a>æ–°ç‰ˆç”¨æˆ·ç³»ç»Ÿæ•´åˆè¿›ç°æœ‰åç«¯</h2><p>åœ¨ä¹‹å‰å››ä¸ªå°èŠ‚ï¼Œæˆ‘ä»¬éƒ½åœ¨å°†ç°æœ‰å°ç¨‹åºåšå®¢çš„ç”¨æˆ·é€»è¾‘ä½¿ç”¨ Authing æ¥æ›¿ä»£ï¼Œè€Œå°†ç”¨æˆ·é€»è¾‘ç”¨ Authing æ¥æ›¿ä»£ä¹‹åï¼Œæˆ‘ä»¬ä¼šé‡åˆ°ä¸€ä¸ªå°é—®é¢˜ï¼Œå°±æ˜¯ä¹‹å‰çš„ç”¨æˆ·ç³»ç»Ÿä¸å…¶ä»–æ¨¡å—å¦‚æˆ‘ä»¬çš„å‘å¸–æ¨¡å—æ˜¯å­˜åœ¨è€¦åˆçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦å°†è¿™ä¸ªè€¦åˆçš„éƒ¨åˆ†æ›¿æ¢æˆ Authing çš„ç›¸å…³é€»è¾‘ï¼Œè¿™å°±æ¶‰åŠåˆ°å¦‚ä½•å°†æ–°ç‰ˆçš„ç”¨æˆ·ç³»ç»Ÿæ•´åˆè¿›ç°æœ‰çš„åç«¯ã€‚</p>
<p>æˆ‘ä»¬ç›®å‰çš„åšå®¢å°ç¨‹åºæ¶‰åŠåˆ°å’Œç”¨æˆ·ç³»ç»Ÿè€¦åˆçš„éƒ¨åˆ†å°±æ˜¯æˆ‘ä»¬äº‘å‡½æ•° <code>createPost</code> åœ¨å‘å¸–çš„æ—¶å€™è¦å¸¦ä¸Šç”¨æˆ·ä¿¡æ¯ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨è¿™ä¸ªäº‘å‡½æ•°ä¸‹ä½¿ç”¨ Authing æ¥æ›¿æ¢ç›¸åº”çš„ç”¨æˆ·é€»è¾‘ã€‚</p>
<h3 id="å®‰è£…-SDK"><a href="#å®‰è£…-SDK" class="headerlink" title="å®‰è£… SDK"></a>å®‰è£… SDK</h3><p>æˆ‘ä»¬çš„å¾®ä¿¡å°ç¨‹åºåå°ä½¿ç”¨äº†äº‘å‡½æ•°ï¼Œè€Œäº‘å‡½æ•°æ˜¯ä¸€ä¸ªä¸ªçš„ Node.js å‡½æ•°ï¼Œè€Œ Authing ä¸ºæˆ‘ä»¬æä¾›äº† Node.js çš„ SDK npm åŒ…ï¼Œæˆ‘ä»¬é©¬ä¸Šæ¥å®‰è£…å®ƒï¼Œåœ¨ <code>functions/createPost</code> ä¸‹æ‰§è¡Œå¦‚ä¸‹çš„ä»£ç ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ npm install authing-js-sdk</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œä¹‹åï¼Œæˆ‘ä»¬çš„ <code>package.json</code> ä¼šæ˜¯å¦‚ä¸‹çš„æ ·å­ï¼š</p>
<figure class="highlight"><figcaption><span>functions/createPost/package.json</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvdWx0cmEtY2x1Yi9ibG9iLzMzNmE2MGJiYWQzNTQ1MzFiNmM4NzVmNWYxMDMxOWFkNjRhNzI2N2QvZnVuY3Rpb25zL2NyZWF0ZVBvc3QvcGFja2FnZS5qc29u" title="https://github.com/tuture-dev/ultra-club/blob/336a60bbad354531b6c875f5f10319ad64a7267d/functions/createPost/package.json">æŸ¥çœ‹å®Œæ•´ä»£ç <i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"name"</span>: <span class="string">"createPost"</span>,</span><br><span class="line">  <span class="attr">"version"</span>: <span class="string">"1.0.0"</span>,</span><br><span class="line">  <span class="attr">"description"</span>: <span class="string">""</span>,</span><br><span class="line">  <span class="attr">"main"</span>: <span class="string">"index.js"</span>,</span><br><span class="line">  <span class="attr">"scripts"</span>: &#123;</span><br><span class="line">    <span class="attr">"test"</span>: <span class="string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"author"</span>: <span class="string">""</span>,</span><br><span class="line">  <span class="attr">"license"</span>: <span class="string">"ISC"</span>,</span><br><span class="line">  <span class="attr">"dependencies"</span>: &#123;</span><br><span class="line">[tuture-add]    "authing-js-sdk": "^3.18.7",</span><br><span class="line">    "wx-server-sdk": "latest"</span><br><span class="line">  &#125;</span><br><span class="line">[tuture-del]&#125;</span><br><span class="line">[tuture-add]&#125;</span><br></pre></td></tr></table></figure>

<p>æ¥ç€ï¼Œæˆ‘ä»¬åœ¨äº‘å‡½æ•°é‡Œé¢æ›¿æ¢å¯¹åº”çš„é€»è¾‘ï¼Œæ‰“å¼€ <code>functions/createPost/index.js</code> æ–‡ä»¶ï¼Œå¯¹å…¶ä¸­çš„å†…å®¹åšå‡ºå¯¹åº”çš„ä¿®æ”¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><figcaption><span>functions/createPost/index.js</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvdWx0cmEtY2x1Yi9ibG9iLzMzNmE2MGJiYWQzNTQ1MzFiNmM4NzVmNWYxMDMxOWFkNjRhNzI2N2QvZnVuY3Rpb25zL2NyZWF0ZVBvc3QvaW5kZXguanM=" title="https://github.com/tuture-dev/ultra-club/blob/336a60bbad354531b6c875f5f10319ad64a7267d/functions/createPost/index.js">æŸ¥çœ‹å®Œæ•´ä»£ç <i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="comment">// äº‘å‡½æ•°å…¥å£æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">const</span> cloud = <span class="built_in">require</span>(<span class="string">'wx-server-sdk'</span>)</span><br><span class="line">[tuture-add]<span class="keyword">const</span> Authing = <span class="built_in">require</span>(<span class="string">'authing-js-sdk'</span>)</span><br><span class="line"></span><br><span class="line">cloud.init(&#123;</span><br><span class="line">  env: cloud.DYNAMIC_CURRENT_ENV,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> db = cloud.database()</span><br><span class="line"></span><br><span class="line"><span class="comment">// äº‘å‡½æ•°å…¥å£å‡½æ•°</span></span><br><span class="line">exports.main = <span class="keyword">async</span> (event, context) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; postData, userId &#125; = event</span><br><span class="line"></span><br><span class="line">[tuture-del]  <span class="built_in">console</span>.log(<span class="string">'event'</span>, event)</span><br><span class="line">[tuture-add]  <span class="keyword">const</span> userPoolId = <span class="string">''</span></span><br><span class="line">[tuture-add]  <span class="keyword">const</span> secret = <span class="string">''</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">[tuture-del]    <span class="keyword">const</span> user = <span class="keyword">await</span> db</span><br><span class="line">[tuture-del]      .collection(<span class="string">'user'</span>)</span><br><span class="line">[tuture-del]      .doc(userId)</span><br><span class="line">[tuture-del]      .get()</span><br><span class="line">[tuture-add]    <span class="keyword">const</span> authing = <span class="keyword">new</span> Authing(&#123;</span><br><span class="line">[tuture-add]      userPoolId,</span><br><span class="line">[tuture-add]      secret,</span><br><span class="line">[tuture-add]    &#125;)</span><br><span class="line">[tuture-add]    <span class="keyword">const</span> userInfo = <span class="keyword">await</span> authing.user(&#123; <span class="attr">id</span>: userId &#125;)</span><br><span class="line">[tuture-add]    <span class="keyword">const</span> &#123; nickname, photo &#125; = userInfo</span><br><span class="line">[tuture-add] </span><br><span class="line">    <span class="keyword">const</span> &#123; _id &#125; = <span class="keyword">await</span> db.collection(<span class="string">'post'</span>).add(&#123;</span><br><span class="line">      data: &#123;</span><br><span class="line">        ...postData,</span><br><span class="line">[tuture-del]        user: user.data,</span><br><span class="line">[tuture-add]        user: &#123; <span class="attr">nickName</span>: nickname, <span class="attr">avatar</span>: photo, <span class="attr">_id</span>: userInfo._id &#125;,</span><br><span class="line">        createdAt: db.serverDate(),</span><br><span class="line">        updatedAt: db.serverDate(),</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> newPost = <span class="keyword">await</span> db</span><br><span class="line">      .collection(<span class="string">'post'</span>)</span><br><span class="line">      .doc(_id)</span><br><span class="line">      .get()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      post: &#123; ...newPost.data &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">    <span class="built_in">console</span>.error(<span class="string">`createUser ERR: <span class="subst">$&#123;err&#125;</span>`</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬ä¸»è¦åšäº†å¦‚ä¸‹å‡ å¤„ä¿®æ”¹ï¼š</p>
<ul>
<li>æˆ‘ä»¬å¯¼å…¥äº† Authing SDK</li>
<li>ç„¶åå‡½æ•°å†…éƒ¨æˆ‘ä»¬å®šä¹‰äº† <code>userPoolId</code> å’Œ <code>secret</code> æ¥åˆå§‹åŒ– <code>authing</code> å®ä¾‹ï¼Œè¿™ä¸¤ä¸ªå‚æ•°æˆ‘ä»¬å¯ä»¥åœ¨ç”¨æˆ·æ± æ§åˆ¶å°æ‰¾åˆ°ï¼š</li>
</ul>
<p><img alt data-src="https://static.powerformer.com/c/34a473b/172281abd4f70166.png"></p>
<ul>
<li>æ¥ç€æˆ‘ä»¬ä½¿ç”¨åˆå§‹åŒ–å¥½çš„ <code>authing</code> æ¥è°ƒç”¨ <code>authing.user</code> æ–¹æ³•ä¼ å…¥æˆ‘ä»¬æ¥æ”¶åˆ°çš„ <code>userId</code> æŸ¥è¯¢åœ¨ Authing ä¸­ä¿å­˜çš„æ­¤ç”¨æˆ·èµ„æ–™ï¼Œå¹¶ç”¨è¿™ä¸ªç”¨æˆ·èµ„æ–™æ›¿æ¢æˆ‘ä»¬éœ€è¦åœ¨å°ç¨‹åºäº‘æ•°æ®åº“é‡Œé¢æŸ¥åˆ°çš„ç”¨æˆ·æ•°æ®</li>
</ul>
<p>è‡ªæ­¤ï¼Œæˆ‘ä»¬å°±åœ¨å‰åç«¯æ·±åº¦æ•´åˆäº† Authing ç”¨æˆ·ç³»ç»Ÿï¼Œåœ¨ä¹‹åæˆ‘ä»¬çš„åº”ç”¨æ‰©å±•è¿‡ç¨‹ä¸­ï¼Œæ‰€æœ‰å’Œç”¨æˆ·æœ‰å…³çš„é€»è¾‘éƒ½ä¸éœ€è¦è‡ªå·±åœ¨åå°å•ç‹¬ç¼–å†™ï¼Œå‰ç«¯ä¹Ÿå¤§å¤§ç®€åŒ–äº†å·¥ä½œé‡ï¼Œå¹¶ä¸”æˆ‘ä»¬è¿˜èƒ½åœ¨ Authing çš„æ§åˆ¶å°å¯è§†åŒ–ç”¨æˆ·çš„æ•°æ®ï¼šç™»å½•æƒ…å†µã€ç™»å½•åŒºåŸŸã€ç™»å½•æœºå™¨ï¼Œè¿˜å¯ä»¥ç»™ç”¨æˆ·è¿›è¡Œæƒé™åˆ†é…ï¼Œç”šè‡³ç›´æ¥ä¿®æ”¹ç”¨æˆ·èµ„æ–™ç­‰ã€‚</p>
<p><img alt data-src="https://static.powerformer.com/c/34a473b/172281abd746fd45.png"></p>
<h2 id="é€šè¿‡é‰´æƒä¿æœ‰ç”¨æˆ·ç™»å½•çŠ¶æ€"><a href="#é€šè¿‡é‰´æƒä¿æœ‰ç”¨æˆ·ç™»å½•çŠ¶æ€" class="headerlink" title="é€šè¿‡é‰´æƒä¿æœ‰ç”¨æˆ·ç™»å½•çŠ¶æ€"></a>é€šè¿‡é‰´æƒä¿æœ‰ç”¨æˆ·ç™»å½•çŠ¶æ€</h2><p>æœ€åï¼Œæˆ‘ä»¬æ¥æ”¶å°¾ä¸€ä¸‹ï¼Œåšä¸€ä¸‹ç”¨æˆ·ç™»å½•çŠ¶æ€çš„æŸ¥è¯¢ï¼Œå› ä¸ºåº”ç”¨çš„ç™»å½•å‡­è¯å®ƒå­˜åœ¨ä¸€ä¸ªå¤±æ•ˆæ—¶é—´ï¼Œå½“æ—¶é—´ä¸€åˆ°ï¼Œæˆ‘ä»¬å†å»æ“ä½œç”¨æˆ·ä¿¡æ¯å°±ä¼šæ˜¾ç¤ºæ²¡æœ‰æƒé™ï¼Œå› ä¸ºå‡­è¯å¤±æ•ˆäº†ï¼Œæ‰€ä»¥è¯´æˆ‘ä»¬è¦åŠæ—¶æ£€æŸ¥ç”¨æˆ·çš„ç™»å½•å‡­è¯æ˜¯å¦å¤±æ•ˆï¼Œå¦‚æœå¤±æ•ˆåˆ™è¦æ±‚ç”¨æˆ·é‡æ–°ç™»å½•ï¼Œè¿™ä¹Ÿæ˜¯è¯»è€…ç»å¸¸ä¼šåœ¨è®¿é—®æŸäº›ç½‘ç«™çš„æ—¶å€™é‡åˆ°ï¼Œè€Œç°åœ¨æˆ‘ä»¬å°†å®æ“ä¸€ä¸‹è¿™ä¸ªè¿‡ç¨‹ã€‚</p>
<p>ä¸€èˆ¬å¤„ç†ç”¨æˆ·ç™»å½•æ€çš„éªŒè¯ä¸»è¦æ˜¯åœ¨åº”ç”¨åˆšåˆšå¯åŠ¨æ—¶ï¼Œå»è¿›è¡Œä¸€ä¸ªé‰´æƒå¤„ç†ï¼Œå¦‚æœç”¨æˆ·æ€æœ‰æ•ˆï¼Œåˆ™é¡ºåˆ©ä»åº”ç”¨çš„ <code>storage</code>  é‡Œé¢å–å‡ºæ•°æ®ï¼Œç„¶åè®¾ç½®è¿›å‰ç«¯çŠ¶æ€ç®¡ç†ï¼Œè¿›è€Œå±•ç¤ºç”¨æˆ·æ•°æ®ï¼Œè€Œå¦‚æœæ²¡æœ‰åˆ™åˆ é™¤ <code>storage</code> é‡Œé¢çš„æ•°æ®ï¼Œæç¤ºç”¨æˆ·è¿›è¡Œç™»å½•ã€‚</p>
<p>æˆ‘ä»¬æ‰“å¼€ <code>src/pages/index/index.jsx</code> æ¥å®æ“ï¼Œå¯¹å…¶ä¸­çš„å†…å®¹ä½œå‡ºå¯¹åº”çš„ä¿®æ”¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight jsx"><figcaption><span>src/pages/index/index.jsx</span><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXYvdWx0cmEtY2x1Yi9ibG9iL2MxNjk4NGQyNTk1M2NjZWUzYTM0NTgxNTcxM2NiNTRjOWY5YmMzZmEvc3JjL3BhZ2VzL2luZGV4L2luZGV4LmpzeA==" title="https://github.com/tuture-dev/ultra-club/blob/c16984d25953ccee3a345815713cb54c9f9bc3fa/src/pages/index/index.jsx">æŸ¥çœ‹å®Œæ•´ä»£ç <i class="fa fa-external-link"></i></span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Taro, &#123; useEffect &#125; <span class="keyword">from</span> <span class="string">'@tarojs/taro'</span></span><br><span class="line"><span class="keyword">import</span> &#123; View, Text &#125; <span class="keyword">from</span> <span class="string">'@tarojs/components'</span></span><br><span class="line"><span class="keyword">import</span> &#123; AtFab, AtFloatLayout, AtMessage &#125; <span class="keyword">from</span> <span class="string">'taro-ui'</span></span><br><span class="line"><span class="keyword">import</span> &#123; useSelector, useDispatch &#125; <span class="keyword">from</span> <span class="string">'@tarojs/redux'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; PostCard, PostForm &#125; <span class="keyword">from</span> <span class="string">'../../components'</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'./index.scss'</span></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  SET_POST_FORM_IS_OPENED,</span><br><span class="line">  SET_LOGIN_INFO,</span><br><span class="line">  GET_POSTS,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">'../../constants'</span></span><br><span class="line">[tuture-add]<span class="keyword">import</span> Authing <span class="keyword">from</span> <span class="string">'../../utils/authing/authing'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">Index</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> posts = useSelector(<span class="function"><span class="params">state</span> =&gt;</span> state.post.posts) || []</span><br><span class="line">  <span class="keyword">const</span> isOpened = useSelector(<span class="function"><span class="params">state</span> =&gt;</span> state.post.isOpened)</span><br><span class="line">  <span class="keyword">const</span> userId = useSelector(<span class="function"><span class="params">state</span> =&gt;</span> state.user.userId)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> isLogged = !!userId</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> dispatch = useDispatch()</span><br><span class="line"></span><br><span class="line">  useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> WeappEnv = Taro.getEnv() === Taro.ENV_TYPE.WEAPP</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (WeappEnv) &#123;</span><br><span class="line">      Taro.cloud.init()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">getStorage</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">[tuture-add]      <span class="comment">// åœ¨åº”ç”¨åˆå§‹åŒ–çš„æ—¶å€™ï¼Œå¯¹åº”ç”¨è¿›è¡Œé‰´æƒï¼Œæ£€æŸ¥ç™»å½•çŠ¶æ€ï¼Œå¦‚æœç™»å½•å¤±æ•ˆï¼Œåˆ™æƒ…å†µç¼“å­˜ä¿¡æ¯</span></span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">[tuture-del]        <span class="keyword">const</span> &#123; data &#125; = <span class="keyword">await</span> Taro.getStorage(&#123; <span class="attr">key</span>: <span class="string">'userInfo'</span> &#125;)</span><br><span class="line">[tuture-add]        <span class="keyword">const</span> userPoolId = <span class="string">''</span></span><br><span class="line">[tuture-add]        <span class="keyword">const</span> &#123; <span class="attr">data</span>: token &#125; = <span class="keyword">await</span> Taro.getStorage(&#123; <span class="attr">key</span>: <span class="string">'token'</span> &#125;)</span><br><span class="line">[tuture-add]        <span class="keyword">const</span> authing = <span class="keyword">new</span> Authing(&#123;</span><br><span class="line">[tuture-add]          userPoolId,</span><br><span class="line">[tuture-add]        &#125;)</span><br><span class="line">[tuture-add]        <span class="keyword">const</span> result = <span class="keyword">await</span> Taro.request(&#123;</span><br><span class="line">[tuture-add]          url: <span class="string">`https://users.authing.cn/authing/token?access_token=<span class="subst">$&#123;userInfo.token&#125;</span>`</span>,</span><br><span class="line">[tuture-add]        &#125;)</span><br><span class="line"></span><br><span class="line">[tuture-del]        <span class="keyword">const</span> &#123; nickName, avatar, _id &#125; = data</span><br><span class="line">[tuture-add]        <span class="keyword">if</span> (result.data.status) &#123;</span><br><span class="line">[tuture-add]          <span class="keyword">const</span> &#123; data &#125; = <span class="keyword">await</span> Taro.getStorage(&#123; <span class="attr">key</span>: <span class="string">'userInfo'</span> &#125;)</span><br><span class="line"></span><br><span class="line">[tuture-del]        <span class="comment">// æ›´æ–° Redux Store æ•°æ®</span></span><br><span class="line">[tuture-del]        dispatch(&#123;</span><br><span class="line">[tuture-del]          type: SET_LOGIN_INFO,</span><br><span class="line">[tuture-del]          payload: &#123; nickName, avatar, <span class="attr">userId</span>: _id &#125;,</span><br><span class="line">[tuture-del]        &#125;)</span><br><span class="line">[tuture-add]          <span class="keyword">const</span> &#123; nickName, avatar, _id &#125; = data</span><br><span class="line">[tuture-add] </span><br><span class="line">[tuture-add]          <span class="comment">// æ›´æ–° Redux Store æ•°æ®</span></span><br><span class="line">[tuture-add]          dispatch(&#123;</span><br><span class="line">[tuture-add]            type: SET_LOGIN_INFO,</span><br><span class="line">[tuture-add]            payload: &#123; nickName, avatar, <span class="attr">userId</span>: _id &#125;,</span><br><span class="line">[tuture-add]          &#125;)</span><br><span class="line">[tuture-add]        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">[tuture-add]          <span class="keyword">await</span> Taro.removeStorage(&#123; <span class="attr">key</span>: <span class="string">'userInfo'</span> &#125;)</span><br><span class="line">[tuture-add]          <span class="keyword">await</span> Taro.removeStorage(&#123; <span class="attr">key</span>: <span class="string">'token'</span> &#125;)</span><br><span class="line">[tuture-add]        &#125;</span><br><span class="line">      &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'getStorage ERR: '</span>, err)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!isLogged) &#123;</span><br><span class="line">      getStorage()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">getPosts</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// æ›´æ–° Redux Store æ•°æ®</span></span><br><span class="line">        dispatch(&#123;</span><br><span class="line">          type: GET_POSTS,</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'getPosts ERR: '</span>, err)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!posts.length) &#123;</span><br><span class="line">      getPosts()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">setIsOpened</span>(<span class="params">isOpened</span>) </span>&#123;</span><br><span class="line">    dispatch(&#123; <span class="attr">type</span>: SET_POST_FORM_IS_OPENED, <span class="attr">payload</span>: &#123; isOpened &#125; &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">handleClickEdit</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!isLogged) &#123;</span><br><span class="line">      Taro.atMessage(&#123;</span><br><span class="line">        type: <span class="string">'warning'</span>,</span><br><span class="line">        message: <span class="string">'æ‚¨è¿˜æœªç™»å½•å“¦ï¼'</span>,</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      setIsOpened(<span class="literal">true</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'posts'</span>, posts)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;View className=<span class="string">"index"</span>&gt;</span><br><span class="line">      &lt;AtMessage /&gt;</span><br><span class="line">      &#123;posts.map(<span class="function"><span class="params">post</span> =&gt;</span> (</span><br><span class="line">        &lt;PostCard key=&#123;post._id&#125; postId=&#123;post._id&#125; post=&#123;post&#125; isList /&gt;</span><br><span class="line">      ))&#125;</span><br><span class="line">      &lt;AtFloatLayout</span><br><span class="line">        isOpened=&#123;isOpened&#125;</span><br><span class="line">        title=<span class="string">"å‘è¡¨æ–°æ–‡ç« "</span></span><br><span class="line">        onClose=&#123;() =&gt; setIsOpened(<span class="literal">false</span>)&#125;</span><br><span class="line">      &gt;</span><br><span class="line">        &lt;PostForm /&gt;</span><br><span class="line">      &lt;<span class="regexp">/AtFloatLayout&gt;</span></span><br><span class="line"><span class="regexp">      &lt;View className="post-button"&gt;</span></span><br><span class="line"><span class="regexp">        &lt;AtFab onClick=&#123;handleClickEdit&#125;&gt;</span></span><br><span class="line"><span class="regexp">          &lt;Text className="at-fab__icon at-icon at-icon-edit"&gt;&lt;/</span>Text&gt;</span><br><span class="line">        &lt;<span class="regexp">/AtFab&gt;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>View&gt;</span><br><span class="line">    &lt;<span class="regexp">/View&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">Index.config = &#123;</span></span><br><span class="line"><span class="regexp">  navigationBarTitleText: 'é¦–é¡µ',</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°ï¼Œä¸Šé¢çš„å†…å®¹ä¸»è¦åšå‡ºäº†å¦‚ä¸‹å‡ å¤„ä¿®æ”¹ï¼š</p>
<ul>
<li>æˆ‘ä»¬åœ¨ <code>getStorage</code> å‡½æ•°é‡Œé¢ï¼Œé¦–å…ˆè·å–äº†ä¹‹å‰ç™»å½•æ—¶ä¿å­˜çš„ç”¨æˆ·å‡­è¯ <code>token</code> ï¼Œç„¶ååˆå§‹åŒ–äº†ä¸€ä¸ª <code>authing</code> å®ä¾‹ï¼Œå¹¶é€šè¿‡ <code>Taro.request</code> çš„æ–¹å¼ï¼Œå»è¯·æ±‚ Authing ä¸ºæˆ‘ä»¬æä¾›çš„é‰´æƒåœ°å€ï¼š<code>https://users.authing.cn/authing/token?access_token=YOUR_TOKEN</code> ï¼Œæˆ‘ä»¬å°†è¿™ä¸ªé“¾æ¥ä¸­çš„ <code>YOUR_TOKEN</code> æ›¿æ¢æˆæˆ‘ä»¬ä¿å­˜åœ¨ <code>storage</code> é‡Œé¢çš„ <code>token</code> ï¼Œè®¿é—®è¿™ä¸ªåœ°å€å¦‚æœæˆåŠŸåˆ™ä¼šå¾—åˆ°å¦‚ä¸‹çš„ç»“æœï¼š</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"status"</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="string">"message"</span>: <span class="string">"å·²ç™»å½•"</span>,</span><br><span class="line">  <span class="string">"code"</span>: <span class="number">200</span>,</span><br><span class="line">  <span class="string">"token"</span>: &#123;</span><br><span class="line">    <span class="string">"data"</span>: &#123;</span><br><span class="line">	<span class="string">"email"</span>: <span class="string">"YOUR_EMAIL@domain.com"</span>,</span><br><span class="line">	<span class="string">"id"</span>: <span class="string">"YOUR_USER_ID"</span>,</span><br><span class="line">	<span class="string">"clientId"</span>: <span class="string">"YOUR_UESR_POOL_ID"</span></span><br><span class="line">    &#125;,</span><br><span class="line">        <span class="string">"iat"</span>: <span class="string">"Token ç­¾å‘æ—¶é—´"</span></span><br><span class="line">	<span class="string">"exp"</span>: <span class="string">"Token è¿‡æœŸæ—¶é—´"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœå¤±è´¥å…¶ä¸­çš„ <code>status</code> ä¼šä¸º <code>false</code> ï¼Œå…¶å®ƒå†…å®¹ä¹Ÿä¼šç›¸åº”çš„å˜åŒ–ã€‚</p>
<ul>
<li>æ¥ç€æˆ‘ä»¬åˆ¤æ–­ <code>status</code> ï¼Œå¦‚æœä¸º <code>true</code> åˆ™ä» <code>storage</code> é‡Œé¢å–å‡ºæ•°æ®ï¼Œè®¾ç½®è¿› Redux Storeï¼Œå¦‚æœä¸º <code>false</code> ï¼Œæˆ‘ä»¬æ¸…ç©º <code>storage</code> æ•°æ®ï¼Œè¿™æ ·åœ¨ç”¨æˆ·å‘å¸–æ—¶ä¼šæç¤ºç”¨æˆ·éœ€è¦ç™»å½•ã€‚</li>
</ul>
<h2 id="å°ç»“-1"><a href="#å°ç»“-1" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>é€šè¿‡è¿™ç¯‡æ•™ç¨‹ï¼Œæˆ‘ä»¬å°†ä¹‹å‰ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„ç”¨æˆ·ç³»ç»Ÿæ›¿æ¢æˆäº†ä¸“ä¸šçš„é€šç”¨äº‘èº«ä»½æä¾›å•† Authing æä¾›çš„ä¸“ä¸šçš„ç”¨æˆ·ç³»ç»Ÿï¼Œå¹¶ä¸”ä½“éªŒåˆ°äº†é€šè¿‡çŸ­çŸ­å‡ è¡Œä»£ç å°±å¯ä»¥å®ç°ä¸“ä¸šçš„æ‰‹æœºå·+éªŒè¯ç ç™»å½•ã€ç”¨æˆ·ç™»å‡ºã€å¾®ä¿¡æˆæƒç™»å½•ã€å¹¶ä¸”è¿˜å¯ä»¥åšç”¨æˆ·ç™»å½•çŠ¶æ€çš„æ£€æµ‹ç­‰ã€‚</p>
<p>æœ‰äº†è¿™æ ·ä¸€ä¸ªç®€å•ã€æ–¹ä¾¿ä¸”å¼ºå¤§çš„ç”¨æˆ·ç³»ç»Ÿåšä¿éšœä¹‹åï¼Œæˆ‘ä»¬çš„åšå®¢åº”ç”¨å°ç¨‹åºå°†å¯ä»¥æ— é¡¾è™‘çš„æ‰©å±•å…¶å®ƒæ¨¡å—ï¼Œè€Œæ¶‰åŠåˆ°èº«ä»½ç›¸å…³çš„å†…å®¹éƒ½å¯ä»¥äº¤ç»™ Authing æ¥åšã€‚å½“ç„¶æˆ‘ä»¬è¿™ç‰‡æ–‡ç« è¿˜åªç”¨äº† Authing å¾ˆå°çš„ä¸€éƒ¨åˆ†åŠŸèƒ½ï¼Œè¿˜æœ‰è¯¸å¦‚ä¼ä¸šç»„ç»‡ç®¡ç†ã€å•ç‚¹ç™»å½•ç­‰é«˜çº§åŠŸèƒ½ï¼Œæœ‰å…´è¶£çš„ç”¨æˆ·å¯ä»¥è‡ªè¡Œå‘æ˜ğŸ’ªï¼</p>

    </div>

    
    
    
      

        <div id="qrcode_subscriber-container">
  <div></div>

  <div id="qrocde-qr">
        
      
      <div style="display: inline-block">
        <img src="/uploads/wechat-qcode.png" alt="å›¾é›€ç¤¾åŒº å¾®ä¿¡å…¬ä¼—å·">
        <p>æ‰«ä¸€æ‰«å…³æ³¨ä¸Šæ–¹å…¬ä¼—å·ï¼Œæ‹‰å­¦ä¹ ç¾¤å’Œç­”ç–‘è§£æƒ‘</p>
      </div>

  </div>
</div>

      
        
      
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>æœ¬æ–‡ä½œè€…ï¼š </strong>å›¾é›€ç¤¾åŒº</li>
  <li class="post-copyright-link">
    <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong>
    <a href="https://tuture.co/2020/05/17/2b5a9f1/" title="Taro å°ç¨‹åºå¼€å‘å¤§å‹å®æˆ˜ï¼ˆä¸ƒï¼‰ï¼šä½¿ç”¨ Authing æ‰“é€ å®Œæ•´ä¸”å¼ºå¤§çš„ç”¨æˆ·ç³»ç»Ÿ">https://tuture.co/2020/05/17/2b5a9f1/</a>
  </li>
  <li class="post-copyright-license">
    <strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC8="><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</span> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</li>
</ul>
</div>

      

      <footer class="post-footer">
          
            
          
          <div class="post-tags">
            
              <a href="/tags/Taro/" rel="tag"><i class="fa fa-tag"></i> Taro</a>
            
              <a href="/tags/%E7%94%A8%E6%88%B7%E7%B3%BB%E7%BB%9F/" rel="tag"><i class="fa fa-tag"></i> ç”¨æˆ·ç³»ç»Ÿ</a>
            
              <a href="/tags/%E9%89%B4%E6%9D%83/" rel="tag"><i class="fa fa-tag"></i> é‰´æƒ</a>
            
              <a href="/tags/%E8%AE%A4%E8%AF%81/" rel="tag"><i class="fa fa-tag"></i> è®¤è¯</a>
            
              <a href="/tags/OAuth/" rel="tag"><i class="fa fa-tag"></i> OAuth</a>
            
              <a href="/tags/%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95/" rel="tag"><i class="fa fa-tag"></i> å¾®ä¿¡ç™»å½•</a>
            
              <a href="/tags/QQ%E7%99%BB%E5%BD%95/" rel="tag"><i class="fa fa-tag"></i> QQç™»å½•</a>
            
              <a href="/tags/Github%E7%99%BB%E5%BD%95/" rel="tag"><i class="fa fa-tag"></i> Githubç™»å½•</a>
            
          </div>
        

        

          <div class="post-nav">
            <div class="post-nav-next post-nav-item">
              
                <a href="/2020/05/12/@4675l54tY/" rel="next" title="Nest.js ä»é›¶åˆ°å£¹ç³»åˆ—ï¼ˆä¸ƒï¼‰ï¼šè®¨åŒå†™æ–‡æ¡£ï¼ŒSwagger UI äº†è§£ä¸€ä¸‹ï¼Ÿ">
                  <i class="fa fa-chevron-left"></i> Nest.js ä»é›¶åˆ°å£¹ç³»åˆ—ï¼ˆä¸ƒï¼‰ï¼šè®¨åŒå†™æ–‡æ¡£ï¼ŒSwagger UI äº†è§£ä¸€ä¸‹ï¼Ÿ
                </a>
              
            </div>

            <span class="post-nav-divider"></span>

            <div class="post-nav-prev post-nav-item">
              
                <a href="/2020/05/17/nO-RmUb/" rel="prev" title="ä»é›¶åˆ°éƒ¨ç½²ï¼šç”¨ Vue å’Œ Express å®ç°è¿·ä½ å…¨æ ˆç”µå•†åº”ç”¨ï¼ˆä¹ï¼‰ï¼šä½¿ç”¨ Authing é›†æˆå®Œæ•´çš„ç”¨æˆ·ç³»ç»Ÿ">
                  ä»é›¶åˆ°éƒ¨ç½²ï¼šç”¨ Vue å’Œ Express å®ç°è¿·ä½ å…¨æ ˆç”µå•†åº”ç”¨ï¼ˆä¹ï¼‰ï¼šä½¿ç”¨ Authing é›†æˆå®Œæ•´çš„ç”¨æˆ·ç³»ç»Ÿ <i class="fa fa-chevron-right"></i>
                </a>
              
            </div>
          </div>
        
      </footer>
    
  </div>
  
  
  
  </article>

  </div>


          </div>
          
    
    <div class="comments" id="gitalk-container"></div>
  

        </div>
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">
      <div>
          
          
          
          
        

        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc">
            æ–‡ç« ç›®å½•
          </li>
          <li class="sidebar-nav-overview">
            ç«™ç‚¹æ¦‚è§ˆ
          </li>
        </ul>

        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#å‡†å¤‡æ–°ç‰ˆç™»å½•é€»è¾‘"><span class="nav-number">1.</span> <span class="nav-text">å‡†å¤‡æ–°ç‰ˆç™»å½•é€»è¾‘</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#æ”¹è¿›æ™®é€šç™»å½•"><span class="nav-number">1.1.</span> <span class="nav-text">æ”¹è¿›æ™®é€šç™»å½•</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æ ·å¼æ”¹è¿›"><span class="nav-number">1.2.</span> <span class="nav-text">æ ·å¼æ”¹è¿›</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ä½¿ç”¨-Taro-ç‰©æ–™"><span class="nav-number">1.3.</span> <span class="nav-text">ä½¿ç”¨ Taro ç‰©æ–™</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ä½¿ç”¨-Authing-æ¥å…¥å®Œæ•´çš„ç”¨æˆ·ç³»ç»Ÿ"><span class="nav-number">2.</span> <span class="nav-text">ä½¿ç”¨ Authing æ¥å…¥å®Œæ•´çš„ç”¨æˆ·ç³»ç»Ÿ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#æ³¨å†Œ-Authing-è´¦å·"><span class="nav-number">2.1.</span> <span class="nav-text">æ³¨å†Œ Authing è´¦å·</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ä¸‹è½½å’Œé…ç½®-SDK"><span class="nav-number">2.2.</span> <span class="nav-text">ä¸‹è½½å’Œé…ç½® SDK</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å¼€å§‹é›†æˆ"><span class="nav-number">2.3.</span> <span class="nav-text">å¼€å§‹é›†æˆ</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å¤„ç†ç™»å‡ºé€»è¾‘"><span class="nav-number">3.</span> <span class="nav-text">å¤„ç†ç™»å‡ºé€»è¾‘</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#æ”¹è¿›ç™»å‡ºç»„ä»¶"><span class="nav-number">3.1.</span> <span class="nav-text">æ”¹è¿›ç™»å‡ºç»„ä»¶</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æ¸…ç†å…¶ä»–ç™»å‡ºé€»è¾‘"><span class="nav-number">3.2.</span> <span class="nav-text">æ¸…ç†å…¶ä»–ç™»å‡ºé€»è¾‘</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å°ç»“"><span class="nav-number">3.3.</span> <span class="nav-text">å°ç»“</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#é›†æˆå¾®ä¿¡æˆæƒç™»å½•"><span class="nav-number">4.</span> <span class="nav-text">é›†æˆå¾®ä¿¡æˆæƒç™»å½•</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æ–°ç‰ˆç”¨æˆ·ç³»ç»Ÿæ•´åˆè¿›ç°æœ‰åç«¯"><span class="nav-number">5.</span> <span class="nav-text">æ–°ç‰ˆç”¨æˆ·ç³»ç»Ÿæ•´åˆè¿›ç°æœ‰åç«¯</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#å®‰è£…-SDK"><span class="nav-number">5.1.</span> <span class="nav-text">å®‰è£… SDK</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#é€šè¿‡é‰´æƒä¿æœ‰ç”¨æˆ·ç™»å½•çŠ¶æ€"><span class="nav-number">6.</span> <span class="nav-text">é€šè¿‡é‰´æƒä¿æœ‰ç”¨æˆ·ç™»å½•çŠ¶æ€</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å°ç»“-1"><span class="nav-number">7.</span> <span class="nav-text">å°ç»“</span></a></li></ol></div>
          
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" src="/images/avatar.png" alt="å›¾é›€ç¤¾åŒº">
  <p class="site-author-name" itemprop="name">å›¾é›€ç¤¾åŒº</p>
  <div class="site-description" itemprop="description">ç”± <a href="https://github.com/tuture-dev/tuture" target="_blank" rel="external nofollow noopener noreferrer">Tuture</a> å·¥å…·å†™æˆï¼Œè¿™é‡Œæ±‡é›†äº†èƒ½å¤Ÿè®©ä½ ä»å¤´æ•²åˆ°å°¾å¹¶åšå‡ºå¯è¿è¡Œé¡¹ç›®çš„ç²¾å½©çš„å…è´¹æŠ€æœ¯æ•™ç¨‹</div>
</div>
  <div class="feed-link motion-element">
    <a href="/atom.xml" rel="alternate">
      <i class="fa fa-rss"></i>RSS
    </a>
  </div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <span class="exturl" data-url="aHR0cHM6Ly9qdWVqaW4uaW0vdXNlci81YjMzNDE0MzUxODgyNTc0Yjk2OTRkMjg="><i class="fa fa-fw fa-custom juejin"></i>æ˜é‡‘</span>
      </span>
    
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <a href="/images/social/wechat.png"><i class="fa fa-fw fa-custom wechat"></i>å¾®ä¿¡</a>
      </span>
    
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <span class="exturl" data-url="aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vdHV0dXJl"><i class="fa fa-fw fa-custom zhihu"></i>çŸ¥ä¹</span>
      </span>
    
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R1dHVyZS1kZXY="><i class="fa fa-fw fa-github"></i>GitHub</span>
      </span>
    
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright"><span class="exturl" data-url="aHR0cDovL3d3dy5iZWlhbi5taWl0Lmdvdi5jbg==">æ²ªICPå¤‡19039313å· </span><span><img src="/images/gongan-url.png" style="display:inline-block;">
  
  <span class="exturl" data-url="aHR0cDovL3d3dy5iZWlhbi5nb3YuY24vcG9ydGFsL3JlZ2lzdGVyU3lzdGVtSW5mbz9yZWNvcmRjb2RlPTMxMDExNzAyMDA3MTMw">æ²ªå…¬ç½‘å®‰å¤‡ 31011702007130å· </span>&copy; <span itemprop="copyrightYear">2021</span>
  <span class="with-love" id="animate">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">å›¾é›€ç¤¾åŒº</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    <span title="ç«™ç‚¹æ€»å­—æ•°">891k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">13:30</span>
</span></div>
  <div class="powered-by">ç”± <span class="exturl theme-link" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> å¼ºåŠ›é©±åŠ¨ v4.2.1</div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">ä¸»é¢˜ â€“ <span class="exturl theme-link" data-url="aHR0cHM6Ly90aGVtZS1uZXh0Lm9yZw==">NexT.Pisces</span> v7.4.0</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
</div>












        
      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js?v=3.1.0"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js"></script>

<script src="/js/utils.js?v=7.4.0.js"></script>


<script src="/js/schemes/pisces.js?v=7.4.0.js"></script>


<script src="/js/next-boot.js?v=7.4.0.js"></script>

<script src="/js/bookmark.js?v=7.4.0.js"></script>




  
  <script>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      bp.src = (curProtocol === 'https') ? 'https://zz.bdstatic.com/linksubmit/push.js' : 'http://push.zhanzhang.baidu.com/push.js';
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>








  
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/instantsearch.js@2/dist/instantsearch.min.css">
<script src="//cdn.jsdelivr.net/npm/instantsearch.js@2/dist/instantsearch.min.js"></script>
<script src="/js/algolia-search.js?v=7.4.0.js"></script>
















  

  

  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID: '6310753ce4e95163d2b0',
      clientSecret: '4fd6839b697f9d50e01eebbb9566d8bdf3bd75b4',
      repo: 'comments',
      owner: 'tuture-dev',
      admin: 'pftom,mRcfps,tuture-dev'.split(','),
      id: '2622327b3fec5a72df5caf8ad0c8607b',
        language: 'zh-CN',
      
      distractionFreeMode: 'true'
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
</script>


  <script>
    const line = document.getElementsByClassName('line');
    const arrLine = Array.from(line);

    const delRegex = /\[.*tuture.*-.*del.*?\]/;
    const addRegex = /\[.*tuture.*-.*add.*?\]/;
    const omitRegex = /\[.*tuture.*-.*omit.*?\]/;

    const delSpaceRegex = /^\s*\[.*tuture.*-.*del.*?\]\s*$/;
    const addSpaceRegex = /^\s*\[.*tuture.*-.*add.*?\]\s*$/;
    const omitSpaceRegex = /^\s*\[.*tuture.*-.*omit.*?\]\s*$/;

    arrLine.map(item => {
      if (item.innerText.startsWith('[tuture-add]')) {
        if (addSpaceRegex.test(item.innerText)) {
          item.innerHTML = item.innerHTML.replace(addRegex, ' ');
        } else {
          item.innerHTML = item.innerHTML.replace(addRegex, '');
        }

          item.className = item.className + ' tuture-add';
      } else if (item.innerText.startsWith('[tuture-del]')) {
          if (delSpaceRegex.test(item.innerText)) {
            item.innerHTML = item.innerHTML.replace(delRegex, ' ');
          } else {
            item.innerHTML = item.innerHTML.replace(delRegex, '');
          }

          item.className = item.className + ' tuture-del';
      } else if (item.innerText.startsWith('[tuture-omit]')) {
        item.innerHTML = item.innerHTML.replace(omitRegex, '...');
        item.className = item.className + ' tuture-omit';
      }
    })
  </script>
</body>
</html>
